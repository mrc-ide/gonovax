// Automatically generated by odin 1.5.11 - do not edit
#include <float.h>
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <stdbool.h>
#include <R_ext/Rdynload.h>
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#define CINTERPOLTE_CINTERPOLATE_H_

// Allow use from C++
#ifdef __cplusplus
extern "C" {
#endif

// There are only three functions in the interface; allocation,
// evaluation and freeing.

// Allocate an interpolation object.
//
//   type: The mode of interpolation. Must be one of "constant",
//       "linear" or "spline" (an R error is thrown if a different
//       value is given).
//
//   n: The number of `x` points to interpolate over
//
//   ny: the number of `y` points per `x` point.  This is 1 in the
//       case of zimple interpolation as used by Rs `interpolate()`
//
//   x: an array of `x` values of length `n`
//
//   y: an array of `ny` sets of `y` values.  This is in R's matrix
//       order (i.e., the first `n` values are the first series to
//       interpolate over).
//
//   fail_on_extrapolate: if true, when an extrapolation occurs throw
//       an error; if false return NA_REAL
//
//   auto_free: automatically clean up the interpolation object on
//       return to R. This uses `R_alloc` for allocations rather than
//       `Calloc` so freeing will always happen (even on error
//       elsewhere in the code). However, this prevents returning back
//       a pointer to R that will last longer than the call into C
//       code.
//
// The return value is an opaque pointer that can be passed through to
// `cinterpolate_eval` and `cinterpolate_free`
void *cinterpolate_alloc(const char *type, size_t n, size_t ny,
                         double *x, double *y, bool fail_on_extrapolate,
                         bool auto_free);

// Evaluate the interpolated function at a new `x` point.
//
//   x: A new, single, `x` point to interpolate `y` values to
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
//
//   y: An array of length `ny` to store the interpolated values
//
// The return value is 0 if the interpolation is successful (with x
// lying within the range of values that the interpolation function
// supports), -1 otherwise
int cinterpolate_eval(double x, void *obj, double *y);

// Clean up all allocated memory
//
//   obj: The interpolation object, as returned by `cinterpolate_alloc`
void cinterpolate_free(void *obj);

#ifdef __cplusplus
}
#endif

#endif
typedef struct model_internal {
  double *A0;
  double *beta_t;
  double *C;
  double *C_hesgroup;
  double *Cp;
  double *diag_rec;
  int dim_A;
  int dim_A_1;
  int dim_A_2;
  int dim_A0;
  int dim_A0_1;
  int dim_A0_2;
  int dim_beta_t;
  int dim_C;
  int dim_C_1;
  int dim_C_2;
  int dim_C_hesgroup;
  int dim_C_hesgroup_1;
  int dim_C_hesgroup_12;
  int dim_C_hesgroup_2;
  int dim_C_hesgroup_3;
  int dim_Cp;
  int dim_cum_diag_a;
  int dim_cum_diag_a_1;
  int dim_cum_diag_a_2;
  int dim_cum_diag_s;
  int dim_cum_diag_s_1;
  int dim_cum_diag_s_2;
  int dim_cum_entrants;
  int dim_cum_entrants_1;
  int dim_cum_entrants_2;
  int dim_cum_incid;
  int dim_cum_incid_1;
  int dim_cum_incid_2;
  int dim_cum_offered;
  int dim_cum_offered_1;
  int dim_cum_offered_2;
  int dim_cum_offered_pn;
  int dim_cum_offered_pn_1;
  int dim_cum_offered_pn_2;
  int dim_cum_offered_vbe;
  int dim_cum_offered_vbe_1;
  int dim_cum_offered_vbe_2;
  int dim_cum_screened;
  int dim_cum_screened_1;
  int dim_cum_screened_2;
  int dim_cum_treated;
  int dim_cum_treated_1;
  int dim_cum_treated_2;
  int dim_cum_vaccinated;
  int dim_cum_vaccinated_1;
  int dim_cum_vaccinated_2;
  int dim_cum_vaccinated_pn;
  int dim_cum_vaccinated_pn_1;
  int dim_cum_vaccinated_pn_2;
  int dim_cum_vaccinated_screen;
  int dim_cum_vaccinated_screen_1;
  int dim_cum_vaccinated_screen_2;
  int dim_cum_vbe;
  int dim_cum_vbe_1;
  int dim_cum_vbe_2;
  int dim_diag_rec;
  int dim_diag_rec_1;
  int dim_diag_rec_12;
  int dim_diag_rec_2;
  int dim_diag_rec_3;
  int dim_entrants;
  int dim_entrants_1;
  int dim_entrants_2;
  int dim_eta;
  int dim_eta_h_t;
  int dim_eta_l_t;
  int dim_foi_LH;
  int dim_hesgroupmatrix;
  int dim_hesgroupmatrix_1;
  int dim_hesgroupmatrix_2;
  int dim_I;
  int dim_I_1;
  int dim_I_2;
  int dim_I0;
  int dim_I0_1;
  int dim_I0_2;
  int dim_lambda;
  int dim_lambda_1;
  int dim_lambda_2;
  int dim_N;
  int dim_N_1;
  int dim_N_2;
  int dim_n_AT;
  int dim_n_AT_1;
  int dim_n_AT_2;
  int dim_n_AU;
  int dim_n_AU_1;
  int dim_n_AU_2;
  int dim_n_diag_rec;
  int dim_n_diag_rec_1;
  int dim_n_diag_rec_12;
  int dim_n_diag_rec_2;
  int dim_n_diag_rec_3;
  int dim_N_hesgroup;
  int dim_N_hesgroup_1;
  int dim_N_hesgroup_12;
  int dim_N_hesgroup_2;
  int dim_N_hesgroup_3;
  int dim_n_obe;
  int dim_n_obe_1;
  int dim_n_obe_12;
  int dim_n_obe_2;
  int dim_n_obe_3;
  int dim_n_ood;
  int dim_n_ood_1;
  int dim_n_ood_12;
  int dim_n_ood_2;
  int dim_n_ood_3;
  int dim_n_oopn;
  int dim_n_oopn_1;
  int dim_n_oopn_12;
  int dim_n_oopn_2;
  int dim_n_oopn_3;
  int dim_n_oos;
  int dim_n_oos_1;
  int dim_n_oos_12;
  int dim_n_oos_2;
  int dim_n_oos_3;
  int dim_n_ST;
  int dim_n_ST_1;
  int dim_n_ST_2;
  int dim_n_TU;
  int dim_n_TU_1;
  int dim_n_TU_2;
  int dim_n_UI;
  int dim_n_UI_1;
  int dim_n_UI_2;
  int dim_n_vbe;
  int dim_n_vbe_1;
  int dim_n_vbe_12;
  int dim_n_vbe_2;
  int dim_n_vbe_3;
  int dim_n_vod;
  int dim_n_vod_1;
  int dim_n_vod_12;
  int dim_n_vod_2;
  int dim_n_vod_3;
  int dim_n_vopn;
  int dim_n_vopn_1;
  int dim_n_vopn_12;
  int dim_n_vopn_2;
  int dim_n_vopn_3;
  int dim_n_vos;
  int dim_n_vos_1;
  int dim_n_vos_12;
  int dim_n_vos_2;
  int dim_n_vos_3;
  int dim_notifiedandattended;
  int dim_notifiedandattended_1;
  int dim_notifiedandattended_2;
  int dim_Np;
  int dim_omega_C;
  int dim_omega_C_1;
  int dim_omega_C_2;
  int dim_omega_C_withdiag;
  int dim_omega_C_withdiag_1;
  int dim_omega_C_withdiag_2;
  int dim_omega_C_withdiag_rg;
  int dim_omega_U;
  int dim_omega_U_1;
  int dim_omega_U_2;
  int dim_omega_U_withdiag;
  int dim_omega_U_withdiag_1;
  int dim_omega_U_withdiag_2;
  int dim_omega_U_withdiag_rg;
  int dim_p;
  int dim_phi;
  int dim_phi_1;
  int dim_phi_2;
  int dim_prop_C;
  int dim_prop_C_hesgroup;
  int dim_prop_C_hesriskgroup;
  int dim_prop_C_hesriskgroup_1;
  int dim_prop_C_hesriskgroup_2;
  int dim_prop_CCsubgroup;
  int dim_prop_CCsubgroup_1;
  int dim_prop_CCsubgroup_2;
  int dim_prop_UUsubgroup;
  int dim_prop_UUsubgroup_1;
  int dim_prop_UUsubgroup_2;
  int dim_q;
  int dim_S;
  int dim_S_1;
  int dim_S_2;
  int dim_S0;
  int dim_S0_1;
  int dim_S0_2;
  int dim_screened;
  int dim_screened_1;
  int dim_screened_2;
  int dim_T;
  int dim_T_1;
  int dim_T_2;
  int dim_T0;
  int dim_T0_1;
  int dim_T0_2;
  int dim_tt;
  int dim_U;
  int dim_U_1;
  int dim_U_2;
  int dim_u_d;
  int dim_u_d_1;
  int dim_u_d_12;
  int dim_u_d_2;
  int dim_u_d_3;
  int dim_u_pn;
  int dim_u_pn_1;
  int dim_u_pn_12;
  int dim_u_pn_2;
  int dim_u_pn_3;
  int dim_u_s;
  int dim_u_s_1;
  int dim_u_s_12;
  int dim_u_s_2;
  int dim_u_s_3;
  int dim_U0;
  int dim_U0_1;
  int dim_U0_2;
  int dim_Up;
  int dim_vax_t;
  int dim_vax_y;
  int dim_vbe;
  int dim_vbe_1;
  int dim_vbe_12;
  int dim_vbe_2;
  int dim_vbe_3;
  int dim_vea;
  int dim_ved;
  int dim_vei;
  int dim_ves;
  int dim_vod;
  int dim_vod_1;
  int dim_vod_12;
  int dim_vod_2;
  int dim_vod_3;
  int dim_vopn;
  int dim_vopn_1;
  int dim_vopn_12;
  int dim_vopn_2;
  int dim_vopn_3;
  int dim_vos;
  int dim_vos_1;
  int dim_vos_12;
  int dim_vos_2;
  int dim_vos_3;
  int dim_w;
  int dim_w_1;
  int dim_w_2;
  int dim_wA;
  int dim_wA_1;
  int dim_wA_12;
  int dim_wA_2;
  int dim_wA_3;
  int dim_wd;
  int dim_wd_1;
  int dim_wd_2;
  int dim_wdA;
  int dim_wdA_1;
  int dim_wdA_12;
  int dim_wdA_2;
  int dim_wdA_3;
  int dim_wdI;
  int dim_wdI_1;
  int dim_wdI_12;
  int dim_wdI_2;
  int dim_wdI_3;
  int dim_wdS;
  int dim_wdS_1;
  int dim_wdS_12;
  int dim_wdS_2;
  int dim_wdS_3;
  int dim_wdT;
  int dim_wdT_1;
  int dim_wdT_12;
  int dim_wdT_2;
  int dim_wdT_3;
  int dim_wdU;
  int dim_wdU_1;
  int dim_wdU_12;
  int dim_wdU_2;
  int dim_wdU_3;
  int dim_wI;
  int dim_wI_1;
  int dim_wI_12;
  int dim_wI_2;
  int dim_wI_3;
  int dim_willing;
  int dim_wS;
  int dim_wS_1;
  int dim_wS_12;
  int dim_wS_2;
  int dim_wS_3;
  int dim_wT;
  int dim_wT_1;
  int dim_wT_12;
  int dim_wT_2;
  int dim_wT_3;
  int dim_wU;
  int dim_wU_1;
  int dim_wU_12;
  int dim_wU_2;
  int dim_wU_3;
  int dim_xi;
  int dim_xi_1;
  int dim_xi_2;
  double enr;
  double *entrants;
  double epsilon;
  double epsilon_hes;
  double *eta;
  double *eta_h_t;
  double *eta_l_t;
  double exr;
  double *foi_LH;
  double *hesgroupmatrix;
  double *I0;
  double *initial_A;
  double *initial_cum_diag_a;
  double *initial_cum_diag_s;
  double *initial_cum_entrants;
  double *initial_cum_incid;
  double *initial_cum_offered;
  double *initial_cum_offered_pn;
  double *initial_cum_offered_vbe;
  double *initial_cum_screened;
  double *initial_cum_treated;
  double *initial_cum_vaccinated;
  double *initial_cum_vaccinated_pn;
  double *initial_cum_vaccinated_screen;
  double *initial_cum_vbe;
  double *initial_I;
  double *initial_S;
  double *initial_T;
  double *initial_U;
  void *interpolate_beta;
  void *interpolate_eta_h;
  void *interpolate_eta_l;
  void *interpolate_vax_switch;
  double kappa;
  double *lambda;
  double mu;
  double *N;
  double *n_AT;
  double *n_AU;
  double *n_diag_rec;
  int n_group;
  double *N_hesgroup;
  double *n_obe;
  double *n_ood;
  double *n_oopn;
  double *n_oos;
  double *n_ST;
  double *n_TU;
  double *n_UI;
  int n_vax;
  double *n_vbe;
  double *n_vod;
  double *n_vopn;
  double *n_vos;
  double *notifiedandattended;
  double notifiedprev;
  double *Np;
  double nu;
  int offset_output_lambda;
  int offset_output_N;
  int offset_output_notifiedandattended;
  int offset_output_phi;
  int offset_output_prop_C_hesgroup;
  int offset_output_prop_C_hesriskgroup;
  int offset_variable_A;
  int offset_variable_cum_diag_a;
  int offset_variable_cum_diag_s;
  int offset_variable_cum_entrants;
  int offset_variable_cum_incid;
  int offset_variable_cum_offered;
  int offset_variable_cum_offered_pn;
  int offset_variable_cum_offered_vbe;
  int offset_variable_cum_screened;
  int offset_variable_cum_treated;
  int offset_variable_cum_vaccinated;
  int offset_variable_cum_vaccinated_pn;
  int offset_variable_cum_vaccinated_screen;
  int offset_variable_cum_vbe;
  int offset_variable_S;
  int offset_variable_T;
  double *omega_C;
  double *omega_C_withdiag;
  double *omega_C_withdiag_rg;
  double *omega_U;
  double *omega_U_withdiag;
  double *omega_U_withdiag_rg;
  double *p;
  double *phi;
  double *prop_C;
  double *prop_C_hesgroup;
  double *prop_C_hesriskgroup;
  double *prop_CCsubgroup;
  double *prop_UUsubgroup;
  double psi;
  double *q;
  double rho;
  double *S0;
  double *screened;
  double sigma;
  double *T0;
  double *tt;
  double *u_d;
  double *u_pn;
  double *u_s;
  double u_vbe;
  double *U0;
  double *Up;
  double *vax_t;
  double *vax_y;
  double *vbe;
  double *vea;
  double *ved;
  double *vei;
  double *ves;
  double *vod;
  double *vopn;
  double *vos;
  double *w;
  double *wA;
  double *wd;
  double *wdA;
  double *wdI;
  double *wdS;
  double *wdT;
  double *wdU;
  double *wI;
  double *willing;
  double *wS;
  double *wT;
  double *wU;
  double *xi;
} model_internal;
typedef struct model_trial_internal {
  double *A0;
  double *diag_rec_a;
  double *diag_rec_s;
  int dim_A;
  int dim_A_1;
  int dim_A_2;
  int dim_A0;
  int dim_A0_1;
  int dim_A0_2;
  int dim_cum_diag_a;
  int dim_cum_diag_a_1;
  int dim_cum_diag_a_2;
  int dim_cum_diag_s;
  int dim_cum_diag_s_1;
  int dim_cum_diag_s_2;
  int dim_cum_incid;
  int dim_cum_incid_1;
  int dim_cum_incid_2;
  int dim_cum_pye_trial_pov;
  int dim_cum_pye_trial_pov_1;
  int dim_cum_pye_trial_pov_2;
  int dim_cum_pye_true;
  int dim_cum_pye_true_1;
  int dim_cum_pye_true_2;
  int dim_cum_screened;
  int dim_cum_screened_1;
  int dim_cum_screened_2;
  int dim_cum_treated;
  int dim_cum_treated_1;
  int dim_cum_treated_2;
  int dim_diag_rec_a;
  int dim_diag_rec_a_1;
  int dim_diag_rec_a_12;
  int dim_diag_rec_a_2;
  int dim_diag_rec_a_3;
  int dim_diag_rec_s;
  int dim_diag_rec_s_1;
  int dim_diag_rec_s_12;
  int dim_diag_rec_s_2;
  int dim_diag_rec_s_3;
  int dim_I;
  int dim_I_1;
  int dim_I_2;
  int dim_I0;
  int dim_I0_1;
  int dim_I0_2;
  int dim_N;
  int dim_N_1;
  int dim_N_2;
  int dim_n_AT;
  int dim_n_AT_1;
  int dim_n_AT_2;
  int dim_n_AU;
  int dim_n_AU_1;
  int dim_n_AU_2;
  int dim_n_diag_rec;
  int dim_n_diag_rec_1;
  int dim_n_diag_rec_12;
  int dim_n_diag_rec_2;
  int dim_n_diag_rec_3;
  int dim_n_ST;
  int dim_n_ST_1;
  int dim_n_ST_2;
  int dim_n_TU;
  int dim_n_TU_1;
  int dim_n_TU_2;
  int dim_n_UI;
  int dim_n_UI_1;
  int dim_n_UI_2;
  int dim_pye_trial;
  int dim_pye_trial_1;
  int dim_pye_trial_2;
  int dim_S;
  int dim_S_1;
  int dim_S_2;
  int dim_S0;
  int dim_S0_1;
  int dim_S0_2;
  int dim_screened;
  int dim_screened_1;
  int dim_screened_2;
  int dim_T;
  int dim_T_1;
  int dim_T_2;
  int dim_T0;
  int dim_T0_1;
  int dim_T0_2;
  int dim_U;
  int dim_U_1;
  int dim_U_2;
  int dim_U0;
  int dim_U0_1;
  int dim_U0_2;
  int dim_vea;
  int dim_ved;
  int dim_ves;
  int dim_w;
  int dim_w_1;
  int dim_w_2;
  int dim_wA;
  int dim_wA_1;
  int dim_wA_12;
  int dim_wA_2;
  int dim_wA_3;
  int dim_wI;
  int dim_wI_1;
  int dim_wI_12;
  int dim_wI_2;
  int dim_wI_3;
  int dim_wS;
  int dim_wS_1;
  int dim_wS_12;
  int dim_wS_2;
  int dim_wS_3;
  int dim_wT;
  int dim_wT_1;
  int dim_wT_12;
  int dim_wT_2;
  int dim_wT_3;
  int dim_wU;
  int dim_wU_1;
  int dim_wU_12;
  int dim_wU_2;
  int dim_wU_3;
  double eta;
  double *I0;
  double *initial_A;
  double *initial_cum_diag_a;
  double *initial_cum_diag_s;
  double *initial_cum_incid;
  double *initial_cum_pye_trial_pov;
  double *initial_cum_pye_true;
  double *initial_cum_screened;
  double *initial_cum_treated;
  double *initial_I;
  double *initial_S;
  double *initial_T;
  double *initial_U;
  double lambda;
  double mu;
  double *N;
  double *n_AT;
  double *n_AU;
  double *n_diag_rec;
  int n_group;
  double *n_ST;
  double *n_TU;
  double *n_UI;
  int n_vax;
  double nu;
  int offset_variable_A;
  int offset_variable_cum_diag_a;
  int offset_variable_cum_diag_s;
  int offset_variable_cum_incid;
  int offset_variable_cum_pye_trial_pov;
  int offset_variable_cum_pye_true;
  int offset_variable_cum_screened;
  int offset_variable_cum_treated;
  int offset_variable_S;
  int offset_variable_T;
  double psi;
  double *pye_trial;
  double rho;
  double *S0;
  double *screened;
  double sigma;
  double *T0;
  double *U0;
  double *vea;
  double *ved;
  double *ves;
  double *w;
  double *wA;
  double *wI;
  double *wS;
  double *wT;
  double *wU;
} model_trial_internal;
typedef struct model_trial_stochastic_internal {
  double *A0;
  double *D;
  double *diag_rec_a;
  double *diag_rec_s;
  int dim_A;
  int dim_A_1;
  int dim_A_2;
  int dim_A0;
  int dim_A0_1;
  int dim_A0_2;
  int dim_cum_diag_a;
  int dim_cum_diag_a_1;
  int dim_cum_diag_a_2;
  int dim_cum_diag_s;
  int dim_cum_diag_s_1;
  int dim_cum_diag_s_2;
  int dim_cum_incid;
  int dim_cum_incid_1;
  int dim_cum_incid_2;
  int dim_cum_pye_trial_pov;
  int dim_cum_pye_trial_pov_1;
  int dim_cum_pye_trial_pov_2;
  int dim_cum_pye_true;
  int dim_cum_pye_true_1;
  int dim_cum_pye_true_2;
  int dim_cum_screened;
  int dim_cum_screened_1;
  int dim_cum_screened_2;
  int dim_cum_treated;
  int dim_cum_treated_1;
  int dim_cum_treated_2;
  int dim_D;
  int dim_diag_rec_a;
  int dim_diag_rec_a_1;
  int dim_diag_rec_a_12;
  int dim_diag_rec_a_2;
  int dim_diag_rec_a_3;
  int dim_diag_rec_s;
  int dim_diag_rec_s_1;
  int dim_diag_rec_s_12;
  int dim_diag_rec_s_2;
  int dim_diag_rec_s_3;
  int dim_I;
  int dim_I_1;
  int dim_I_2;
  int dim_I0;
  int dim_I0_1;
  int dim_I0_2;
  int dim_N;
  int dim_N_1;
  int dim_N_2;
  int dim_n_A_ext;
  int dim_n_A_ext_1;
  int dim_n_A_ext_2;
  int dim_n_AT;
  int dim_n_AT_1;
  int dim_n_AT_2;
  int dim_n_AU;
  int dim_n_AU_1;
  int dim_n_AU_2;
  int dim_n_AUT;
  int dim_n_AUT_1;
  int dim_n_AUT_2;
  int dim_n_Aw;
  int dim_n_Aw_1;
  int dim_n_Aw_2;
  int dim_n_diag_rec;
  int dim_n_diag_rec_1;
  int dim_n_diag_rec_12;
  int dim_n_diag_rec_2;
  int dim_n_diag_rec_3;
  int dim_n_I_ext;
  int dim_n_I_ext_1;
  int dim_n_I_ext_2;
  int dim_n_IA;
  int dim_n_IA_1;
  int dim_n_IA_2;
  int dim_n_IAS;
  int dim_n_IAS_1;
  int dim_n_IAS_2;
  int dim_n_IS;
  int dim_n_IS_1;
  int dim_n_IS_2;
  int dim_n_Iw;
  int dim_n_Iw_1;
  int dim_n_Iw_2;
  int dim_n_S_ext;
  int dim_n_S_ext_1;
  int dim_n_S_ext_2;
  int dim_n_ST;
  int dim_n_ST_1;
  int dim_n_ST_2;
  int dim_n_Sw;
  int dim_n_Sw_1;
  int dim_n_Sw_2;
  int dim_n_T_ext;
  int dim_n_T_ext_1;
  int dim_n_T_ext_2;
  int dim_n_TU;
  int dim_n_TU_1;
  int dim_n_TU_2;
  int dim_n_Tw;
  int dim_n_Tw_1;
  int dim_n_Tw_2;
  int dim_n_U_ext;
  int dim_n_U_ext_1;
  int dim_n_U_ext_2;
  int dim_n_UI;
  int dim_n_UI_1;
  int dim_n_UI_2;
  int dim_n_Uw;
  int dim_n_Uw_1;
  int dim_n_Uw_2;
  int dim_p_A_ext;
  int dim_p_A_ext_1;
  int dim_p_A_ext_2;
  int dim_p_I_ext;
  int dim_p_I_ext_1;
  int dim_p_I_ext_2;
  int dim_p_S_ext;
  int dim_p_S_ext_1;
  int dim_p_S_ext_2;
  int dim_p_T_ext;
  int dim_p_T_ext_1;
  int dim_p_T_ext_2;
  int dim_p_U_ext;
  int dim_p_U_ext_1;
  int dim_p_U_ext_2;
  int dim_pye_trial;
  int dim_pye_trial_1;
  int dim_pye_trial_2;
  int dim_r_AT;
  int dim_r_AT_1;
  int dim_r_AT_2;
  int dim_r_AU;
  int dim_r_AU_1;
  int dim_r_AU_2;
  int dim_Rel_A;
  int dim_Rel_A_1;
  int dim_Rel_A_2;
  int dim_Rel_I;
  int dim_Rel_I_1;
  int dim_Rel_I_2;
  int dim_Rel_S;
  int dim_Rel_S_1;
  int dim_Rel_S_2;
  int dim_Rel_T;
  int dim_Rel_T_1;
  int dim_Rel_T_2;
  int dim_Rel_U;
  int dim_Rel_U_1;
  int dim_Rel_U_2;
  int dim_S;
  int dim_S_1;
  int dim_S_2;
  int dim_S0;
  int dim_S0_1;
  int dim_S0_2;
  int dim_screened;
  int dim_screened_1;
  int dim_screened_2;
  int dim_T;
  int dim_T_1;
  int dim_T_2;
  int dim_T0;
  int dim_T0_1;
  int dim_T0_2;
  int dim_U;
  int dim_U_1;
  int dim_U_2;
  int dim_U0;
  int dim_U0_1;
  int dim_U0_2;
  int dim_vea;
  int dim_ved;
  int dim_ves;
  int dim_w;
  int dim_w_1;
  int dim_w_2;
  int dim_wA;
  int dim_wA_1;
  int dim_wA_12;
  int dim_wA_2;
  int dim_wA_3;
  int dim_wI;
  int dim_wI_1;
  int dim_wI_12;
  int dim_wI_2;
  int dim_wI_3;
  int dim_wS;
  int dim_wS_1;
  int dim_wS_12;
  int dim_wS_2;
  int dim_wS_3;
  int dim_wT;
  int dim_wT_1;
  int dim_wT_12;
  int dim_wT_2;
  int dim_wT_3;
  int dim_wU;
  int dim_wU_1;
  int dim_wU_12;
  int dim_wU_2;
  int dim_wU_3;
  double dt;
  double eta;
  double *I0;
  double *initial_A;
  double *initial_cum_diag_a;
  double *initial_cum_diag_s;
  double *initial_cum_incid;
  double *initial_cum_pye_trial_pov;
  double *initial_cum_pye_true;
  double *initial_cum_screened;
  double *initial_cum_treated;
  double *initial_I;
  double *initial_S;
  double *initial_T;
  double initial_time;
  double *initial_U;
  double lambda;
  double mu;
  double *N;
  double *n_A_ext;
  double *n_AT;
  double *n_AU;
  double *n_AUT;
  double *n_Aw;
  double *n_diag_rec;
  int n_group;
  double *n_I_ext;
  double *n_IA;
  double *n_IAS;
  double *n_IS;
  double *n_Iw;
  double *n_S_ext;
  double *n_ST;
  double *n_Sw;
  double *n_T_ext;
  double *n_TU;
  double *n_Tw;
  double *n_U_ext;
  double *n_UI;
  double *n_Uw;
  int n_vax;
  double nu;
  int offset_variable_A;
  int offset_variable_cum_diag_a;
  int offset_variable_cum_diag_s;
  int offset_variable_cum_incid;
  int offset_variable_cum_pye_trial_pov;
  int offset_variable_cum_pye_true;
  int offset_variable_cum_screened;
  int offset_variable_cum_treated;
  int offset_variable_I;
  int offset_variable_S;
  int offset_variable_T;
  double *p_A_ext;
  double *p_I_ext;
  double *p_S_ext;
  double *p_T_ext;
  double *p_U_ext;
  double psi;
  double *pye_trial;
  double *r_AT;
  double *r_AU;
  double *Rel_A;
  double *Rel_I;
  double *Rel_S;
  double *Rel_T;
  double *Rel_U;
  double rho;
  double *S0;
  double *screened;
  double sigma;
  double steps_per_year;
  double *T0;
  double *U0;
  double *vea;
  double *ved;
  double *ves;
  double *w;
  double *wA;
  double *wI;
  double *wS;
  double *wT;
  double *wU;
} model_trial_stochastic_internal;
typedef struct model_withouthistory_internal {
  double *A0;
  double *beta_t;
  double *C;
  int dim_A;
  int dim_A_1;
  int dim_A_2;
  int dim_A0;
  int dim_A0_1;
  int dim_A0_2;
  int dim_beta_t;
  int dim_C;
  int dim_C_1;
  int dim_C_2;
  int dim_cum_diag_a;
  int dim_cum_diag_a_1;
  int dim_cum_diag_a_2;
  int dim_cum_diag_s;
  int dim_cum_diag_s_1;
  int dim_cum_diag_s_2;
  int dim_cum_incid;
  int dim_cum_incid_1;
  int dim_cum_incid_2;
  int dim_cum_offered;
  int dim_cum_offered_1;
  int dim_cum_offered_2;
  int dim_cum_offered_vbe;
  int dim_cum_offered_vbe_1;
  int dim_cum_offered_vbe_2;
  int dim_cum_screened;
  int dim_cum_screened_1;
  int dim_cum_screened_2;
  int dim_cum_treated;
  int dim_cum_treated_1;
  int dim_cum_treated_2;
  int dim_cum_vaccinated;
  int dim_cum_vaccinated_1;
  int dim_cum_vaccinated_2;
  int dim_cum_vbe;
  int dim_cum_vbe_1;
  int dim_cum_vbe_2;
  int dim_entrants;
  int dim_entrants_1;
  int dim_entrants_2;
  int dim_eta;
  int dim_eta_h_t;
  int dim_eta_l_t;
  int dim_foi_LH;
  int dim_I;
  int dim_I_1;
  int dim_I_2;
  int dim_I0;
  int dim_I0_1;
  int dim_I0_2;
  int dim_lambda;
  int dim_N;
  int dim_N_1;
  int dim_N_2;
  int dim_n_AT;
  int dim_n_AT_1;
  int dim_n_AT_2;
  int dim_n_AU;
  int dim_n_AU_1;
  int dim_n_AU_2;
  int dim_n_obe;
  int dim_n_obe_1;
  int dim_n_obe_12;
  int dim_n_obe_2;
  int dim_n_obe_3;
  int dim_n_ood;
  int dim_n_ood_1;
  int dim_n_ood_12;
  int dim_n_ood_2;
  int dim_n_ood_3;
  int dim_n_oos;
  int dim_n_oos_1;
  int dim_n_oos_12;
  int dim_n_oos_2;
  int dim_n_oos_3;
  int dim_n_ST;
  int dim_n_ST_1;
  int dim_n_ST_2;
  int dim_n_TU;
  int dim_n_TU_1;
  int dim_n_TU_2;
  int dim_n_UI;
  int dim_n_UI_1;
  int dim_n_UI_2;
  int dim_n_vbe;
  int dim_n_vbe_1;
  int dim_n_vbe_12;
  int dim_n_vbe_2;
  int dim_n_vbe_3;
  int dim_n_vod;
  int dim_n_vod_1;
  int dim_n_vod_12;
  int dim_n_vod_2;
  int dim_n_vod_3;
  int dim_n_vos;
  int dim_n_vos_1;
  int dim_n_vos_12;
  int dim_n_vos_2;
  int dim_n_vos_3;
  int dim_Np;
  int dim_p;
  int dim_prop_C;
  int dim_q;
  int dim_S;
  int dim_S_1;
  int dim_S_2;
  int dim_S0;
  int dim_S0_1;
  int dim_S0_2;
  int dim_screened;
  int dim_screened_1;
  int dim_screened_2;
  int dim_T;
  int dim_T_1;
  int dim_T_2;
  int dim_T0;
  int dim_T0_1;
  int dim_T0_2;
  int dim_tt;
  int dim_u;
  int dim_U;
  int dim_u_1;
  int dim_U_1;
  int dim_u_12;
  int dim_u_2;
  int dim_U_2;
  int dim_u_3;
  int dim_U0;
  int dim_U0_1;
  int dim_U0_2;
  int dim_vax_t;
  int dim_vax_y;
  int dim_vbe;
  int dim_vbe_1;
  int dim_vbe_12;
  int dim_vbe_2;
  int dim_vbe_3;
  int dim_vea;
  int dim_ved;
  int dim_vei;
  int dim_ves;
  int dim_vod;
  int dim_vod_1;
  int dim_vod_12;
  int dim_vod_2;
  int dim_vod_3;
  int dim_vos;
  int dim_vos_1;
  int dim_vos_12;
  int dim_vos_2;
  int dim_vos_3;
  int dim_w;
  int dim_w_1;
  int dim_w_2;
  int dim_wA;
  int dim_wA_1;
  int dim_wA_12;
  int dim_wA_2;
  int dim_wA_3;
  int dim_wI;
  int dim_wI_1;
  int dim_wI_12;
  int dim_wI_2;
  int dim_wI_3;
  int dim_willing;
  int dim_wS;
  int dim_wS_1;
  int dim_wS_12;
  int dim_wS_2;
  int dim_wS_3;
  int dim_wT;
  int dim_wT_1;
  int dim_wT_12;
  int dim_wT_2;
  int dim_wT_3;
  int dim_wU;
  int dim_wU_1;
  int dim_wU_12;
  int dim_wU_2;
  int dim_wU_3;
  double enr;
  double *entrants;
  double epsilon;
  double *eta;
  double *eta_h_t;
  double *eta_l_t;
  double exr;
  double *foi_LH;
  double *I0;
  double *initial_A;
  double *initial_cum_diag_a;
  double *initial_cum_diag_s;
  double *initial_cum_incid;
  double *initial_cum_offered;
  double *initial_cum_offered_vbe;
  double *initial_cum_screened;
  double *initial_cum_treated;
  double *initial_cum_vaccinated;
  double *initial_cum_vbe;
  double *initial_I;
  double *initial_S;
  double *initial_T;
  double *initial_U;
  void *interpolate_beta;
  void *interpolate_eta_h;
  void *interpolate_eta_l;
  void *interpolate_vax_switch;
  double *lambda;
  double mu;
  double *N;
  double *n_AT;
  double *n_AU;
  int n_group;
  double *n_obe;
  double *n_ood;
  double *n_oos;
  double *n_ST;
  double *n_TU;
  double *n_UI;
  int n_vax;
  double *n_vbe;
  double *n_vod;
  double *n_vos;
  double *Np;
  double nu;
  int offset_output_lambda;
  int offset_output_N;
  int offset_variable_A;
  int offset_variable_cum_diag_a;
  int offset_variable_cum_diag_s;
  int offset_variable_cum_incid;
  int offset_variable_cum_offered;
  int offset_variable_cum_offered_vbe;
  int offset_variable_cum_screened;
  int offset_variable_cum_treated;
  int offset_variable_cum_vaccinated;
  int offset_variable_cum_vbe;
  int offset_variable_S;
  int offset_variable_T;
  double *p;
  double *prop_C;
  double psi;
  double *q;
  double rho;
  double *S0;
  double *screened;
  double sigma;
  double *T0;
  double *tt;
  double *u;
  double u_vbe;
  double *U0;
  double *vax_t;
  double *vax_y;
  double *vbe;
  double *vea;
  double *ved;
  double *vei;
  double *ves;
  double *vod;
  double *vos;
  double *w;
  double *wA;
  double *wI;
  double *willing;
  double *wS;
  double *wT;
  double *wU;
} model_withouthistory_internal;
typedef struct model_withoutPN_internal {
  double *A0;
  double *beta_t;
  double *C;
  double *diag_rec;
  int dim_A;
  int dim_A_1;
  int dim_A_2;
  int dim_A0;
  int dim_A0_1;
  int dim_A0_2;
  int dim_beta_t;
  int dim_C;
  int dim_C_1;
  int dim_C_2;
  int dim_cum_diag_a;
  int dim_cum_diag_a_1;
  int dim_cum_diag_a_2;
  int dim_cum_diag_s;
  int dim_cum_diag_s_1;
  int dim_cum_diag_s_2;
  int dim_cum_entrants;
  int dim_cum_entrants_1;
  int dim_cum_entrants_2;
  int dim_cum_incid;
  int dim_cum_incid_1;
  int dim_cum_incid_2;
  int dim_cum_offered;
  int dim_cum_offered_1;
  int dim_cum_offered_2;
  int dim_cum_offered_vbe;
  int dim_cum_offered_vbe_1;
  int dim_cum_offered_vbe_2;
  int dim_cum_screened;
  int dim_cum_screened_1;
  int dim_cum_screened_2;
  int dim_cum_treated;
  int dim_cum_treated_1;
  int dim_cum_treated_2;
  int dim_cum_vaccinated;
  int dim_cum_vaccinated_1;
  int dim_cum_vaccinated_2;
  int dim_cum_vaccinated_screen;
  int dim_cum_vaccinated_screen_1;
  int dim_cum_vaccinated_screen_2;
  int dim_cum_vbe;
  int dim_cum_vbe_1;
  int dim_cum_vbe_2;
  int dim_diag_rec;
  int dim_diag_rec_1;
  int dim_diag_rec_12;
  int dim_diag_rec_2;
  int dim_diag_rec_3;
  int dim_entrants;
  int dim_entrants_1;
  int dim_entrants_2;
  int dim_eta;
  int dim_eta_h_t;
  int dim_eta_l_t;
  int dim_foi_LH;
  int dim_I;
  int dim_I_1;
  int dim_I_2;
  int dim_I0;
  int dim_I0_1;
  int dim_I0_2;
  int dim_lambda;
  int dim_N;
  int dim_N_1;
  int dim_N_2;
  int dim_n_AT;
  int dim_n_AT_1;
  int dim_n_AT_2;
  int dim_n_AU;
  int dim_n_AU_1;
  int dim_n_AU_2;
  int dim_n_diag_rec;
  int dim_n_diag_rec_1;
  int dim_n_diag_rec_12;
  int dim_n_diag_rec_2;
  int dim_n_diag_rec_3;
  int dim_n_obe;
  int dim_n_obe_1;
  int dim_n_obe_12;
  int dim_n_obe_2;
  int dim_n_obe_3;
  int dim_n_ood;
  int dim_n_ood_1;
  int dim_n_ood_12;
  int dim_n_ood_2;
  int dim_n_ood_3;
  int dim_n_oos;
  int dim_n_oos_1;
  int dim_n_oos_12;
  int dim_n_oos_2;
  int dim_n_oos_3;
  int dim_n_ST;
  int dim_n_ST_1;
  int dim_n_ST_2;
  int dim_n_TU;
  int dim_n_TU_1;
  int dim_n_TU_2;
  int dim_n_UI;
  int dim_n_UI_1;
  int dim_n_UI_2;
  int dim_n_vbe;
  int dim_n_vbe_1;
  int dim_n_vbe_12;
  int dim_n_vbe_2;
  int dim_n_vbe_3;
  int dim_n_vod;
  int dim_n_vod_1;
  int dim_n_vod_12;
  int dim_n_vod_2;
  int dim_n_vod_3;
  int dim_n_vos;
  int dim_n_vos_1;
  int dim_n_vos_12;
  int dim_n_vos_2;
  int dim_n_vos_3;
  int dim_Np;
  int dim_p;
  int dim_prop_C;
  int dim_q;
  int dim_S;
  int dim_S_1;
  int dim_S_2;
  int dim_S0;
  int dim_S0_1;
  int dim_S0_2;
  int dim_screened;
  int dim_screened_1;
  int dim_screened_2;
  int dim_T;
  int dim_T_1;
  int dim_T_2;
  int dim_T0;
  int dim_T0_1;
  int dim_T0_2;
  int dim_tt;
  int dim_U;
  int dim_U_1;
  int dim_U_2;
  int dim_u_d;
  int dim_u_d_1;
  int dim_u_d_12;
  int dim_u_d_2;
  int dim_u_d_3;
  int dim_u_s;
  int dim_u_s_1;
  int dim_u_s_12;
  int dim_u_s_2;
  int dim_u_s_3;
  int dim_U0;
  int dim_U0_1;
  int dim_U0_2;
  int dim_vax_t;
  int dim_vax_y;
  int dim_vbe;
  int dim_vbe_1;
  int dim_vbe_12;
  int dim_vbe_2;
  int dim_vbe_3;
  int dim_vea;
  int dim_ved;
  int dim_vei;
  int dim_ves;
  int dim_vod;
  int dim_vod_1;
  int dim_vod_12;
  int dim_vod_2;
  int dim_vod_3;
  int dim_vos;
  int dim_vos_1;
  int dim_vos_12;
  int dim_vos_2;
  int dim_vos_3;
  int dim_w;
  int dim_w_1;
  int dim_w_2;
  int dim_wA;
  int dim_wA_1;
  int dim_wA_12;
  int dim_wA_2;
  int dim_wA_3;
  int dim_wd;
  int dim_wd_1;
  int dim_wd_2;
  int dim_wdA;
  int dim_wdA_1;
  int dim_wdA_12;
  int dim_wdA_2;
  int dim_wdA_3;
  int dim_wdI;
  int dim_wdI_1;
  int dim_wdI_12;
  int dim_wdI_2;
  int dim_wdI_3;
  int dim_wdS;
  int dim_wdS_1;
  int dim_wdS_12;
  int dim_wdS_2;
  int dim_wdS_3;
  int dim_wdT;
  int dim_wdT_1;
  int dim_wdT_12;
  int dim_wdT_2;
  int dim_wdT_3;
  int dim_wdU;
  int dim_wdU_1;
  int dim_wdU_12;
  int dim_wdU_2;
  int dim_wdU_3;
  int dim_wI;
  int dim_wI_1;
  int dim_wI_12;
  int dim_wI_2;
  int dim_wI_3;
  int dim_willing;
  int dim_wS;
  int dim_wS_1;
  int dim_wS_12;
  int dim_wS_2;
  int dim_wS_3;
  int dim_wT;
  int dim_wT_1;
  int dim_wT_12;
  int dim_wT_2;
  int dim_wT_3;
  int dim_wU;
  int dim_wU_1;
  int dim_wU_12;
  int dim_wU_2;
  int dim_wU_3;
  double enr;
  double *entrants;
  double epsilon;
  double *eta;
  double *eta_h_t;
  double *eta_l_t;
  double exr;
  double *foi_LH;
  double *I0;
  double *initial_A;
  double *initial_cum_diag_a;
  double *initial_cum_diag_s;
  double *initial_cum_entrants;
  double *initial_cum_incid;
  double *initial_cum_offered;
  double *initial_cum_offered_vbe;
  double *initial_cum_screened;
  double *initial_cum_treated;
  double *initial_cum_vaccinated;
  double *initial_cum_vaccinated_screen;
  double *initial_cum_vbe;
  double *initial_I;
  double *initial_S;
  double *initial_T;
  double *initial_U;
  void *interpolate_beta;
  void *interpolate_eta_h;
  void *interpolate_eta_l;
  void *interpolate_vax_switch;
  double *lambda;
  double mu;
  double *N;
  double *n_AT;
  double *n_AU;
  double *n_diag_rec;
  int n_group;
  double *n_obe;
  double *n_ood;
  double *n_oos;
  double *n_ST;
  double *n_TU;
  double *n_UI;
  int n_vax;
  double *n_vbe;
  double *n_vod;
  double *n_vos;
  double *Np;
  double nu;
  int offset_output_lambda;
  int offset_output_N;
  int offset_variable_A;
  int offset_variable_cum_diag_a;
  int offset_variable_cum_diag_s;
  int offset_variable_cum_entrants;
  int offset_variable_cum_incid;
  int offset_variable_cum_offered;
  int offset_variable_cum_offered_vbe;
  int offset_variable_cum_screened;
  int offset_variable_cum_treated;
  int offset_variable_cum_vaccinated;
  int offset_variable_cum_vaccinated_screen;
  int offset_variable_cum_vbe;
  int offset_variable_S;
  int offset_variable_T;
  double *p;
  double *prop_C;
  double psi;
  double *q;
  double rho;
  double *S0;
  double *screened;
  double sigma;
  double *T0;
  double *tt;
  double *u_d;
  double *u_s;
  double u_vbe;
  double *U0;
  double *vax_t;
  double *vax_y;
  double *vbe;
  double *vea;
  double *ved;
  double *vei;
  double *ves;
  double *vod;
  double *vos;
  double *w;
  double *wA;
  double *wd;
  double *wdA;
  double *wdI;
  double *wdS;
  double *wdT;
  double *wdU;
  double *wI;
  double *willing;
  double *wS;
  double *wT;
  double *wU;
} model_withoutPN_internal;
model_internal* model_get_internal(SEXP internal_p, int closed_error);
static void model_finalise(SEXP internal_p);
SEXP model_create(SEXP user);
void model_initmod_desolve(void(* odeparms) (int *, double *));
SEXP model_contents(SEXP internal_p);
SEXP model_set_user(SEXP internal_p, SEXP user);
SEXP model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_use_dde_ptr);
SEXP model_metadata(SEXP internal_p);
SEXP model_initial_conditions(SEXP internal_p, SEXP t_ptr);
void model_rhs(model_internal* internal, double t, double * state, double * dstatedt, double * output);
void model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
void model_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p);
SEXP model_rhs_r(SEXP internal_p, SEXP t, SEXP state);
model_trial_internal* model_trial_get_internal(SEXP internal_p, int closed_error);
static void model_trial_finalise(SEXP internal_p);
SEXP model_trial_create(SEXP user);
void model_trial_initmod_desolve(void(* odeparms) (int *, double *));
SEXP model_trial_contents(SEXP internal_p);
SEXP model_trial_set_user(SEXP internal_p, SEXP user);
SEXP model_trial_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_trial_use_dde_ptr);
SEXP model_trial_metadata(SEXP internal_p);
SEXP model_trial_initial_conditions(SEXP internal_p, SEXP t_ptr);
void model_trial_rhs(model_trial_internal* internal, double t, double * state, double * dstatedt, double * output);
void model_trial_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void model_trial_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
void model_trial_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p);
SEXP model_trial_rhs_r(SEXP internal_p, SEXP t, SEXP state);
model_trial_stochastic_internal* model_trial_stochastic_get_internal(SEXP internal_p, int closed_error);
static void model_trial_stochastic_finalise(SEXP internal_p);
SEXP model_trial_stochastic_create(SEXP user);
void model_trial_stochastic_initmod_desolve(void(* odeparms) (int *, double *));
SEXP model_trial_stochastic_contents(SEXP internal_p);
SEXP model_trial_stochastic_set_user(SEXP internal_p, SEXP user);
SEXP model_trial_stochastic_set_initial(SEXP internal_p, SEXP step_ptr, SEXP state_ptr);
SEXP model_trial_stochastic_metadata(SEXP internal_p);
SEXP model_trial_stochastic_initial_conditions(SEXP internal_p, SEXP step_ptr);
void model_trial_stochastic_rhs(model_trial_stochastic_internal* internal, size_t step, double * state, double * state_next, double * output);
void model_trial_stochastic_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP model_trial_stochastic_rhs_r(SEXP internal_p, SEXP step, SEXP state);
model_withouthistory_internal* model_withouthistory_get_internal(SEXP internal_p, int closed_error);
static void model_withouthistory_finalise(SEXP internal_p);
SEXP model_withouthistory_create(SEXP user);
void model_withouthistory_initmod_desolve(void(* odeparms) (int *, double *));
SEXP model_withouthistory_contents(SEXP internal_p);
SEXP model_withouthistory_set_user(SEXP internal_p, SEXP user);
SEXP model_withouthistory_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_withouthistory_use_dde_ptr);
SEXP model_withouthistory_metadata(SEXP internal_p);
SEXP model_withouthistory_initial_conditions(SEXP internal_p, SEXP t_ptr);
void model_withouthistory_rhs(model_withouthistory_internal* internal, double t, double * state, double * dstatedt, double * output);
void model_withouthistory_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void model_withouthistory_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
void model_withouthistory_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p);
SEXP model_withouthistory_rhs_r(SEXP internal_p, SEXP t, SEXP state);
model_withoutPN_internal* model_withoutPN_get_internal(SEXP internal_p, int closed_error);
static void model_withoutPN_finalise(SEXP internal_p);
SEXP model_withoutPN_create(SEXP user);
void model_withoutPN_initmod_desolve(void(* odeparms) (int *, double *));
SEXP model_withoutPN_contents(SEXP internal_p);
SEXP model_withoutPN_set_user(SEXP internal_p, SEXP user);
SEXP model_withoutPN_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_withoutPN_use_dde_ptr);
SEXP model_withoutPN_metadata(SEXP internal_p);
SEXP model_withoutPN_initial_conditions(SEXP internal_p, SEXP t_ptr);
void model_withoutPN_rhs(model_withoutPN_internal* internal, double t, double * state, double * dstatedt, double * output);
void model_withoutPN_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal);
void model_withoutPN_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np);
void model_withoutPN_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p);
SEXP model_withoutPN_rhs_r(SEXP internal_p, SEXP t, SEXP state);
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max);
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max);
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name);
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name);
void user_check_values(SEXP value, double min, double max,
                           const char *name);
SEXP user_list_element(SEXP list, const char *name);
void odin_set_dim(SEXP target, int rank, ...);
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim);
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...);
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max);
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required);
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target);
double odin_sum1(double *x, size_t from, size_t to);
int odin_isum1(int *x, size_t from, size_t to);
double scalar_real(SEXP x, const char * name);
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1);
double odin_sum3(double* x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12);
int scalar_int(SEXP x, const char * name);
model_internal* model_get_internal(SEXP internal_p, int closed_error) {
  model_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (model_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void model_finalise(SEXP internal_p) {
  model_internal *internal = model_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_beta);
    cinterpolate_free(internal->interpolate_eta_h);
    cinterpolate_free(internal->interpolate_eta_l);
    cinterpolate_free(internal->interpolate_vax_switch);
    internal->interpolate_beta = NULL;
    internal->interpolate_eta_h = NULL;
    internal->interpolate_eta_l = NULL;
    internal->interpolate_vax_switch = NULL;
    R_Free(internal->A0);
    R_Free(internal->beta_t);
    R_Free(internal->C);
    R_Free(internal->C_hesgroup);
    R_Free(internal->Cp);
    R_Free(internal->diag_rec);
    R_Free(internal->entrants);
    R_Free(internal->eta);
    R_Free(internal->eta_h_t);
    R_Free(internal->eta_l_t);
    R_Free(internal->foi_LH);
    R_Free(internal->hesgroupmatrix);
    R_Free(internal->I0);
    R_Free(internal->initial_A);
    R_Free(internal->initial_cum_diag_a);
    R_Free(internal->initial_cum_diag_s);
    R_Free(internal->initial_cum_entrants);
    R_Free(internal->initial_cum_incid);
    R_Free(internal->initial_cum_offered);
    R_Free(internal->initial_cum_offered_pn);
    R_Free(internal->initial_cum_offered_vbe);
    R_Free(internal->initial_cum_screened);
    R_Free(internal->initial_cum_treated);
    R_Free(internal->initial_cum_vaccinated);
    R_Free(internal->initial_cum_vaccinated_pn);
    R_Free(internal->initial_cum_vaccinated_screen);
    R_Free(internal->initial_cum_vbe);
    R_Free(internal->initial_I);
    R_Free(internal->initial_S);
    R_Free(internal->initial_T);
    R_Free(internal->initial_U);
    R_Free(internal->lambda);
    R_Free(internal->N);
    R_Free(internal->n_AT);
    R_Free(internal->n_AU);
    R_Free(internal->n_diag_rec);
    R_Free(internal->N_hesgroup);
    R_Free(internal->n_obe);
    R_Free(internal->n_ood);
    R_Free(internal->n_oopn);
    R_Free(internal->n_oos);
    R_Free(internal->n_ST);
    R_Free(internal->n_TU);
    R_Free(internal->n_UI);
    R_Free(internal->n_vbe);
    R_Free(internal->n_vod);
    R_Free(internal->n_vopn);
    R_Free(internal->n_vos);
    R_Free(internal->notifiedandattended);
    R_Free(internal->Np);
    R_Free(internal->omega_C);
    R_Free(internal->omega_C_withdiag);
    R_Free(internal->omega_C_withdiag_rg);
    R_Free(internal->omega_U);
    R_Free(internal->omega_U_withdiag);
    R_Free(internal->omega_U_withdiag_rg);
    R_Free(internal->p);
    R_Free(internal->phi);
    R_Free(internal->prop_C);
    R_Free(internal->prop_C_hesgroup);
    R_Free(internal->prop_C_hesriskgroup);
    R_Free(internal->prop_CCsubgroup);
    R_Free(internal->prop_UUsubgroup);
    R_Free(internal->q);
    R_Free(internal->S0);
    R_Free(internal->screened);
    R_Free(internal->T0);
    R_Free(internal->tt);
    R_Free(internal->u_d);
    R_Free(internal->u_pn);
    R_Free(internal->u_s);
    R_Free(internal->U0);
    R_Free(internal->Up);
    R_Free(internal->vax_t);
    R_Free(internal->vax_y);
    R_Free(internal->vbe);
    R_Free(internal->vea);
    R_Free(internal->ved);
    R_Free(internal->vei);
    R_Free(internal->ves);
    R_Free(internal->vod);
    R_Free(internal->vopn);
    R_Free(internal->vos);
    R_Free(internal->w);
    R_Free(internal->wA);
    R_Free(internal->wd);
    R_Free(internal->wdA);
    R_Free(internal->wdI);
    R_Free(internal->wdS);
    R_Free(internal->wdT);
    R_Free(internal->wdU);
    R_Free(internal->wI);
    R_Free(internal->willing);
    R_Free(internal->wS);
    R_Free(internal->wT);
    R_Free(internal->wU);
    R_Free(internal->xi);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP model_create(SEXP user) {
  model_internal *internal = (model_internal*) R_Calloc(1, model_internal);
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->C = NULL;
  internal->C_hesgroup = NULL;
  internal->Cp = NULL;
  internal->diag_rec = NULL;
  internal->entrants = NULL;
  internal->eta = NULL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->foi_LH = NULL;
  internal->hesgroupmatrix = NULL;
  internal->I0 = NULL;
  internal->initial_A = NULL;
  internal->initial_cum_diag_a = NULL;
  internal->initial_cum_diag_s = NULL;
  internal->initial_cum_entrants = NULL;
  internal->initial_cum_incid = NULL;
  internal->initial_cum_offered = NULL;
  internal->initial_cum_offered_pn = NULL;
  internal->initial_cum_offered_vbe = NULL;
  internal->initial_cum_screened = NULL;
  internal->initial_cum_treated = NULL;
  internal->initial_cum_vaccinated = NULL;
  internal->initial_cum_vaccinated_pn = NULL;
  internal->initial_cum_vaccinated_screen = NULL;
  internal->initial_cum_vbe = NULL;
  internal->initial_I = NULL;
  internal->initial_S = NULL;
  internal->initial_T = NULL;
  internal->initial_U = NULL;
  internal->lambda = NULL;
  internal->N = NULL;
  internal->n_AT = NULL;
  internal->n_AU = NULL;
  internal->n_diag_rec = NULL;
  internal->N_hesgroup = NULL;
  internal->n_obe = NULL;
  internal->n_ood = NULL;
  internal->n_oopn = NULL;
  internal->n_oos = NULL;
  internal->n_ST = NULL;
  internal->n_TU = NULL;
  internal->n_UI = NULL;
  internal->n_vbe = NULL;
  internal->n_vod = NULL;
  internal->n_vopn = NULL;
  internal->n_vos = NULL;
  internal->notifiedandattended = NULL;
  internal->Np = NULL;
  internal->omega_C = NULL;
  internal->omega_C_withdiag = NULL;
  internal->omega_C_withdiag_rg = NULL;
  internal->omega_U = NULL;
  internal->omega_U_withdiag = NULL;
  internal->omega_U_withdiag_rg = NULL;
  internal->p = NULL;
  internal->phi = NULL;
  internal->prop_C = NULL;
  internal->prop_C_hesgroup = NULL;
  internal->prop_C_hesriskgroup = NULL;
  internal->prop_CCsubgroup = NULL;
  internal->prop_UUsubgroup = NULL;
  internal->q = NULL;
  internal->S0 = NULL;
  internal->screened = NULL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u_d = NULL;
  internal->u_pn = NULL;
  internal->u_s = NULL;
  internal->U0 = NULL;
  internal->Up = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vopn = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->wA = NULL;
  internal->wd = NULL;
  internal->wdA = NULL;
  internal->wdI = NULL;
  internal->wdS = NULL;
  internal->wdT = NULL;
  internal->wdU = NULL;
  internal->wI = NULL;
  internal->willing = NULL;
  internal->wS = NULL;
  internal->wT = NULL;
  internal->wU = NULL;
  internal->xi = NULL;
  internal->n_group = 2;
  internal->dim_Cp = internal->n_group;
  internal->dim_eta = internal->n_group;
  internal->dim_foi_LH = internal->n_group;
  internal->dim_Np = internal->n_group;
  internal->dim_omega_C_1 = internal->n_group;
  internal->dim_omega_C_2 = internal->n_group;
  internal->dim_omega_C_withdiag_1 = internal->n_group;
  internal->dim_omega_C_withdiag_2 = internal->n_group;
  internal->dim_omega_C_withdiag_rg = internal->n_group;
  internal->dim_omega_U_1 = internal->n_group;
  internal->dim_omega_U_2 = internal->n_group;
  internal->dim_omega_U_withdiag_1 = internal->n_group;
  internal->dim_omega_U_withdiag_2 = internal->n_group;
  internal->dim_omega_U_withdiag_rg = internal->n_group;
  internal->dim_p = internal->n_group;
  internal->dim_prop_C = internal->n_group;
  internal->dim_q = internal->n_group;
  internal->dim_Up = internal->n_group;
  R_Free(internal->Cp);
  internal->Cp = (double*) R_Calloc(internal->dim_Cp, double);
  R_Free(internal->eta);
  internal->eta = (double*) R_Calloc(internal->dim_eta, double);
  R_Free(internal->foi_LH);
  internal->foi_LH = (double*) R_Calloc(internal->dim_foi_LH, double);
  R_Free(internal->Np);
  internal->Np = (double*) R_Calloc(internal->dim_Np, double);
  R_Free(internal->omega_C_withdiag_rg);
  internal->omega_C_withdiag_rg = (double*) R_Calloc(internal->dim_omega_C_withdiag_rg, double);
  R_Free(internal->omega_U_withdiag_rg);
  internal->omega_U_withdiag_rg = (double*) R_Calloc(internal->dim_omega_U_withdiag_rg, double);
  R_Free(internal->prop_C);
  internal->prop_C = (double*) R_Calloc(internal->dim_prop_C, double);
  R_Free(internal->Up);
  internal->Up = (double*) R_Calloc(internal->dim_Up, double);
  internal->dim_omega_C = internal->dim_omega_C_1 * internal->dim_omega_C_2;
  internal->dim_omega_C_withdiag = internal->dim_omega_C_withdiag_1 * internal->dim_omega_C_withdiag_2;
  internal->dim_omega_U = internal->dim_omega_U_1 * internal->dim_omega_U_2;
  internal->dim_omega_U_withdiag = internal->dim_omega_U_withdiag_1 * internal->dim_omega_U_withdiag_2;
  internal->offset_output_prop_C_hesgroup = internal->dim_eta + 3;
  R_Free(internal->omega_C);
  internal->omega_C = (double*) R_Calloc(internal->dim_omega_C, double);
  R_Free(internal->omega_C_withdiag);
  internal->omega_C_withdiag = (double*) R_Calloc(internal->dim_omega_C_withdiag, double);
  R_Free(internal->omega_U);
  internal->omega_U = (double*) R_Calloc(internal->dim_omega_U, double);
  R_Free(internal->omega_U_withdiag);
  internal->omega_U_withdiag = (double*) R_Calloc(internal->dim_omega_U_withdiag, double);
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->diag_rec = NULL;
  internal->enr = NA_REAL;
  internal->epsilon = NA_REAL;
  internal->epsilon_hes = NA_REAL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->exr = NA_REAL;
  internal->hesgroupmatrix = NULL;
  internal->I0 = NULL;
  internal->kappa = NA_REAL;
  internal->mu = NA_REAL;
  internal->notifiedprev = NA_REAL;
  internal->nu = NA_REAL;
  internal->p = NULL;
  internal->psi = NA_REAL;
  internal->q = NULL;
  internal->rho = NA_REAL;
  internal->S0 = NULL;
  internal->sigma = NA_REAL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u_d = NULL;
  internal->u_pn = NULL;
  internal->u_s = NULL;
  internal->u_vbe = NA_REAL;
  internal->U0 = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vopn = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->wd = NULL;
  internal->willing = NULL;
  internal->n_vax = 1;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, model_finalise);
  UNPROTECT(1);
  return ptr;
}
static model_internal *model_internal_ds;
void model_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  model_internal_ds = model_get_internal(get_desolve_gparms(), 1);
}
SEXP model_contents(SEXP internal_p) {
  model_internal *internal = model_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 442));
  SEXP A0 = PROTECT(allocVector(REALSXP, internal->dim_A0));
  memcpy(REAL(A0), internal->A0, internal->dim_A0 * sizeof(double));
  odin_set_dim(A0, 2, internal->dim_A0_1, internal->dim_A0_2);
  SET_VECTOR_ELT(contents, 0, A0);
  SEXP beta_t = PROTECT(allocVector(REALSXP, internal->dim_beta_t));
  memcpy(REAL(beta_t), internal->beta_t, internal->dim_beta_t * sizeof(double));
  SET_VECTOR_ELT(contents, 1, beta_t);
  SEXP C = PROTECT(allocVector(REALSXP, internal->dim_C));
  memcpy(REAL(C), internal->C, internal->dim_C * sizeof(double));
  odin_set_dim(C, 2, internal->dim_C_1, internal->dim_C_2);
  SET_VECTOR_ELT(contents, 2, C);
  SEXP C_hesgroup = PROTECT(allocVector(REALSXP, internal->dim_C_hesgroup));
  memcpy(REAL(C_hesgroup), internal->C_hesgroup, internal->dim_C_hesgroup * sizeof(double));
  odin_set_dim(C_hesgroup, 3, internal->dim_C_hesgroup_1, internal->dim_C_hesgroup_2, internal->dim_C_hesgroup_3);
  SET_VECTOR_ELT(contents, 3, C_hesgroup);
  SEXP Cp = PROTECT(allocVector(REALSXP, internal->dim_Cp));
  memcpy(REAL(Cp), internal->Cp, internal->dim_Cp * sizeof(double));
  SET_VECTOR_ELT(contents, 4, Cp);
  SEXP diag_rec = PROTECT(allocVector(REALSXP, internal->dim_diag_rec));
  memcpy(REAL(diag_rec), internal->diag_rec, internal->dim_diag_rec * sizeof(double));
  odin_set_dim(diag_rec, 3, internal->dim_diag_rec_1, internal->dim_diag_rec_2, internal->dim_diag_rec_3);
  SET_VECTOR_ELT(contents, 5, diag_rec);
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_A));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_A_1));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_A_2));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_A0));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_A0_1));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_A0_2));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_beta_t));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_C));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_C_1));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_C_2));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_C_hesgroup));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_C_hesgroup_1));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_C_hesgroup_12));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_C_hesgroup_2));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_C_hesgroup_3));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_Cp));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_cum_diag_a));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_cum_diag_a_1));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_cum_diag_a_2));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_cum_diag_s));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_cum_diag_s_1));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_cum_diag_s_2));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_cum_entrants));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_cum_entrants_1));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_cum_entrants_2));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_cum_incid));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_cum_incid_1));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_cum_incid_2));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_cum_offered));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_cum_offered_1));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_cum_offered_2));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_cum_offered_pn));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_cum_offered_pn_1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_cum_offered_pn_2));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_cum_offered_vbe_1));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_cum_offered_vbe_2));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_cum_screened));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_cum_screened_1));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_cum_screened_2));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_cum_treated));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_cum_treated_1));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_cum_treated_2));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_cum_vaccinated));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_cum_vaccinated_1));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_cum_vaccinated_2));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_cum_vaccinated_pn));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_cum_vaccinated_pn_1));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_cum_vaccinated_pn_2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_cum_vaccinated_screen));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_cum_vaccinated_screen_1));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_cum_vaccinated_screen_2));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_cum_vbe));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_cum_vbe_1));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_cum_vbe_2));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_diag_rec));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_diag_rec_1));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_diag_rec_12));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_diag_rec_2));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_diag_rec_3));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_entrants));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_entrants_1));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_entrants_2));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_eta_h_t));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_eta_l_t));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_foi_LH));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_hesgroupmatrix));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_hesgroupmatrix_1));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_hesgroupmatrix_2));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_I_1));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_I_2));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_I0));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_I0_1));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_I0_2));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_lambda));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_lambda_1));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_lambda_2));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_n_AT));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_n_AT_1));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_n_AT_2));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_n_AU));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_n_AU_1));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_n_AU_2));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_n_diag_rec));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_n_diag_rec_1));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_n_diag_rec_12));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_n_diag_rec_2));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_n_diag_rec_3));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_N_hesgroup));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_N_hesgroup_1));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_N_hesgroup_12));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_N_hesgroup_2));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_N_hesgroup_3));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_n_obe));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_n_obe_1));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_n_obe_12));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_n_obe_2));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_n_obe_3));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_n_ood));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_n_ood_1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_n_ood_12));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_n_ood_2));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_n_ood_3));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_n_oopn));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_n_oopn_1));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_n_oopn_12));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_n_oopn_2));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_n_oopn_3));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_n_oos));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_n_oos_1));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_n_oos_12));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_n_oos_2));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_n_oos_3));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_n_ST));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_n_ST_1));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_n_ST_2));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_n_TU));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_n_TU_1));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_n_TU_2));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_n_UI));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_n_UI_1));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_n_UI_2));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_n_vbe));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_n_vbe_1));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_n_vbe_12));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_n_vbe_2));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_n_vbe_3));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_n_vod));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_n_vod_1));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_n_vod_12));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_n_vod_2));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_n_vod_3));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_n_vopn));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_n_vopn_1));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_n_vopn_12));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_n_vopn_2));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_n_vopn_3));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_n_vos));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_n_vos_1));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_n_vos_12));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_n_vos_2));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_n_vos_3));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_notifiedandattended));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_notifiedandattended_1));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_notifiedandattended_2));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_Np));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_omega_C));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_omega_C_1));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_omega_C_2));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_omega_C_withdiag));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_omega_C_withdiag_1));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_omega_C_withdiag_2));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_omega_C_withdiag_rg));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_omega_U));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_omega_U_1));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_omega_U_2));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_omega_U_withdiag));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_omega_U_withdiag_1));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_omega_U_withdiag_2));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_omega_U_withdiag_rg));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_p));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_phi));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_phi_1));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_phi_2));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_prop_C));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_prop_C_hesgroup));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_prop_C_hesriskgroup));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_prop_C_hesriskgroup_1));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_prop_C_hesriskgroup_2));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_prop_CCsubgroup));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_prop_CCsubgroup_1));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_prop_CCsubgroup_2));
  SET_VECTOR_ELT(contents, 183, ScalarInteger(internal->dim_prop_UUsubgroup));
  SET_VECTOR_ELT(contents, 184, ScalarInteger(internal->dim_prop_UUsubgroup_1));
  SET_VECTOR_ELT(contents, 185, ScalarInteger(internal->dim_prop_UUsubgroup_2));
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->dim_q));
  SET_VECTOR_ELT(contents, 187, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->dim_S0));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->dim_S0_1));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->dim_S0_2));
  SET_VECTOR_ELT(contents, 193, ScalarInteger(internal->dim_screened));
  SET_VECTOR_ELT(contents, 194, ScalarInteger(internal->dim_screened_1));
  SET_VECTOR_ELT(contents, 195, ScalarInteger(internal->dim_screened_2));
  SET_VECTOR_ELT(contents, 196, ScalarInteger(internal->dim_T));
  SET_VECTOR_ELT(contents, 197, ScalarInteger(internal->dim_T_1));
  SET_VECTOR_ELT(contents, 198, ScalarInteger(internal->dim_T_2));
  SET_VECTOR_ELT(contents, 199, ScalarInteger(internal->dim_T0));
  SET_VECTOR_ELT(contents, 200, ScalarInteger(internal->dim_T0_1));
  SET_VECTOR_ELT(contents, 201, ScalarInteger(internal->dim_T0_2));
  SET_VECTOR_ELT(contents, 202, ScalarInteger(internal->dim_tt));
  SET_VECTOR_ELT(contents, 203, ScalarInteger(internal->dim_U));
  SET_VECTOR_ELT(contents, 204, ScalarInteger(internal->dim_U_1));
  SET_VECTOR_ELT(contents, 205, ScalarInteger(internal->dim_U_2));
  SET_VECTOR_ELT(contents, 206, ScalarInteger(internal->dim_u_d));
  SET_VECTOR_ELT(contents, 207, ScalarInteger(internal->dim_u_d_1));
  SET_VECTOR_ELT(contents, 208, ScalarInteger(internal->dim_u_d_12));
  SET_VECTOR_ELT(contents, 209, ScalarInteger(internal->dim_u_d_2));
  SET_VECTOR_ELT(contents, 210, ScalarInteger(internal->dim_u_d_3));
  SET_VECTOR_ELT(contents, 211, ScalarInteger(internal->dim_u_pn));
  SET_VECTOR_ELT(contents, 212, ScalarInteger(internal->dim_u_pn_1));
  SET_VECTOR_ELT(contents, 213, ScalarInteger(internal->dim_u_pn_12));
  SET_VECTOR_ELT(contents, 214, ScalarInteger(internal->dim_u_pn_2));
  SET_VECTOR_ELT(contents, 215, ScalarInteger(internal->dim_u_pn_3));
  SET_VECTOR_ELT(contents, 216, ScalarInteger(internal->dim_u_s));
  SET_VECTOR_ELT(contents, 217, ScalarInteger(internal->dim_u_s_1));
  SET_VECTOR_ELT(contents, 218, ScalarInteger(internal->dim_u_s_12));
  SET_VECTOR_ELT(contents, 219, ScalarInteger(internal->dim_u_s_2));
  SET_VECTOR_ELT(contents, 220, ScalarInteger(internal->dim_u_s_3));
  SET_VECTOR_ELT(contents, 221, ScalarInteger(internal->dim_U0));
  SET_VECTOR_ELT(contents, 222, ScalarInteger(internal->dim_U0_1));
  SET_VECTOR_ELT(contents, 223, ScalarInteger(internal->dim_U0_2));
  SET_VECTOR_ELT(contents, 224, ScalarInteger(internal->dim_Up));
  SET_VECTOR_ELT(contents, 225, ScalarInteger(internal->dim_vax_t));
  SET_VECTOR_ELT(contents, 226, ScalarInteger(internal->dim_vax_y));
  SET_VECTOR_ELT(contents, 227, ScalarInteger(internal->dim_vbe));
  SET_VECTOR_ELT(contents, 228, ScalarInteger(internal->dim_vbe_1));
  SET_VECTOR_ELT(contents, 229, ScalarInteger(internal->dim_vbe_12));
  SET_VECTOR_ELT(contents, 230, ScalarInteger(internal->dim_vbe_2));
  SET_VECTOR_ELT(contents, 231, ScalarInteger(internal->dim_vbe_3));
  SET_VECTOR_ELT(contents, 232, ScalarInteger(internal->dim_vea));
  SET_VECTOR_ELT(contents, 233, ScalarInteger(internal->dim_ved));
  SET_VECTOR_ELT(contents, 234, ScalarInteger(internal->dim_vei));
  SET_VECTOR_ELT(contents, 235, ScalarInteger(internal->dim_ves));
  SET_VECTOR_ELT(contents, 236, ScalarInteger(internal->dim_vod));
  SET_VECTOR_ELT(contents, 237, ScalarInteger(internal->dim_vod_1));
  SET_VECTOR_ELT(contents, 238, ScalarInteger(internal->dim_vod_12));
  SET_VECTOR_ELT(contents, 239, ScalarInteger(internal->dim_vod_2));
  SET_VECTOR_ELT(contents, 240, ScalarInteger(internal->dim_vod_3));
  SET_VECTOR_ELT(contents, 241, ScalarInteger(internal->dim_vopn));
  SET_VECTOR_ELT(contents, 242, ScalarInteger(internal->dim_vopn_1));
  SET_VECTOR_ELT(contents, 243, ScalarInteger(internal->dim_vopn_12));
  SET_VECTOR_ELT(contents, 244, ScalarInteger(internal->dim_vopn_2));
  SET_VECTOR_ELT(contents, 245, ScalarInteger(internal->dim_vopn_3));
  SET_VECTOR_ELT(contents, 246, ScalarInteger(internal->dim_vos));
  SET_VECTOR_ELT(contents, 247, ScalarInteger(internal->dim_vos_1));
  SET_VECTOR_ELT(contents, 248, ScalarInteger(internal->dim_vos_12));
  SET_VECTOR_ELT(contents, 249, ScalarInteger(internal->dim_vos_2));
  SET_VECTOR_ELT(contents, 250, ScalarInteger(internal->dim_vos_3));
  SET_VECTOR_ELT(contents, 251, ScalarInteger(internal->dim_w));
  SET_VECTOR_ELT(contents, 252, ScalarInteger(internal->dim_w_1));
  SET_VECTOR_ELT(contents, 253, ScalarInteger(internal->dim_w_2));
  SET_VECTOR_ELT(contents, 254, ScalarInteger(internal->dim_wA));
  SET_VECTOR_ELT(contents, 255, ScalarInteger(internal->dim_wA_1));
  SET_VECTOR_ELT(contents, 256, ScalarInteger(internal->dim_wA_12));
  SET_VECTOR_ELT(contents, 257, ScalarInteger(internal->dim_wA_2));
  SET_VECTOR_ELT(contents, 258, ScalarInteger(internal->dim_wA_3));
  SET_VECTOR_ELT(contents, 259, ScalarInteger(internal->dim_wd));
  SET_VECTOR_ELT(contents, 260, ScalarInteger(internal->dim_wd_1));
  SET_VECTOR_ELT(contents, 261, ScalarInteger(internal->dim_wd_2));
  SET_VECTOR_ELT(contents, 262, ScalarInteger(internal->dim_wdA));
  SET_VECTOR_ELT(contents, 263, ScalarInteger(internal->dim_wdA_1));
  SET_VECTOR_ELT(contents, 264, ScalarInteger(internal->dim_wdA_12));
  SET_VECTOR_ELT(contents, 265, ScalarInteger(internal->dim_wdA_2));
  SET_VECTOR_ELT(contents, 266, ScalarInteger(internal->dim_wdA_3));
  SET_VECTOR_ELT(contents, 267, ScalarInteger(internal->dim_wdI));
  SET_VECTOR_ELT(contents, 268, ScalarInteger(internal->dim_wdI_1));
  SET_VECTOR_ELT(contents, 269, ScalarInteger(internal->dim_wdI_12));
  SET_VECTOR_ELT(contents, 270, ScalarInteger(internal->dim_wdI_2));
  SET_VECTOR_ELT(contents, 271, ScalarInteger(internal->dim_wdI_3));
  SET_VECTOR_ELT(contents, 272, ScalarInteger(internal->dim_wdS));
  SET_VECTOR_ELT(contents, 273, ScalarInteger(internal->dim_wdS_1));
  SET_VECTOR_ELT(contents, 274, ScalarInteger(internal->dim_wdS_12));
  SET_VECTOR_ELT(contents, 275, ScalarInteger(internal->dim_wdS_2));
  SET_VECTOR_ELT(contents, 276, ScalarInteger(internal->dim_wdS_3));
  SET_VECTOR_ELT(contents, 277, ScalarInteger(internal->dim_wdT));
  SET_VECTOR_ELT(contents, 278, ScalarInteger(internal->dim_wdT_1));
  SET_VECTOR_ELT(contents, 279, ScalarInteger(internal->dim_wdT_12));
  SET_VECTOR_ELT(contents, 280, ScalarInteger(internal->dim_wdT_2));
  SET_VECTOR_ELT(contents, 281, ScalarInteger(internal->dim_wdT_3));
  SET_VECTOR_ELT(contents, 282, ScalarInteger(internal->dim_wdU));
  SET_VECTOR_ELT(contents, 283, ScalarInteger(internal->dim_wdU_1));
  SET_VECTOR_ELT(contents, 284, ScalarInteger(internal->dim_wdU_12));
  SET_VECTOR_ELT(contents, 285, ScalarInteger(internal->dim_wdU_2));
  SET_VECTOR_ELT(contents, 286, ScalarInteger(internal->dim_wdU_3));
  SET_VECTOR_ELT(contents, 287, ScalarInteger(internal->dim_wI));
  SET_VECTOR_ELT(contents, 288, ScalarInteger(internal->dim_wI_1));
  SET_VECTOR_ELT(contents, 289, ScalarInteger(internal->dim_wI_12));
  SET_VECTOR_ELT(contents, 290, ScalarInteger(internal->dim_wI_2));
  SET_VECTOR_ELT(contents, 291, ScalarInteger(internal->dim_wI_3));
  SET_VECTOR_ELT(contents, 292, ScalarInteger(internal->dim_willing));
  SET_VECTOR_ELT(contents, 293, ScalarInteger(internal->dim_wS));
  SET_VECTOR_ELT(contents, 294, ScalarInteger(internal->dim_wS_1));
  SET_VECTOR_ELT(contents, 295, ScalarInteger(internal->dim_wS_12));
  SET_VECTOR_ELT(contents, 296, ScalarInteger(internal->dim_wS_2));
  SET_VECTOR_ELT(contents, 297, ScalarInteger(internal->dim_wS_3));
  SET_VECTOR_ELT(contents, 298, ScalarInteger(internal->dim_wT));
  SET_VECTOR_ELT(contents, 299, ScalarInteger(internal->dim_wT_1));
  SET_VECTOR_ELT(contents, 300, ScalarInteger(internal->dim_wT_12));
  SET_VECTOR_ELT(contents, 301, ScalarInteger(internal->dim_wT_2));
  SET_VECTOR_ELT(contents, 302, ScalarInteger(internal->dim_wT_3));
  SET_VECTOR_ELT(contents, 303, ScalarInteger(internal->dim_wU));
  SET_VECTOR_ELT(contents, 304, ScalarInteger(internal->dim_wU_1));
  SET_VECTOR_ELT(contents, 305, ScalarInteger(internal->dim_wU_12));
  SET_VECTOR_ELT(contents, 306, ScalarInteger(internal->dim_wU_2));
  SET_VECTOR_ELT(contents, 307, ScalarInteger(internal->dim_wU_3));
  SET_VECTOR_ELT(contents, 308, ScalarInteger(internal->dim_xi));
  SET_VECTOR_ELT(contents, 309, ScalarInteger(internal->dim_xi_1));
  SET_VECTOR_ELT(contents, 310, ScalarInteger(internal->dim_xi_2));
  SET_VECTOR_ELT(contents, 311, ScalarReal(internal->enr));
  SEXP entrants = PROTECT(allocVector(REALSXP, internal->dim_entrants));
  memcpy(REAL(entrants), internal->entrants, internal->dim_entrants * sizeof(double));
  odin_set_dim(entrants, 2, internal->dim_entrants_1, internal->dim_entrants_2);
  SET_VECTOR_ELT(contents, 312, entrants);
  SET_VECTOR_ELT(contents, 313, ScalarReal(internal->epsilon));
  SET_VECTOR_ELT(contents, 314, ScalarReal(internal->epsilon_hes));
  SEXP eta = PROTECT(allocVector(REALSXP, internal->dim_eta));
  memcpy(REAL(eta), internal->eta, internal->dim_eta * sizeof(double));
  SET_VECTOR_ELT(contents, 315, eta);
  SEXP eta_h_t = PROTECT(allocVector(REALSXP, internal->dim_eta_h_t));
  memcpy(REAL(eta_h_t), internal->eta_h_t, internal->dim_eta_h_t * sizeof(double));
  SET_VECTOR_ELT(contents, 316, eta_h_t);
  SEXP eta_l_t = PROTECT(allocVector(REALSXP, internal->dim_eta_l_t));
  memcpy(REAL(eta_l_t), internal->eta_l_t, internal->dim_eta_l_t * sizeof(double));
  SET_VECTOR_ELT(contents, 317, eta_l_t);
  SET_VECTOR_ELT(contents, 318, ScalarReal(internal->exr));
  SEXP foi_LH = PROTECT(allocVector(REALSXP, internal->dim_foi_LH));
  memcpy(REAL(foi_LH), internal->foi_LH, internal->dim_foi_LH * sizeof(double));
  SET_VECTOR_ELT(contents, 319, foi_LH);
  SEXP hesgroupmatrix = PROTECT(allocVector(REALSXP, internal->dim_hesgroupmatrix));
  memcpy(REAL(hesgroupmatrix), internal->hesgroupmatrix, internal->dim_hesgroupmatrix * sizeof(double));
  odin_set_dim(hesgroupmatrix, 2, internal->dim_hesgroupmatrix_1, internal->dim_hesgroupmatrix_2);
  SET_VECTOR_ELT(contents, 320, hesgroupmatrix);
  SEXP I0 = PROTECT(allocVector(REALSXP, internal->dim_I0));
  memcpy(REAL(I0), internal->I0, internal->dim_I0 * sizeof(double));
  odin_set_dim(I0, 2, internal->dim_I0_1, internal->dim_I0_2);
  SET_VECTOR_ELT(contents, 321, I0);
  SEXP initial_A = PROTECT(allocVector(REALSXP, internal->dim_A));
  memcpy(REAL(initial_A), internal->initial_A, internal->dim_A * sizeof(double));
  odin_set_dim(initial_A, 2, internal->dim_A_1, internal->dim_A_2);
  SET_VECTOR_ELT(contents, 322, initial_A);
  SEXP initial_cum_diag_a = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_a));
  memcpy(REAL(initial_cum_diag_a), internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  odin_set_dim(initial_cum_diag_a, 2, internal->dim_cum_diag_a_1, internal->dim_cum_diag_a_2);
  SET_VECTOR_ELT(contents, 323, initial_cum_diag_a);
  SEXP initial_cum_diag_s = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_s));
  memcpy(REAL(initial_cum_diag_s), internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  odin_set_dim(initial_cum_diag_s, 2, internal->dim_cum_diag_s_1, internal->dim_cum_diag_s_2);
  SET_VECTOR_ELT(contents, 324, initial_cum_diag_s);
  SEXP initial_cum_entrants = PROTECT(allocVector(REALSXP, internal->dim_cum_entrants));
  memcpy(REAL(initial_cum_entrants), internal->initial_cum_entrants, internal->dim_cum_entrants * sizeof(double));
  odin_set_dim(initial_cum_entrants, 2, internal->dim_cum_entrants_1, internal->dim_cum_entrants_2);
  SET_VECTOR_ELT(contents, 325, initial_cum_entrants);
  SEXP initial_cum_incid = PROTECT(allocVector(REALSXP, internal->dim_cum_incid));
  memcpy(REAL(initial_cum_incid), internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  odin_set_dim(initial_cum_incid, 2, internal->dim_cum_incid_1, internal->dim_cum_incid_2);
  SET_VECTOR_ELT(contents, 326, initial_cum_incid);
  SEXP initial_cum_offered = PROTECT(allocVector(REALSXP, internal->dim_cum_offered));
  memcpy(REAL(initial_cum_offered), internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  odin_set_dim(initial_cum_offered, 2, internal->dim_cum_offered_1, internal->dim_cum_offered_2);
  SET_VECTOR_ELT(contents, 327, initial_cum_offered);
  SEXP initial_cum_offered_pn = PROTECT(allocVector(REALSXP, internal->dim_cum_offered_pn));
  memcpy(REAL(initial_cum_offered_pn), internal->initial_cum_offered_pn, internal->dim_cum_offered_pn * sizeof(double));
  odin_set_dim(initial_cum_offered_pn, 2, internal->dim_cum_offered_pn_1, internal->dim_cum_offered_pn_2);
  SET_VECTOR_ELT(contents, 328, initial_cum_offered_pn);
  SEXP initial_cum_offered_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_offered_vbe));
  memcpy(REAL(initial_cum_offered_vbe), internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  odin_set_dim(initial_cum_offered_vbe, 2, internal->dim_cum_offered_vbe_1, internal->dim_cum_offered_vbe_2);
  SET_VECTOR_ELT(contents, 329, initial_cum_offered_vbe);
  SEXP initial_cum_screened = PROTECT(allocVector(REALSXP, internal->dim_cum_screened));
  memcpy(REAL(initial_cum_screened), internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  odin_set_dim(initial_cum_screened, 2, internal->dim_cum_screened_1, internal->dim_cum_screened_2);
  SET_VECTOR_ELT(contents, 330, initial_cum_screened);
  SEXP initial_cum_treated = PROTECT(allocVector(REALSXP, internal->dim_cum_treated));
  memcpy(REAL(initial_cum_treated), internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  odin_set_dim(initial_cum_treated, 2, internal->dim_cum_treated_1, internal->dim_cum_treated_2);
  SET_VECTOR_ELT(contents, 331, initial_cum_treated);
  SEXP initial_cum_vaccinated = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated));
  memcpy(REAL(initial_cum_vaccinated), internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  odin_set_dim(initial_cum_vaccinated, 2, internal->dim_cum_vaccinated_1, internal->dim_cum_vaccinated_2);
  SET_VECTOR_ELT(contents, 332, initial_cum_vaccinated);
  SEXP initial_cum_vaccinated_pn = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated_pn));
  memcpy(REAL(initial_cum_vaccinated_pn), internal->initial_cum_vaccinated_pn, internal->dim_cum_vaccinated_pn * sizeof(double));
  odin_set_dim(initial_cum_vaccinated_pn, 2, internal->dim_cum_vaccinated_pn_1, internal->dim_cum_vaccinated_pn_2);
  SET_VECTOR_ELT(contents, 333, initial_cum_vaccinated_pn);
  SEXP initial_cum_vaccinated_screen = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated_screen));
  memcpy(REAL(initial_cum_vaccinated_screen), internal->initial_cum_vaccinated_screen, internal->dim_cum_vaccinated_screen * sizeof(double));
  odin_set_dim(initial_cum_vaccinated_screen, 2, internal->dim_cum_vaccinated_screen_1, internal->dim_cum_vaccinated_screen_2);
  SET_VECTOR_ELT(contents, 334, initial_cum_vaccinated_screen);
  SEXP initial_cum_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_vbe));
  memcpy(REAL(initial_cum_vbe), internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  odin_set_dim(initial_cum_vbe, 2, internal->dim_cum_vbe_1, internal->dim_cum_vbe_2);
  SET_VECTOR_ELT(contents, 335, initial_cum_vbe);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  odin_set_dim(initial_I, 2, internal->dim_I_1, internal->dim_I_2);
  SET_VECTOR_ELT(contents, 336, initial_I);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 2, internal->dim_S_1, internal->dim_S_2);
  SET_VECTOR_ELT(contents, 337, initial_S);
  SEXP initial_T = PROTECT(allocVector(REALSXP, internal->dim_T));
  memcpy(REAL(initial_T), internal->initial_T, internal->dim_T * sizeof(double));
  odin_set_dim(initial_T, 2, internal->dim_T_1, internal->dim_T_2);
  SET_VECTOR_ELT(contents, 338, initial_T);
  SEXP initial_U = PROTECT(allocVector(REALSXP, internal->dim_U));
  memcpy(REAL(initial_U), internal->initial_U, internal->dim_U * sizeof(double));
  odin_set_dim(initial_U, 2, internal->dim_U_1, internal->dim_U_2);
  SET_VECTOR_ELT(contents, 339, initial_U);
  SET_VECTOR_ELT(contents, 344, ScalarReal(internal->kappa));
  SEXP lambda = PROTECT(allocVector(REALSXP, internal->dim_lambda));
  memcpy(REAL(lambda), internal->lambda, internal->dim_lambda * sizeof(double));
  odin_set_dim(lambda, 2, internal->dim_lambda_1, internal->dim_lambda_2);
  SET_VECTOR_ELT(contents, 345, lambda);
  SET_VECTOR_ELT(contents, 346, ScalarReal(internal->mu));
  SEXP N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(N), internal->N, internal->dim_N * sizeof(double));
  odin_set_dim(N, 2, internal->dim_N_1, internal->dim_N_2);
  SET_VECTOR_ELT(contents, 347, N);
  SEXP n_AT = PROTECT(allocVector(REALSXP, internal->dim_n_AT));
  memcpy(REAL(n_AT), internal->n_AT, internal->dim_n_AT * sizeof(double));
  odin_set_dim(n_AT, 2, internal->dim_n_AT_1, internal->dim_n_AT_2);
  SET_VECTOR_ELT(contents, 348, n_AT);
  SEXP n_AU = PROTECT(allocVector(REALSXP, internal->dim_n_AU));
  memcpy(REAL(n_AU), internal->n_AU, internal->dim_n_AU * sizeof(double));
  odin_set_dim(n_AU, 2, internal->dim_n_AU_1, internal->dim_n_AU_2);
  SET_VECTOR_ELT(contents, 349, n_AU);
  SEXP n_diag_rec = PROTECT(allocVector(REALSXP, internal->dim_n_diag_rec));
  memcpy(REAL(n_diag_rec), internal->n_diag_rec, internal->dim_n_diag_rec * sizeof(double));
  odin_set_dim(n_diag_rec, 3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_2, internal->dim_n_diag_rec_3);
  SET_VECTOR_ELT(contents, 350, n_diag_rec);
  SET_VECTOR_ELT(contents, 351, ScalarInteger(internal->n_group));
  SEXP N_hesgroup = PROTECT(allocVector(REALSXP, internal->dim_N_hesgroup));
  memcpy(REAL(N_hesgroup), internal->N_hesgroup, internal->dim_N_hesgroup * sizeof(double));
  odin_set_dim(N_hesgroup, 3, internal->dim_N_hesgroup_1, internal->dim_N_hesgroup_2, internal->dim_N_hesgroup_3);
  SET_VECTOR_ELT(contents, 352, N_hesgroup);
  SEXP n_obe = PROTECT(allocVector(REALSXP, internal->dim_n_obe));
  memcpy(REAL(n_obe), internal->n_obe, internal->dim_n_obe * sizeof(double));
  odin_set_dim(n_obe, 3, internal->dim_n_obe_1, internal->dim_n_obe_2, internal->dim_n_obe_3);
  SET_VECTOR_ELT(contents, 353, n_obe);
  SEXP n_ood = PROTECT(allocVector(REALSXP, internal->dim_n_ood));
  memcpy(REAL(n_ood), internal->n_ood, internal->dim_n_ood * sizeof(double));
  odin_set_dim(n_ood, 3, internal->dim_n_ood_1, internal->dim_n_ood_2, internal->dim_n_ood_3);
  SET_VECTOR_ELT(contents, 354, n_ood);
  SEXP n_oopn = PROTECT(allocVector(REALSXP, internal->dim_n_oopn));
  memcpy(REAL(n_oopn), internal->n_oopn, internal->dim_n_oopn * sizeof(double));
  odin_set_dim(n_oopn, 3, internal->dim_n_oopn_1, internal->dim_n_oopn_2, internal->dim_n_oopn_3);
  SET_VECTOR_ELT(contents, 355, n_oopn);
  SEXP n_oos = PROTECT(allocVector(REALSXP, internal->dim_n_oos));
  memcpy(REAL(n_oos), internal->n_oos, internal->dim_n_oos * sizeof(double));
  odin_set_dim(n_oos, 3, internal->dim_n_oos_1, internal->dim_n_oos_2, internal->dim_n_oos_3);
  SET_VECTOR_ELT(contents, 356, n_oos);
  SEXP n_ST = PROTECT(allocVector(REALSXP, internal->dim_n_ST));
  memcpy(REAL(n_ST), internal->n_ST, internal->dim_n_ST * sizeof(double));
  odin_set_dim(n_ST, 2, internal->dim_n_ST_1, internal->dim_n_ST_2);
  SET_VECTOR_ELT(contents, 357, n_ST);
  SEXP n_TU = PROTECT(allocVector(REALSXP, internal->dim_n_TU));
  memcpy(REAL(n_TU), internal->n_TU, internal->dim_n_TU * sizeof(double));
  odin_set_dim(n_TU, 2, internal->dim_n_TU_1, internal->dim_n_TU_2);
  SET_VECTOR_ELT(contents, 358, n_TU);
  SEXP n_UI = PROTECT(allocVector(REALSXP, internal->dim_n_UI));
  memcpy(REAL(n_UI), internal->n_UI, internal->dim_n_UI * sizeof(double));
  odin_set_dim(n_UI, 2, internal->dim_n_UI_1, internal->dim_n_UI_2);
  SET_VECTOR_ELT(contents, 359, n_UI);
  SET_VECTOR_ELT(contents, 360, ScalarInteger(internal->n_vax));
  SEXP n_vbe = PROTECT(allocVector(REALSXP, internal->dim_n_vbe));
  memcpy(REAL(n_vbe), internal->n_vbe, internal->dim_n_vbe * sizeof(double));
  odin_set_dim(n_vbe, 3, internal->dim_n_vbe_1, internal->dim_n_vbe_2, internal->dim_n_vbe_3);
  SET_VECTOR_ELT(contents, 361, n_vbe);
  SEXP n_vod = PROTECT(allocVector(REALSXP, internal->dim_n_vod));
  memcpy(REAL(n_vod), internal->n_vod, internal->dim_n_vod * sizeof(double));
  odin_set_dim(n_vod, 3, internal->dim_n_vod_1, internal->dim_n_vod_2, internal->dim_n_vod_3);
  SET_VECTOR_ELT(contents, 362, n_vod);
  SEXP n_vopn = PROTECT(allocVector(REALSXP, internal->dim_n_vopn));
  memcpy(REAL(n_vopn), internal->n_vopn, internal->dim_n_vopn * sizeof(double));
  odin_set_dim(n_vopn, 3, internal->dim_n_vopn_1, internal->dim_n_vopn_2, internal->dim_n_vopn_3);
  SET_VECTOR_ELT(contents, 363, n_vopn);
  SEXP n_vos = PROTECT(allocVector(REALSXP, internal->dim_n_vos));
  memcpy(REAL(n_vos), internal->n_vos, internal->dim_n_vos * sizeof(double));
  odin_set_dim(n_vos, 3, internal->dim_n_vos_1, internal->dim_n_vos_2, internal->dim_n_vos_3);
  SET_VECTOR_ELT(contents, 364, n_vos);
  SEXP notifiedandattended = PROTECT(allocVector(REALSXP, internal->dim_notifiedandattended));
  memcpy(REAL(notifiedandattended), internal->notifiedandattended, internal->dim_notifiedandattended * sizeof(double));
  odin_set_dim(notifiedandattended, 2, internal->dim_notifiedandattended_1, internal->dim_notifiedandattended_2);
  SET_VECTOR_ELT(contents, 365, notifiedandattended);
  SET_VECTOR_ELT(contents, 366, ScalarReal(internal->notifiedprev));
  SEXP Np = PROTECT(allocVector(REALSXP, internal->dim_Np));
  memcpy(REAL(Np), internal->Np, internal->dim_Np * sizeof(double));
  SET_VECTOR_ELT(contents, 367, Np);
  SET_VECTOR_ELT(contents, 368, ScalarReal(internal->nu));
  SET_VECTOR_ELT(contents, 369, ScalarInteger(internal->offset_output_lambda));
  SET_VECTOR_ELT(contents, 370, ScalarInteger(internal->offset_output_N));
  SET_VECTOR_ELT(contents, 371, ScalarInteger(internal->offset_output_notifiedandattended));
  SET_VECTOR_ELT(contents, 372, ScalarInteger(internal->offset_output_phi));
  SET_VECTOR_ELT(contents, 373, ScalarInteger(internal->offset_output_prop_C_hesgroup));
  SET_VECTOR_ELT(contents, 374, ScalarInteger(internal->offset_output_prop_C_hesriskgroup));
  SET_VECTOR_ELT(contents, 375, ScalarInteger(internal->offset_variable_A));
  SET_VECTOR_ELT(contents, 376, ScalarInteger(internal->offset_variable_cum_diag_a));
  SET_VECTOR_ELT(contents, 377, ScalarInteger(internal->offset_variable_cum_diag_s));
  SET_VECTOR_ELT(contents, 378, ScalarInteger(internal->offset_variable_cum_entrants));
  SET_VECTOR_ELT(contents, 379, ScalarInteger(internal->offset_variable_cum_incid));
  SET_VECTOR_ELT(contents, 380, ScalarInteger(internal->offset_variable_cum_offered));
  SET_VECTOR_ELT(contents, 381, ScalarInteger(internal->offset_variable_cum_offered_pn));
  SET_VECTOR_ELT(contents, 382, ScalarInteger(internal->offset_variable_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 383, ScalarInteger(internal->offset_variable_cum_screened));
  SET_VECTOR_ELT(contents, 384, ScalarInteger(internal->offset_variable_cum_treated));
  SET_VECTOR_ELT(contents, 385, ScalarInteger(internal->offset_variable_cum_vaccinated));
  SET_VECTOR_ELT(contents, 386, ScalarInteger(internal->offset_variable_cum_vaccinated_pn));
  SET_VECTOR_ELT(contents, 387, ScalarInteger(internal->offset_variable_cum_vaccinated_screen));
  SET_VECTOR_ELT(contents, 388, ScalarInteger(internal->offset_variable_cum_vbe));
  SET_VECTOR_ELT(contents, 389, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 390, ScalarInteger(internal->offset_variable_T));
  SEXP omega_C = PROTECT(allocVector(REALSXP, internal->dim_omega_C));
  memcpy(REAL(omega_C), internal->omega_C, internal->dim_omega_C * sizeof(double));
  odin_set_dim(omega_C, 2, internal->dim_omega_C_1, internal->dim_omega_C_2);
  SET_VECTOR_ELT(contents, 391, omega_C);
  SEXP omega_C_withdiag = PROTECT(allocVector(REALSXP, internal->dim_omega_C_withdiag));
  memcpy(REAL(omega_C_withdiag), internal->omega_C_withdiag, internal->dim_omega_C_withdiag * sizeof(double));
  odin_set_dim(omega_C_withdiag, 2, internal->dim_omega_C_withdiag_1, internal->dim_omega_C_withdiag_2);
  SET_VECTOR_ELT(contents, 392, omega_C_withdiag);
  SEXP omega_C_withdiag_rg = PROTECT(allocVector(REALSXP, internal->dim_omega_C_withdiag_rg));
  memcpy(REAL(omega_C_withdiag_rg), internal->omega_C_withdiag_rg, internal->dim_omega_C_withdiag_rg * sizeof(double));
  SET_VECTOR_ELT(contents, 393, omega_C_withdiag_rg);
  SEXP omega_U = PROTECT(allocVector(REALSXP, internal->dim_omega_U));
  memcpy(REAL(omega_U), internal->omega_U, internal->dim_omega_U * sizeof(double));
  odin_set_dim(omega_U, 2, internal->dim_omega_U_1, internal->dim_omega_U_2);
  SET_VECTOR_ELT(contents, 394, omega_U);
  SEXP omega_U_withdiag = PROTECT(allocVector(REALSXP, internal->dim_omega_U_withdiag));
  memcpy(REAL(omega_U_withdiag), internal->omega_U_withdiag, internal->dim_omega_U_withdiag * sizeof(double));
  odin_set_dim(omega_U_withdiag, 2, internal->dim_omega_U_withdiag_1, internal->dim_omega_U_withdiag_2);
  SET_VECTOR_ELT(contents, 395, omega_U_withdiag);
  SEXP omega_U_withdiag_rg = PROTECT(allocVector(REALSXP, internal->dim_omega_U_withdiag_rg));
  memcpy(REAL(omega_U_withdiag_rg), internal->omega_U_withdiag_rg, internal->dim_omega_U_withdiag_rg * sizeof(double));
  SET_VECTOR_ELT(contents, 396, omega_U_withdiag_rg);
  SEXP p = PROTECT(allocVector(REALSXP, internal->dim_p));
  memcpy(REAL(p), internal->p, internal->dim_p * sizeof(double));
  SET_VECTOR_ELT(contents, 397, p);
  SEXP phi = PROTECT(allocVector(REALSXP, internal->dim_phi));
  memcpy(REAL(phi), internal->phi, internal->dim_phi * sizeof(double));
  odin_set_dim(phi, 2, internal->dim_phi_1, internal->dim_phi_2);
  SET_VECTOR_ELT(contents, 398, phi);
  SEXP prop_C = PROTECT(allocVector(REALSXP, internal->dim_prop_C));
  memcpy(REAL(prop_C), internal->prop_C, internal->dim_prop_C * sizeof(double));
  SET_VECTOR_ELT(contents, 399, prop_C);
  SEXP prop_C_hesgroup = PROTECT(allocVector(REALSXP, internal->dim_prop_C_hesgroup));
  memcpy(REAL(prop_C_hesgroup), internal->prop_C_hesgroup, internal->dim_prop_C_hesgroup * sizeof(double));
  SET_VECTOR_ELT(contents, 400, prop_C_hesgroup);
  SEXP prop_C_hesriskgroup = PROTECT(allocVector(REALSXP, internal->dim_prop_C_hesriskgroup));
  memcpy(REAL(prop_C_hesriskgroup), internal->prop_C_hesriskgroup, internal->dim_prop_C_hesriskgroup * sizeof(double));
  odin_set_dim(prop_C_hesriskgroup, 2, internal->dim_prop_C_hesriskgroup_1, internal->dim_prop_C_hesriskgroup_2);
  SET_VECTOR_ELT(contents, 401, prop_C_hesriskgroup);
  SEXP prop_CCsubgroup = PROTECT(allocVector(REALSXP, internal->dim_prop_CCsubgroup));
  memcpy(REAL(prop_CCsubgroup), internal->prop_CCsubgroup, internal->dim_prop_CCsubgroup * sizeof(double));
  odin_set_dim(prop_CCsubgroup, 2, internal->dim_prop_CCsubgroup_1, internal->dim_prop_CCsubgroup_2);
  SET_VECTOR_ELT(contents, 402, prop_CCsubgroup);
  SEXP prop_UUsubgroup = PROTECT(allocVector(REALSXP, internal->dim_prop_UUsubgroup));
  memcpy(REAL(prop_UUsubgroup), internal->prop_UUsubgroup, internal->dim_prop_UUsubgroup * sizeof(double));
  odin_set_dim(prop_UUsubgroup, 2, internal->dim_prop_UUsubgroup_1, internal->dim_prop_UUsubgroup_2);
  SET_VECTOR_ELT(contents, 403, prop_UUsubgroup);
  SET_VECTOR_ELT(contents, 404, ScalarReal(internal->psi));
  SEXP q = PROTECT(allocVector(REALSXP, internal->dim_q));
  memcpy(REAL(q), internal->q, internal->dim_q * sizeof(double));
  SET_VECTOR_ELT(contents, 405, q);
  SET_VECTOR_ELT(contents, 406, ScalarReal(internal->rho));
  SEXP S0 = PROTECT(allocVector(REALSXP, internal->dim_S0));
  memcpy(REAL(S0), internal->S0, internal->dim_S0 * sizeof(double));
  odin_set_dim(S0, 2, internal->dim_S0_1, internal->dim_S0_2);
  SET_VECTOR_ELT(contents, 407, S0);
  SEXP screened = PROTECT(allocVector(REALSXP, internal->dim_screened));
  memcpy(REAL(screened), internal->screened, internal->dim_screened * sizeof(double));
  odin_set_dim(screened, 2, internal->dim_screened_1, internal->dim_screened_2);
  SET_VECTOR_ELT(contents, 408, screened);
  SET_VECTOR_ELT(contents, 409, ScalarReal(internal->sigma));
  SEXP T0 = PROTECT(allocVector(REALSXP, internal->dim_T0));
  memcpy(REAL(T0), internal->T0, internal->dim_T0 * sizeof(double));
  odin_set_dim(T0, 2, internal->dim_T0_1, internal->dim_T0_2);
  SET_VECTOR_ELT(contents, 410, T0);
  SEXP tt = PROTECT(allocVector(REALSXP, internal->dim_tt));
  memcpy(REAL(tt), internal->tt, internal->dim_tt * sizeof(double));
  SET_VECTOR_ELT(contents, 411, tt);
  SEXP u_d = PROTECT(allocVector(REALSXP, internal->dim_u_d));
  memcpy(REAL(u_d), internal->u_d, internal->dim_u_d * sizeof(double));
  odin_set_dim(u_d, 3, internal->dim_u_d_1, internal->dim_u_d_2, internal->dim_u_d_3);
  SET_VECTOR_ELT(contents, 412, u_d);
  SEXP u_pn = PROTECT(allocVector(REALSXP, internal->dim_u_pn));
  memcpy(REAL(u_pn), internal->u_pn, internal->dim_u_pn * sizeof(double));
  odin_set_dim(u_pn, 3, internal->dim_u_pn_1, internal->dim_u_pn_2, internal->dim_u_pn_3);
  SET_VECTOR_ELT(contents, 413, u_pn);
  SEXP u_s = PROTECT(allocVector(REALSXP, internal->dim_u_s));
  memcpy(REAL(u_s), internal->u_s, internal->dim_u_s * sizeof(double));
  odin_set_dim(u_s, 3, internal->dim_u_s_1, internal->dim_u_s_2, internal->dim_u_s_3);
  SET_VECTOR_ELT(contents, 414, u_s);
  SET_VECTOR_ELT(contents, 415, ScalarReal(internal->u_vbe));
  SEXP U0 = PROTECT(allocVector(REALSXP, internal->dim_U0));
  memcpy(REAL(U0), internal->U0, internal->dim_U0 * sizeof(double));
  odin_set_dim(U0, 2, internal->dim_U0_1, internal->dim_U0_2);
  SET_VECTOR_ELT(contents, 416, U0);
  SEXP Up = PROTECT(allocVector(REALSXP, internal->dim_Up));
  memcpy(REAL(Up), internal->Up, internal->dim_Up * sizeof(double));
  SET_VECTOR_ELT(contents, 417, Up);
  SEXP vax_t = PROTECT(allocVector(REALSXP, internal->dim_vax_t));
  memcpy(REAL(vax_t), internal->vax_t, internal->dim_vax_t * sizeof(double));
  SET_VECTOR_ELT(contents, 418, vax_t);
  SEXP vax_y = PROTECT(allocVector(REALSXP, internal->dim_vax_y));
  memcpy(REAL(vax_y), internal->vax_y, internal->dim_vax_y * sizeof(double));
  SET_VECTOR_ELT(contents, 419, vax_y);
  SEXP vbe = PROTECT(allocVector(REALSXP, internal->dim_vbe));
  memcpy(REAL(vbe), internal->vbe, internal->dim_vbe * sizeof(double));
  odin_set_dim(vbe, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  SET_VECTOR_ELT(contents, 420, vbe);
  SEXP vea = PROTECT(allocVector(REALSXP, internal->dim_vea));
  memcpy(REAL(vea), internal->vea, internal->dim_vea * sizeof(double));
  SET_VECTOR_ELT(contents, 421, vea);
  SEXP ved = PROTECT(allocVector(REALSXP, internal->dim_ved));
  memcpy(REAL(ved), internal->ved, internal->dim_ved * sizeof(double));
  SET_VECTOR_ELT(contents, 422, ved);
  SEXP vei = PROTECT(allocVector(REALSXP, internal->dim_vei));
  memcpy(REAL(vei), internal->vei, internal->dim_vei * sizeof(double));
  SET_VECTOR_ELT(contents, 423, vei);
  SEXP ves = PROTECT(allocVector(REALSXP, internal->dim_ves));
  memcpy(REAL(ves), internal->ves, internal->dim_ves * sizeof(double));
  SET_VECTOR_ELT(contents, 424, ves);
  SEXP vod = PROTECT(allocVector(REALSXP, internal->dim_vod));
  memcpy(REAL(vod), internal->vod, internal->dim_vod * sizeof(double));
  odin_set_dim(vod, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  SET_VECTOR_ELT(contents, 425, vod);
  SEXP vopn = PROTECT(allocVector(REALSXP, internal->dim_vopn));
  memcpy(REAL(vopn), internal->vopn, internal->dim_vopn * sizeof(double));
  odin_set_dim(vopn, 3, internal->dim_vopn_1, internal->dim_vopn_2, internal->dim_vopn_3);
  SET_VECTOR_ELT(contents, 426, vopn);
  SEXP vos = PROTECT(allocVector(REALSXP, internal->dim_vos));
  memcpy(REAL(vos), internal->vos, internal->dim_vos * sizeof(double));
  odin_set_dim(vos, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  SET_VECTOR_ELT(contents, 427, vos);
  SEXP w = PROTECT(allocVector(REALSXP, internal->dim_w));
  memcpy(REAL(w), internal->w, internal->dim_w * sizeof(double));
  odin_set_dim(w, 2, internal->dim_w_1, internal->dim_w_2);
  SET_VECTOR_ELT(contents, 428, w);
  SEXP wA = PROTECT(allocVector(REALSXP, internal->dim_wA));
  memcpy(REAL(wA), internal->wA, internal->dim_wA * sizeof(double));
  odin_set_dim(wA, 3, internal->dim_wA_1, internal->dim_wA_2, internal->dim_wA_3);
  SET_VECTOR_ELT(contents, 429, wA);
  SEXP wd = PROTECT(allocVector(REALSXP, internal->dim_wd));
  memcpy(REAL(wd), internal->wd, internal->dim_wd * sizeof(double));
  odin_set_dim(wd, 2, internal->dim_wd_1, internal->dim_wd_2);
  SET_VECTOR_ELT(contents, 430, wd);
  SEXP wdA = PROTECT(allocVector(REALSXP, internal->dim_wdA));
  memcpy(REAL(wdA), internal->wdA, internal->dim_wdA * sizeof(double));
  odin_set_dim(wdA, 3, internal->dim_wdA_1, internal->dim_wdA_2, internal->dim_wdA_3);
  SET_VECTOR_ELT(contents, 431, wdA);
  SEXP wdI = PROTECT(allocVector(REALSXP, internal->dim_wdI));
  memcpy(REAL(wdI), internal->wdI, internal->dim_wdI * sizeof(double));
  odin_set_dim(wdI, 3, internal->dim_wdI_1, internal->dim_wdI_2, internal->dim_wdI_3);
  SET_VECTOR_ELT(contents, 432, wdI);
  SEXP wdS = PROTECT(allocVector(REALSXP, internal->dim_wdS));
  memcpy(REAL(wdS), internal->wdS, internal->dim_wdS * sizeof(double));
  odin_set_dim(wdS, 3, internal->dim_wdS_1, internal->dim_wdS_2, internal->dim_wdS_3);
  SET_VECTOR_ELT(contents, 433, wdS);
  SEXP wdT = PROTECT(allocVector(REALSXP, internal->dim_wdT));
  memcpy(REAL(wdT), internal->wdT, internal->dim_wdT * sizeof(double));
  odin_set_dim(wdT, 3, internal->dim_wdT_1, internal->dim_wdT_2, internal->dim_wdT_3);
  SET_VECTOR_ELT(contents, 434, wdT);
  SEXP wdU = PROTECT(allocVector(REALSXP, internal->dim_wdU));
  memcpy(REAL(wdU), internal->wdU, internal->dim_wdU * sizeof(double));
  odin_set_dim(wdU, 3, internal->dim_wdU_1, internal->dim_wdU_2, internal->dim_wdU_3);
  SET_VECTOR_ELT(contents, 435, wdU);
  SEXP wI = PROTECT(allocVector(REALSXP, internal->dim_wI));
  memcpy(REAL(wI), internal->wI, internal->dim_wI * sizeof(double));
  odin_set_dim(wI, 3, internal->dim_wI_1, internal->dim_wI_2, internal->dim_wI_3);
  SET_VECTOR_ELT(contents, 436, wI);
  SEXP willing = PROTECT(allocVector(REALSXP, internal->dim_willing));
  memcpy(REAL(willing), internal->willing, internal->dim_willing * sizeof(double));
  SET_VECTOR_ELT(contents, 437, willing);
  SEXP wS = PROTECT(allocVector(REALSXP, internal->dim_wS));
  memcpy(REAL(wS), internal->wS, internal->dim_wS * sizeof(double));
  odin_set_dim(wS, 3, internal->dim_wS_1, internal->dim_wS_2, internal->dim_wS_3);
  SET_VECTOR_ELT(contents, 438, wS);
  SEXP wT = PROTECT(allocVector(REALSXP, internal->dim_wT));
  memcpy(REAL(wT), internal->wT, internal->dim_wT * sizeof(double));
  odin_set_dim(wT, 3, internal->dim_wT_1, internal->dim_wT_2, internal->dim_wT_3);
  SET_VECTOR_ELT(contents, 439, wT);
  SEXP wU = PROTECT(allocVector(REALSXP, internal->dim_wU));
  memcpy(REAL(wU), internal->wU, internal->dim_wU * sizeof(double));
  odin_set_dim(wU, 3, internal->dim_wU_1, internal->dim_wU_2, internal->dim_wU_3);
  SET_VECTOR_ELT(contents, 440, wU);
  SEXP xi = PROTECT(allocVector(REALSXP, internal->dim_xi));
  memcpy(REAL(xi), internal->xi, internal->dim_xi * sizeof(double));
  odin_set_dim(xi, 2, internal->dim_xi_1, internal->dim_xi_2);
  SET_VECTOR_ELT(contents, 441, xi);
  SEXP nms = PROTECT(allocVector(STRSXP, 442));
  SET_STRING_ELT(nms, 0, mkChar("A0"));
  SET_STRING_ELT(nms, 1, mkChar("beta_t"));
  SET_STRING_ELT(nms, 2, mkChar("C"));
  SET_STRING_ELT(nms, 3, mkChar("C_hesgroup"));
  SET_STRING_ELT(nms, 4, mkChar("Cp"));
  SET_STRING_ELT(nms, 5, mkChar("diag_rec"));
  SET_STRING_ELT(nms, 6, mkChar("dim_A"));
  SET_STRING_ELT(nms, 7, mkChar("dim_A_1"));
  SET_STRING_ELT(nms, 8, mkChar("dim_A_2"));
  SET_STRING_ELT(nms, 9, mkChar("dim_A0"));
  SET_STRING_ELT(nms, 10, mkChar("dim_A0_1"));
  SET_STRING_ELT(nms, 11, mkChar("dim_A0_2"));
  SET_STRING_ELT(nms, 12, mkChar("dim_beta_t"));
  SET_STRING_ELT(nms, 13, mkChar("dim_C"));
  SET_STRING_ELT(nms, 14, mkChar("dim_C_1"));
  SET_STRING_ELT(nms, 15, mkChar("dim_C_2"));
  SET_STRING_ELT(nms, 16, mkChar("dim_C_hesgroup"));
  SET_STRING_ELT(nms, 17, mkChar("dim_C_hesgroup_1"));
  SET_STRING_ELT(nms, 18, mkChar("dim_C_hesgroup_12"));
  SET_STRING_ELT(nms, 19, mkChar("dim_C_hesgroup_2"));
  SET_STRING_ELT(nms, 20, mkChar("dim_C_hesgroup_3"));
  SET_STRING_ELT(nms, 21, mkChar("dim_Cp"));
  SET_STRING_ELT(nms, 22, mkChar("dim_cum_diag_a"));
  SET_STRING_ELT(nms, 23, mkChar("dim_cum_diag_a_1"));
  SET_STRING_ELT(nms, 24, mkChar("dim_cum_diag_a_2"));
  SET_STRING_ELT(nms, 25, mkChar("dim_cum_diag_s"));
  SET_STRING_ELT(nms, 26, mkChar("dim_cum_diag_s_1"));
  SET_STRING_ELT(nms, 27, mkChar("dim_cum_diag_s_2"));
  SET_STRING_ELT(nms, 28, mkChar("dim_cum_entrants"));
  SET_STRING_ELT(nms, 29, mkChar("dim_cum_entrants_1"));
  SET_STRING_ELT(nms, 30, mkChar("dim_cum_entrants_2"));
  SET_STRING_ELT(nms, 31, mkChar("dim_cum_incid"));
  SET_STRING_ELT(nms, 32, mkChar("dim_cum_incid_1"));
  SET_STRING_ELT(nms, 33, mkChar("dim_cum_incid_2"));
  SET_STRING_ELT(nms, 34, mkChar("dim_cum_offered"));
  SET_STRING_ELT(nms, 35, mkChar("dim_cum_offered_1"));
  SET_STRING_ELT(nms, 36, mkChar("dim_cum_offered_2"));
  SET_STRING_ELT(nms, 37, mkChar("dim_cum_offered_pn"));
  SET_STRING_ELT(nms, 38, mkChar("dim_cum_offered_pn_1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_cum_offered_pn_2"));
  SET_STRING_ELT(nms, 40, mkChar("dim_cum_offered_vbe"));
  SET_STRING_ELT(nms, 41, mkChar("dim_cum_offered_vbe_1"));
  SET_STRING_ELT(nms, 42, mkChar("dim_cum_offered_vbe_2"));
  SET_STRING_ELT(nms, 43, mkChar("dim_cum_screened"));
  SET_STRING_ELT(nms, 44, mkChar("dim_cum_screened_1"));
  SET_STRING_ELT(nms, 45, mkChar("dim_cum_screened_2"));
  SET_STRING_ELT(nms, 46, mkChar("dim_cum_treated"));
  SET_STRING_ELT(nms, 47, mkChar("dim_cum_treated_1"));
  SET_STRING_ELT(nms, 48, mkChar("dim_cum_treated_2"));
  SET_STRING_ELT(nms, 49, mkChar("dim_cum_vaccinated"));
  SET_STRING_ELT(nms, 50, mkChar("dim_cum_vaccinated_1"));
  SET_STRING_ELT(nms, 51, mkChar("dim_cum_vaccinated_2"));
  SET_STRING_ELT(nms, 52, mkChar("dim_cum_vaccinated_pn"));
  SET_STRING_ELT(nms, 53, mkChar("dim_cum_vaccinated_pn_1"));
  SET_STRING_ELT(nms, 54, mkChar("dim_cum_vaccinated_pn_2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 56, mkChar("dim_cum_vaccinated_screen_1"));
  SET_STRING_ELT(nms, 57, mkChar("dim_cum_vaccinated_screen_2"));
  SET_STRING_ELT(nms, 58, mkChar("dim_cum_vbe"));
  SET_STRING_ELT(nms, 59, mkChar("dim_cum_vbe_1"));
  SET_STRING_ELT(nms, 60, mkChar("dim_cum_vbe_2"));
  SET_STRING_ELT(nms, 61, mkChar("dim_diag_rec"));
  SET_STRING_ELT(nms, 62, mkChar("dim_diag_rec_1"));
  SET_STRING_ELT(nms, 63, mkChar("dim_diag_rec_12"));
  SET_STRING_ELT(nms, 64, mkChar("dim_diag_rec_2"));
  SET_STRING_ELT(nms, 65, mkChar("dim_diag_rec_3"));
  SET_STRING_ELT(nms, 66, mkChar("dim_entrants"));
  SET_STRING_ELT(nms, 67, mkChar("dim_entrants_1"));
  SET_STRING_ELT(nms, 68, mkChar("dim_entrants_2"));
  SET_STRING_ELT(nms, 69, mkChar("dim_eta"));
  SET_STRING_ELT(nms, 70, mkChar("dim_eta_h_t"));
  SET_STRING_ELT(nms, 71, mkChar("dim_eta_l_t"));
  SET_STRING_ELT(nms, 72, mkChar("dim_foi_LH"));
  SET_STRING_ELT(nms, 73, mkChar("dim_hesgroupmatrix"));
  SET_STRING_ELT(nms, 74, mkChar("dim_hesgroupmatrix_1"));
  SET_STRING_ELT(nms, 75, mkChar("dim_hesgroupmatrix_2"));
  SET_STRING_ELT(nms, 76, mkChar("dim_I"));
  SET_STRING_ELT(nms, 77, mkChar("dim_I_1"));
  SET_STRING_ELT(nms, 78, mkChar("dim_I_2"));
  SET_STRING_ELT(nms, 79, mkChar("dim_I0"));
  SET_STRING_ELT(nms, 80, mkChar("dim_I0_1"));
  SET_STRING_ELT(nms, 81, mkChar("dim_I0_2"));
  SET_STRING_ELT(nms, 82, mkChar("dim_lambda"));
  SET_STRING_ELT(nms, 83, mkChar("dim_lambda_1"));
  SET_STRING_ELT(nms, 84, mkChar("dim_lambda_2"));
  SET_STRING_ELT(nms, 85, mkChar("dim_N"));
  SET_STRING_ELT(nms, 86, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 87, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 88, mkChar("dim_n_AT"));
  SET_STRING_ELT(nms, 89, mkChar("dim_n_AT_1"));
  SET_STRING_ELT(nms, 90, mkChar("dim_n_AT_2"));
  SET_STRING_ELT(nms, 91, mkChar("dim_n_AU"));
  SET_STRING_ELT(nms, 92, mkChar("dim_n_AU_1"));
  SET_STRING_ELT(nms, 93, mkChar("dim_n_AU_2"));
  SET_STRING_ELT(nms, 94, mkChar("dim_n_diag_rec"));
  SET_STRING_ELT(nms, 95, mkChar("dim_n_diag_rec_1"));
  SET_STRING_ELT(nms, 96, mkChar("dim_n_diag_rec_12"));
  SET_STRING_ELT(nms, 97, mkChar("dim_n_diag_rec_2"));
  SET_STRING_ELT(nms, 98, mkChar("dim_n_diag_rec_3"));
  SET_STRING_ELT(nms, 99, mkChar("dim_N_hesgroup"));
  SET_STRING_ELT(nms, 100, mkChar("dim_N_hesgroup_1"));
  SET_STRING_ELT(nms, 101, mkChar("dim_N_hesgroup_12"));
  SET_STRING_ELT(nms, 102, mkChar("dim_N_hesgroup_2"));
  SET_STRING_ELT(nms, 103, mkChar("dim_N_hesgroup_3"));
  SET_STRING_ELT(nms, 104, mkChar("dim_n_obe"));
  SET_STRING_ELT(nms, 105, mkChar("dim_n_obe_1"));
  SET_STRING_ELT(nms, 106, mkChar("dim_n_obe_12"));
  SET_STRING_ELT(nms, 107, mkChar("dim_n_obe_2"));
  SET_STRING_ELT(nms, 108, mkChar("dim_n_obe_3"));
  SET_STRING_ELT(nms, 109, mkChar("dim_n_ood"));
  SET_STRING_ELT(nms, 110, mkChar("dim_n_ood_1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_n_ood_12"));
  SET_STRING_ELT(nms, 112, mkChar("dim_n_ood_2"));
  SET_STRING_ELT(nms, 113, mkChar("dim_n_ood_3"));
  SET_STRING_ELT(nms, 114, mkChar("dim_n_oopn"));
  SET_STRING_ELT(nms, 115, mkChar("dim_n_oopn_1"));
  SET_STRING_ELT(nms, 116, mkChar("dim_n_oopn_12"));
  SET_STRING_ELT(nms, 117, mkChar("dim_n_oopn_2"));
  SET_STRING_ELT(nms, 118, mkChar("dim_n_oopn_3"));
  SET_STRING_ELT(nms, 119, mkChar("dim_n_oos"));
  SET_STRING_ELT(nms, 120, mkChar("dim_n_oos_1"));
  SET_STRING_ELT(nms, 121, mkChar("dim_n_oos_12"));
  SET_STRING_ELT(nms, 122, mkChar("dim_n_oos_2"));
  SET_STRING_ELT(nms, 123, mkChar("dim_n_oos_3"));
  SET_STRING_ELT(nms, 124, mkChar("dim_n_ST"));
  SET_STRING_ELT(nms, 125, mkChar("dim_n_ST_1"));
  SET_STRING_ELT(nms, 126, mkChar("dim_n_ST_2"));
  SET_STRING_ELT(nms, 127, mkChar("dim_n_TU"));
  SET_STRING_ELT(nms, 128, mkChar("dim_n_TU_1"));
  SET_STRING_ELT(nms, 129, mkChar("dim_n_TU_2"));
  SET_STRING_ELT(nms, 130, mkChar("dim_n_UI"));
  SET_STRING_ELT(nms, 131, mkChar("dim_n_UI_1"));
  SET_STRING_ELT(nms, 132, mkChar("dim_n_UI_2"));
  SET_STRING_ELT(nms, 133, mkChar("dim_n_vbe"));
  SET_STRING_ELT(nms, 134, mkChar("dim_n_vbe_1"));
  SET_STRING_ELT(nms, 135, mkChar("dim_n_vbe_12"));
  SET_STRING_ELT(nms, 136, mkChar("dim_n_vbe_2"));
  SET_STRING_ELT(nms, 137, mkChar("dim_n_vbe_3"));
  SET_STRING_ELT(nms, 138, mkChar("dim_n_vod"));
  SET_STRING_ELT(nms, 139, mkChar("dim_n_vod_1"));
  SET_STRING_ELT(nms, 140, mkChar("dim_n_vod_12"));
  SET_STRING_ELT(nms, 141, mkChar("dim_n_vod_2"));
  SET_STRING_ELT(nms, 142, mkChar("dim_n_vod_3"));
  SET_STRING_ELT(nms, 143, mkChar("dim_n_vopn"));
  SET_STRING_ELT(nms, 144, mkChar("dim_n_vopn_1"));
  SET_STRING_ELT(nms, 145, mkChar("dim_n_vopn_12"));
  SET_STRING_ELT(nms, 146, mkChar("dim_n_vopn_2"));
  SET_STRING_ELT(nms, 147, mkChar("dim_n_vopn_3"));
  SET_STRING_ELT(nms, 148, mkChar("dim_n_vos"));
  SET_STRING_ELT(nms, 149, mkChar("dim_n_vos_1"));
  SET_STRING_ELT(nms, 150, mkChar("dim_n_vos_12"));
  SET_STRING_ELT(nms, 151, mkChar("dim_n_vos_2"));
  SET_STRING_ELT(nms, 152, mkChar("dim_n_vos_3"));
  SET_STRING_ELT(nms, 153, mkChar("dim_notifiedandattended"));
  SET_STRING_ELT(nms, 154, mkChar("dim_notifiedandattended_1"));
  SET_STRING_ELT(nms, 155, mkChar("dim_notifiedandattended_2"));
  SET_STRING_ELT(nms, 156, mkChar("dim_Np"));
  SET_STRING_ELT(nms, 157, mkChar("dim_omega_C"));
  SET_STRING_ELT(nms, 158, mkChar("dim_omega_C_1"));
  SET_STRING_ELT(nms, 159, mkChar("dim_omega_C_2"));
  SET_STRING_ELT(nms, 160, mkChar("dim_omega_C_withdiag"));
  SET_STRING_ELT(nms, 161, mkChar("dim_omega_C_withdiag_1"));
  SET_STRING_ELT(nms, 162, mkChar("dim_omega_C_withdiag_2"));
  SET_STRING_ELT(nms, 163, mkChar("dim_omega_C_withdiag_rg"));
  SET_STRING_ELT(nms, 164, mkChar("dim_omega_U"));
  SET_STRING_ELT(nms, 165, mkChar("dim_omega_U_1"));
  SET_STRING_ELT(nms, 166, mkChar("dim_omega_U_2"));
  SET_STRING_ELT(nms, 167, mkChar("dim_omega_U_withdiag"));
  SET_STRING_ELT(nms, 168, mkChar("dim_omega_U_withdiag_1"));
  SET_STRING_ELT(nms, 169, mkChar("dim_omega_U_withdiag_2"));
  SET_STRING_ELT(nms, 170, mkChar("dim_omega_U_withdiag_rg"));
  SET_STRING_ELT(nms, 171, mkChar("dim_p"));
  SET_STRING_ELT(nms, 172, mkChar("dim_phi"));
  SET_STRING_ELT(nms, 173, mkChar("dim_phi_1"));
  SET_STRING_ELT(nms, 174, mkChar("dim_phi_2"));
  SET_STRING_ELT(nms, 175, mkChar("dim_prop_C"));
  SET_STRING_ELT(nms, 176, mkChar("dim_prop_C_hesgroup"));
  SET_STRING_ELT(nms, 177, mkChar("dim_prop_C_hesriskgroup"));
  SET_STRING_ELT(nms, 178, mkChar("dim_prop_C_hesriskgroup_1"));
  SET_STRING_ELT(nms, 179, mkChar("dim_prop_C_hesriskgroup_2"));
  SET_STRING_ELT(nms, 180, mkChar("dim_prop_CCsubgroup"));
  SET_STRING_ELT(nms, 181, mkChar("dim_prop_CCsubgroup_1"));
  SET_STRING_ELT(nms, 182, mkChar("dim_prop_CCsubgroup_2"));
  SET_STRING_ELT(nms, 183, mkChar("dim_prop_UUsubgroup"));
  SET_STRING_ELT(nms, 184, mkChar("dim_prop_UUsubgroup_1"));
  SET_STRING_ELT(nms, 185, mkChar("dim_prop_UUsubgroup_2"));
  SET_STRING_ELT(nms, 186, mkChar("dim_q"));
  SET_STRING_ELT(nms, 187, mkChar("dim_S"));
  SET_STRING_ELT(nms, 188, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 189, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 190, mkChar("dim_S0"));
  SET_STRING_ELT(nms, 191, mkChar("dim_S0_1"));
  SET_STRING_ELT(nms, 192, mkChar("dim_S0_2"));
  SET_STRING_ELT(nms, 193, mkChar("dim_screened"));
  SET_STRING_ELT(nms, 194, mkChar("dim_screened_1"));
  SET_STRING_ELT(nms, 195, mkChar("dim_screened_2"));
  SET_STRING_ELT(nms, 196, mkChar("dim_T"));
  SET_STRING_ELT(nms, 197, mkChar("dim_T_1"));
  SET_STRING_ELT(nms, 198, mkChar("dim_T_2"));
  SET_STRING_ELT(nms, 199, mkChar("dim_T0"));
  SET_STRING_ELT(nms, 200, mkChar("dim_T0_1"));
  SET_STRING_ELT(nms, 201, mkChar("dim_T0_2"));
  SET_STRING_ELT(nms, 202, mkChar("dim_tt"));
  SET_STRING_ELT(nms, 203, mkChar("dim_U"));
  SET_STRING_ELT(nms, 204, mkChar("dim_U_1"));
  SET_STRING_ELT(nms, 205, mkChar("dim_U_2"));
  SET_STRING_ELT(nms, 206, mkChar("dim_u_d"));
  SET_STRING_ELT(nms, 207, mkChar("dim_u_d_1"));
  SET_STRING_ELT(nms, 208, mkChar("dim_u_d_12"));
  SET_STRING_ELT(nms, 209, mkChar("dim_u_d_2"));
  SET_STRING_ELT(nms, 210, mkChar("dim_u_d_3"));
  SET_STRING_ELT(nms, 211, mkChar("dim_u_pn"));
  SET_STRING_ELT(nms, 212, mkChar("dim_u_pn_1"));
  SET_STRING_ELT(nms, 213, mkChar("dim_u_pn_12"));
  SET_STRING_ELT(nms, 214, mkChar("dim_u_pn_2"));
  SET_STRING_ELT(nms, 215, mkChar("dim_u_pn_3"));
  SET_STRING_ELT(nms, 216, mkChar("dim_u_s"));
  SET_STRING_ELT(nms, 217, mkChar("dim_u_s_1"));
  SET_STRING_ELT(nms, 218, mkChar("dim_u_s_12"));
  SET_STRING_ELT(nms, 219, mkChar("dim_u_s_2"));
  SET_STRING_ELT(nms, 220, mkChar("dim_u_s_3"));
  SET_STRING_ELT(nms, 221, mkChar("dim_U0"));
  SET_STRING_ELT(nms, 222, mkChar("dim_U0_1"));
  SET_STRING_ELT(nms, 223, mkChar("dim_U0_2"));
  SET_STRING_ELT(nms, 224, mkChar("dim_Up"));
  SET_STRING_ELT(nms, 225, mkChar("dim_vax_t"));
  SET_STRING_ELT(nms, 226, mkChar("dim_vax_y"));
  SET_STRING_ELT(nms, 227, mkChar("dim_vbe"));
  SET_STRING_ELT(nms, 228, mkChar("dim_vbe_1"));
  SET_STRING_ELT(nms, 229, mkChar("dim_vbe_12"));
  SET_STRING_ELT(nms, 230, mkChar("dim_vbe_2"));
  SET_STRING_ELT(nms, 231, mkChar("dim_vbe_3"));
  SET_STRING_ELT(nms, 232, mkChar("dim_vea"));
  SET_STRING_ELT(nms, 233, mkChar("dim_ved"));
  SET_STRING_ELT(nms, 234, mkChar("dim_vei"));
  SET_STRING_ELT(nms, 235, mkChar("dim_ves"));
  SET_STRING_ELT(nms, 236, mkChar("dim_vod"));
  SET_STRING_ELT(nms, 237, mkChar("dim_vod_1"));
  SET_STRING_ELT(nms, 238, mkChar("dim_vod_12"));
  SET_STRING_ELT(nms, 239, mkChar("dim_vod_2"));
  SET_STRING_ELT(nms, 240, mkChar("dim_vod_3"));
  SET_STRING_ELT(nms, 241, mkChar("dim_vopn"));
  SET_STRING_ELT(nms, 242, mkChar("dim_vopn_1"));
  SET_STRING_ELT(nms, 243, mkChar("dim_vopn_12"));
  SET_STRING_ELT(nms, 244, mkChar("dim_vopn_2"));
  SET_STRING_ELT(nms, 245, mkChar("dim_vopn_3"));
  SET_STRING_ELT(nms, 246, mkChar("dim_vos"));
  SET_STRING_ELT(nms, 247, mkChar("dim_vos_1"));
  SET_STRING_ELT(nms, 248, mkChar("dim_vos_12"));
  SET_STRING_ELT(nms, 249, mkChar("dim_vos_2"));
  SET_STRING_ELT(nms, 250, mkChar("dim_vos_3"));
  SET_STRING_ELT(nms, 251, mkChar("dim_w"));
  SET_STRING_ELT(nms, 252, mkChar("dim_w_1"));
  SET_STRING_ELT(nms, 253, mkChar("dim_w_2"));
  SET_STRING_ELT(nms, 254, mkChar("dim_wA"));
  SET_STRING_ELT(nms, 255, mkChar("dim_wA_1"));
  SET_STRING_ELT(nms, 256, mkChar("dim_wA_12"));
  SET_STRING_ELT(nms, 257, mkChar("dim_wA_2"));
  SET_STRING_ELT(nms, 258, mkChar("dim_wA_3"));
  SET_STRING_ELT(nms, 259, mkChar("dim_wd"));
  SET_STRING_ELT(nms, 260, mkChar("dim_wd_1"));
  SET_STRING_ELT(nms, 261, mkChar("dim_wd_2"));
  SET_STRING_ELT(nms, 262, mkChar("dim_wdA"));
  SET_STRING_ELT(nms, 263, mkChar("dim_wdA_1"));
  SET_STRING_ELT(nms, 264, mkChar("dim_wdA_12"));
  SET_STRING_ELT(nms, 265, mkChar("dim_wdA_2"));
  SET_STRING_ELT(nms, 266, mkChar("dim_wdA_3"));
  SET_STRING_ELT(nms, 267, mkChar("dim_wdI"));
  SET_STRING_ELT(nms, 268, mkChar("dim_wdI_1"));
  SET_STRING_ELT(nms, 269, mkChar("dim_wdI_12"));
  SET_STRING_ELT(nms, 270, mkChar("dim_wdI_2"));
  SET_STRING_ELT(nms, 271, mkChar("dim_wdI_3"));
  SET_STRING_ELT(nms, 272, mkChar("dim_wdS"));
  SET_STRING_ELT(nms, 273, mkChar("dim_wdS_1"));
  SET_STRING_ELT(nms, 274, mkChar("dim_wdS_12"));
  SET_STRING_ELT(nms, 275, mkChar("dim_wdS_2"));
  SET_STRING_ELT(nms, 276, mkChar("dim_wdS_3"));
  SET_STRING_ELT(nms, 277, mkChar("dim_wdT"));
  SET_STRING_ELT(nms, 278, mkChar("dim_wdT_1"));
  SET_STRING_ELT(nms, 279, mkChar("dim_wdT_12"));
  SET_STRING_ELT(nms, 280, mkChar("dim_wdT_2"));
  SET_STRING_ELT(nms, 281, mkChar("dim_wdT_3"));
  SET_STRING_ELT(nms, 282, mkChar("dim_wdU"));
  SET_STRING_ELT(nms, 283, mkChar("dim_wdU_1"));
  SET_STRING_ELT(nms, 284, mkChar("dim_wdU_12"));
  SET_STRING_ELT(nms, 285, mkChar("dim_wdU_2"));
  SET_STRING_ELT(nms, 286, mkChar("dim_wdU_3"));
  SET_STRING_ELT(nms, 287, mkChar("dim_wI"));
  SET_STRING_ELT(nms, 288, mkChar("dim_wI_1"));
  SET_STRING_ELT(nms, 289, mkChar("dim_wI_12"));
  SET_STRING_ELT(nms, 290, mkChar("dim_wI_2"));
  SET_STRING_ELT(nms, 291, mkChar("dim_wI_3"));
  SET_STRING_ELT(nms, 292, mkChar("dim_willing"));
  SET_STRING_ELT(nms, 293, mkChar("dim_wS"));
  SET_STRING_ELT(nms, 294, mkChar("dim_wS_1"));
  SET_STRING_ELT(nms, 295, mkChar("dim_wS_12"));
  SET_STRING_ELT(nms, 296, mkChar("dim_wS_2"));
  SET_STRING_ELT(nms, 297, mkChar("dim_wS_3"));
  SET_STRING_ELT(nms, 298, mkChar("dim_wT"));
  SET_STRING_ELT(nms, 299, mkChar("dim_wT_1"));
  SET_STRING_ELT(nms, 300, mkChar("dim_wT_12"));
  SET_STRING_ELT(nms, 301, mkChar("dim_wT_2"));
  SET_STRING_ELT(nms, 302, mkChar("dim_wT_3"));
  SET_STRING_ELT(nms, 303, mkChar("dim_wU"));
  SET_STRING_ELT(nms, 304, mkChar("dim_wU_1"));
  SET_STRING_ELT(nms, 305, mkChar("dim_wU_12"));
  SET_STRING_ELT(nms, 306, mkChar("dim_wU_2"));
  SET_STRING_ELT(nms, 307, mkChar("dim_wU_3"));
  SET_STRING_ELT(nms, 308, mkChar("dim_xi"));
  SET_STRING_ELT(nms, 309, mkChar("dim_xi_1"));
  SET_STRING_ELT(nms, 310, mkChar("dim_xi_2"));
  SET_STRING_ELT(nms, 311, mkChar("enr"));
  SET_STRING_ELT(nms, 312, mkChar("entrants"));
  SET_STRING_ELT(nms, 313, mkChar("epsilon"));
  SET_STRING_ELT(nms, 314, mkChar("epsilon_hes"));
  SET_STRING_ELT(nms, 315, mkChar("eta"));
  SET_STRING_ELT(nms, 316, mkChar("eta_h_t"));
  SET_STRING_ELT(nms, 317, mkChar("eta_l_t"));
  SET_STRING_ELT(nms, 318, mkChar("exr"));
  SET_STRING_ELT(nms, 319, mkChar("foi_LH"));
  SET_STRING_ELT(nms, 320, mkChar("hesgroupmatrix"));
  SET_STRING_ELT(nms, 321, mkChar("I0"));
  SET_STRING_ELT(nms, 322, mkChar("initial_A"));
  SET_STRING_ELT(nms, 323, mkChar("initial_cum_diag_a"));
  SET_STRING_ELT(nms, 324, mkChar("initial_cum_diag_s"));
  SET_STRING_ELT(nms, 325, mkChar("initial_cum_entrants"));
  SET_STRING_ELT(nms, 326, mkChar("initial_cum_incid"));
  SET_STRING_ELT(nms, 327, mkChar("initial_cum_offered"));
  SET_STRING_ELT(nms, 328, mkChar("initial_cum_offered_pn"));
  SET_STRING_ELT(nms, 329, mkChar("initial_cum_offered_vbe"));
  SET_STRING_ELT(nms, 330, mkChar("initial_cum_screened"));
  SET_STRING_ELT(nms, 331, mkChar("initial_cum_treated"));
  SET_STRING_ELT(nms, 332, mkChar("initial_cum_vaccinated"));
  SET_STRING_ELT(nms, 333, mkChar("initial_cum_vaccinated_pn"));
  SET_STRING_ELT(nms, 334, mkChar("initial_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 335, mkChar("initial_cum_vbe"));
  SET_STRING_ELT(nms, 336, mkChar("initial_I"));
  SET_STRING_ELT(nms, 337, mkChar("initial_S"));
  SET_STRING_ELT(nms, 338, mkChar("initial_T"));
  SET_STRING_ELT(nms, 339, mkChar("initial_U"));
  SET_STRING_ELT(nms, 340, mkChar("interpolate_beta"));
  SET_STRING_ELT(nms, 341, mkChar("interpolate_eta_h"));
  SET_STRING_ELT(nms, 342, mkChar("interpolate_eta_l"));
  SET_STRING_ELT(nms, 343, mkChar("interpolate_vax_switch"));
  SET_STRING_ELT(nms, 344, mkChar("kappa"));
  SET_STRING_ELT(nms, 345, mkChar("lambda"));
  SET_STRING_ELT(nms, 346, mkChar("mu"));
  SET_STRING_ELT(nms, 347, mkChar("N"));
  SET_STRING_ELT(nms, 348, mkChar("n_AT"));
  SET_STRING_ELT(nms, 349, mkChar("n_AU"));
  SET_STRING_ELT(nms, 350, mkChar("n_diag_rec"));
  SET_STRING_ELT(nms, 351, mkChar("n_group"));
  SET_STRING_ELT(nms, 352, mkChar("N_hesgroup"));
  SET_STRING_ELT(nms, 353, mkChar("n_obe"));
  SET_STRING_ELT(nms, 354, mkChar("n_ood"));
  SET_STRING_ELT(nms, 355, mkChar("n_oopn"));
  SET_STRING_ELT(nms, 356, mkChar("n_oos"));
  SET_STRING_ELT(nms, 357, mkChar("n_ST"));
  SET_STRING_ELT(nms, 358, mkChar("n_TU"));
  SET_STRING_ELT(nms, 359, mkChar("n_UI"));
  SET_STRING_ELT(nms, 360, mkChar("n_vax"));
  SET_STRING_ELT(nms, 361, mkChar("n_vbe"));
  SET_STRING_ELT(nms, 362, mkChar("n_vod"));
  SET_STRING_ELT(nms, 363, mkChar("n_vopn"));
  SET_STRING_ELT(nms, 364, mkChar("n_vos"));
  SET_STRING_ELT(nms, 365, mkChar("notifiedandattended"));
  SET_STRING_ELT(nms, 366, mkChar("notifiedprev"));
  SET_STRING_ELT(nms, 367, mkChar("Np"));
  SET_STRING_ELT(nms, 368, mkChar("nu"));
  SET_STRING_ELT(nms, 369, mkChar("offset_output_lambda"));
  SET_STRING_ELT(nms, 370, mkChar("offset_output_N"));
  SET_STRING_ELT(nms, 371, mkChar("offset_output_notifiedandattended"));
  SET_STRING_ELT(nms, 372, mkChar("offset_output_phi"));
  SET_STRING_ELT(nms, 373, mkChar("offset_output_prop_C_hesgroup"));
  SET_STRING_ELT(nms, 374, mkChar("offset_output_prop_C_hesriskgroup"));
  SET_STRING_ELT(nms, 375, mkChar("offset_variable_A"));
  SET_STRING_ELT(nms, 376, mkChar("offset_variable_cum_diag_a"));
  SET_STRING_ELT(nms, 377, mkChar("offset_variable_cum_diag_s"));
  SET_STRING_ELT(nms, 378, mkChar("offset_variable_cum_entrants"));
  SET_STRING_ELT(nms, 379, mkChar("offset_variable_cum_incid"));
  SET_STRING_ELT(nms, 380, mkChar("offset_variable_cum_offered"));
  SET_STRING_ELT(nms, 381, mkChar("offset_variable_cum_offered_pn"));
  SET_STRING_ELT(nms, 382, mkChar("offset_variable_cum_offered_vbe"));
  SET_STRING_ELT(nms, 383, mkChar("offset_variable_cum_screened"));
  SET_STRING_ELT(nms, 384, mkChar("offset_variable_cum_treated"));
  SET_STRING_ELT(nms, 385, mkChar("offset_variable_cum_vaccinated"));
  SET_STRING_ELT(nms, 386, mkChar("offset_variable_cum_vaccinated_pn"));
  SET_STRING_ELT(nms, 387, mkChar("offset_variable_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 388, mkChar("offset_variable_cum_vbe"));
  SET_STRING_ELT(nms, 389, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 390, mkChar("offset_variable_T"));
  SET_STRING_ELT(nms, 391, mkChar("omega_C"));
  SET_STRING_ELT(nms, 392, mkChar("omega_C_withdiag"));
  SET_STRING_ELT(nms, 393, mkChar("omega_C_withdiag_rg"));
  SET_STRING_ELT(nms, 394, mkChar("omega_U"));
  SET_STRING_ELT(nms, 395, mkChar("omega_U_withdiag"));
  SET_STRING_ELT(nms, 396, mkChar("omega_U_withdiag_rg"));
  SET_STRING_ELT(nms, 397, mkChar("p"));
  SET_STRING_ELT(nms, 398, mkChar("phi"));
  SET_STRING_ELT(nms, 399, mkChar("prop_C"));
  SET_STRING_ELT(nms, 400, mkChar("prop_C_hesgroup"));
  SET_STRING_ELT(nms, 401, mkChar("prop_C_hesriskgroup"));
  SET_STRING_ELT(nms, 402, mkChar("prop_CCsubgroup"));
  SET_STRING_ELT(nms, 403, mkChar("prop_UUsubgroup"));
  SET_STRING_ELT(nms, 404, mkChar("psi"));
  SET_STRING_ELT(nms, 405, mkChar("q"));
  SET_STRING_ELT(nms, 406, mkChar("rho"));
  SET_STRING_ELT(nms, 407, mkChar("S0"));
  SET_STRING_ELT(nms, 408, mkChar("screened"));
  SET_STRING_ELT(nms, 409, mkChar("sigma"));
  SET_STRING_ELT(nms, 410, mkChar("T0"));
  SET_STRING_ELT(nms, 411, mkChar("tt"));
  SET_STRING_ELT(nms, 412, mkChar("u_d"));
  SET_STRING_ELT(nms, 413, mkChar("u_pn"));
  SET_STRING_ELT(nms, 414, mkChar("u_s"));
  SET_STRING_ELT(nms, 415, mkChar("u_vbe"));
  SET_STRING_ELT(nms, 416, mkChar("U0"));
  SET_STRING_ELT(nms, 417, mkChar("Up"));
  SET_STRING_ELT(nms, 418, mkChar("vax_t"));
  SET_STRING_ELT(nms, 419, mkChar("vax_y"));
  SET_STRING_ELT(nms, 420, mkChar("vbe"));
  SET_STRING_ELT(nms, 421, mkChar("vea"));
  SET_STRING_ELT(nms, 422, mkChar("ved"));
  SET_STRING_ELT(nms, 423, mkChar("vei"));
  SET_STRING_ELT(nms, 424, mkChar("ves"));
  SET_STRING_ELT(nms, 425, mkChar("vod"));
  SET_STRING_ELT(nms, 426, mkChar("vopn"));
  SET_STRING_ELT(nms, 427, mkChar("vos"));
  SET_STRING_ELT(nms, 428, mkChar("w"));
  SET_STRING_ELT(nms, 429, mkChar("wA"));
  SET_STRING_ELT(nms, 430, mkChar("wd"));
  SET_STRING_ELT(nms, 431, mkChar("wdA"));
  SET_STRING_ELT(nms, 432, mkChar("wdI"));
  SET_STRING_ELT(nms, 433, mkChar("wdS"));
  SET_STRING_ELT(nms, 434, mkChar("wdT"));
  SET_STRING_ELT(nms, 435, mkChar("wdU"));
  SET_STRING_ELT(nms, 436, mkChar("wI"));
  SET_STRING_ELT(nms, 437, mkChar("willing"));
  SET_STRING_ELT(nms, 438, mkChar("wS"));
  SET_STRING_ELT(nms, 439, mkChar("wT"));
  SET_STRING_ELT(nms, 440, mkChar("wU"));
  SET_STRING_ELT(nms, 441, mkChar("xi"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(99);
  return contents;
}
SEXP model_set_user(SEXP internal_p, SEXP user) {
  model_internal *internal = model_get_internal(internal_p, 1);
  internal->enr = user_get_scalar_double(user, "enr", internal->enr, NA_REAL, NA_REAL);
  internal->epsilon = user_get_scalar_double(user, "epsilon", internal->epsilon, NA_REAL, NA_REAL);
  internal->epsilon_hes = user_get_scalar_double(user, "epsilon_hes", internal->epsilon_hes, NA_REAL, NA_REAL);
  internal->exr = user_get_scalar_double(user, "exr", internal->exr, NA_REAL, NA_REAL);
  internal->kappa = user_get_scalar_double(user, "kappa", internal->kappa, NA_REAL, NA_REAL);
  internal->mu = user_get_scalar_double(user, "mu", internal->mu, NA_REAL, NA_REAL);
  internal->n_vax = user_get_scalar_int(user, "n_vax", internal->n_vax, NA_REAL, NA_REAL);
  internal->notifiedprev = user_get_scalar_double(user, "notifiedprev", internal->notifiedprev, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->psi = user_get_scalar_double(user, "psi", internal->psi, NA_REAL, NA_REAL);
  internal->rho = user_get_scalar_double(user, "rho", internal->rho, NA_REAL, NA_REAL);
  internal->sigma = user_get_scalar_double(user, "sigma", internal->sigma, NA_REAL, NA_REAL);
  internal->tt = (double*) user_get_array_dim(user, false, internal->tt, "tt", 1, NA_REAL, NA_REAL, &internal->dim_tt);
  internal->u_vbe = user_get_scalar_double(user, "u_vbe", internal->u_vbe, NA_REAL, NA_REAL);
  internal->vax_t = (double*) user_get_array_dim(user, false, internal->vax_t, "vax_t", 1, NA_REAL, NA_REAL, &internal->dim_vax_t);
  internal->vax_y = (double*) user_get_array_dim(user, false, internal->vax_y, "vax_y", 1, NA_REAL, NA_REAL, &internal->dim_vax_y);
  internal->dim_A_1 = internal->n_group;
  internal->dim_A_2 = internal->n_vax;
  internal->dim_A0_1 = internal->n_group;
  internal->dim_A0_2 = internal->n_vax;
  internal->dim_C_1 = internal->n_group;
  internal->dim_C_2 = internal->n_vax;
  internal->dim_C_hesgroup_1 = internal->n_group;
  internal->dim_C_hesgroup_2 = internal->n_vax;
  internal->dim_C_hesgroup_3 = internal->n_vax;
  internal->dim_cum_diag_a_1 = internal->n_group;
  internal->dim_cum_diag_a_2 = internal->n_vax;
  internal->dim_cum_diag_s_1 = internal->n_group;
  internal->dim_cum_diag_s_2 = internal->n_vax;
  internal->dim_cum_entrants_1 = internal->n_group;
  internal->dim_cum_entrants_2 = internal->n_vax;
  internal->dim_cum_incid_1 = internal->n_group;
  internal->dim_cum_incid_2 = internal->n_vax;
  internal->dim_cum_offered_1 = internal->n_group;
  internal->dim_cum_offered_2 = internal->n_vax;
  internal->dim_cum_offered_pn_1 = internal->n_group;
  internal->dim_cum_offered_pn_2 = internal->n_vax;
  internal->dim_cum_offered_vbe_1 = internal->n_group;
  internal->dim_cum_offered_vbe_2 = internal->n_vax;
  internal->dim_cum_screened_1 = internal->n_group;
  internal->dim_cum_screened_2 = internal->n_vax;
  internal->dim_cum_treated_1 = internal->n_group;
  internal->dim_cum_treated_2 = internal->n_vax;
  internal->dim_cum_vaccinated_1 = internal->n_group;
  internal->dim_cum_vaccinated_2 = internal->n_vax;
  internal->dim_cum_vaccinated_pn_1 = internal->n_group;
  internal->dim_cum_vaccinated_pn_2 = internal->n_vax;
  internal->dim_cum_vaccinated_screen_1 = internal->n_group;
  internal->dim_cum_vaccinated_screen_2 = internal->n_vax;
  internal->dim_cum_vbe_1 = internal->n_group;
  internal->dim_cum_vbe_2 = internal->n_vax;
  internal->dim_diag_rec_1 = internal->n_group;
  internal->dim_diag_rec_2 = internal->n_vax;
  internal->dim_diag_rec_3 = internal->n_vax;
  internal->dim_entrants_1 = internal->n_group;
  internal->dim_entrants_2 = internal->n_vax;
  internal->dim_hesgroupmatrix_1 = internal->n_vax;
  internal->dim_hesgroupmatrix_2 = internal->n_vax;
  internal->dim_I_1 = internal->n_group;
  internal->dim_I_2 = internal->n_vax;
  internal->dim_I0_1 = internal->n_group;
  internal->dim_I0_2 = internal->n_vax;
  internal->dim_lambda_1 = internal->n_group;
  internal->dim_lambda_2 = internal->n_vax;
  internal->dim_N_1 = internal->n_group;
  internal->dim_N_2 = internal->n_vax;
  internal->dim_n_AT_1 = internal->n_group;
  internal->dim_n_AT_2 = internal->n_vax;
  internal->dim_n_AU_1 = internal->n_group;
  internal->dim_n_AU_2 = internal->n_vax;
  internal->dim_n_diag_rec_1 = internal->n_group;
  internal->dim_n_diag_rec_2 = internal->n_vax;
  internal->dim_n_diag_rec_3 = internal->n_vax;
  internal->dim_N_hesgroup_1 = internal->n_group;
  internal->dim_N_hesgroup_2 = internal->n_vax;
  internal->dim_N_hesgroup_3 = internal->n_vax;
  internal->dim_n_obe_1 = internal->n_group;
  internal->dim_n_obe_2 = internal->n_vax;
  internal->dim_n_obe_3 = internal->n_vax;
  internal->dim_n_ood_1 = internal->n_group;
  internal->dim_n_ood_2 = internal->n_vax;
  internal->dim_n_ood_3 = internal->n_vax;
  internal->dim_n_oopn_1 = internal->n_group;
  internal->dim_n_oopn_2 = internal->n_vax;
  internal->dim_n_oopn_3 = internal->n_vax;
  internal->dim_n_oos_1 = internal->n_group;
  internal->dim_n_oos_2 = internal->n_vax;
  internal->dim_n_oos_3 = internal->n_vax;
  internal->dim_n_ST_1 = internal->n_group;
  internal->dim_n_ST_2 = internal->n_vax;
  internal->dim_n_TU_1 = internal->n_group;
  internal->dim_n_TU_2 = internal->n_vax;
  internal->dim_n_UI_1 = internal->n_group;
  internal->dim_n_UI_2 = internal->n_vax;
  internal->dim_n_vbe_1 = internal->n_group;
  internal->dim_n_vbe_2 = internal->n_vax;
  internal->dim_n_vbe_3 = internal->n_vax;
  internal->dim_n_vod_1 = internal->n_group;
  internal->dim_n_vod_2 = internal->n_vax;
  internal->dim_n_vod_3 = internal->n_vax;
  internal->dim_n_vopn_1 = internal->n_group;
  internal->dim_n_vopn_2 = internal->n_vax;
  internal->dim_n_vopn_3 = internal->n_vax;
  internal->dim_n_vos_1 = internal->n_group;
  internal->dim_n_vos_2 = internal->n_vax;
  internal->dim_n_vos_3 = internal->n_vax;
  internal->dim_notifiedandattended_1 = internal->n_group;
  internal->dim_notifiedandattended_2 = internal->n_vax;
  internal->dim_phi_1 = internal->n_group;
  internal->dim_phi_2 = internal->n_vax;
  internal->dim_prop_C_hesgroup = internal->n_vax;
  internal->dim_prop_C_hesriskgroup_1 = internal->n_group;
  internal->dim_prop_C_hesriskgroup_2 = internal->n_vax;
  internal->dim_prop_CCsubgroup_1 = internal->n_group;
  internal->dim_prop_CCsubgroup_2 = internal->n_vax;
  internal->dim_prop_UUsubgroup_1 = internal->n_group;
  internal->dim_prop_UUsubgroup_2 = internal->n_vax;
  internal->dim_S_1 = internal->n_group;
  internal->dim_S_2 = internal->n_vax;
  internal->dim_S0_1 = internal->n_group;
  internal->dim_S0_2 = internal->n_vax;
  internal->dim_screened_1 = internal->n_group;
  internal->dim_screened_2 = internal->n_vax;
  internal->dim_T_1 = internal->n_group;
  internal->dim_T_2 = internal->n_vax;
  internal->dim_T0_1 = internal->n_group;
  internal->dim_T0_2 = internal->n_vax;
  internal->dim_U_1 = internal->n_group;
  internal->dim_U_2 = internal->n_vax;
  internal->dim_u_d_1 = internal->n_group;
  internal->dim_u_d_2 = internal->n_vax;
  internal->dim_u_d_3 = internal->n_vax;
  internal->dim_u_pn_1 = internal->n_group;
  internal->dim_u_pn_2 = internal->n_vax;
  internal->dim_u_pn_3 = internal->n_vax;
  internal->dim_u_s_1 = internal->n_group;
  internal->dim_u_s_2 = internal->n_vax;
  internal->dim_u_s_3 = internal->n_vax;
  internal->dim_U0_1 = internal->n_group;
  internal->dim_U0_2 = internal->n_vax;
  internal->dim_vbe_1 = internal->n_group;
  internal->dim_vbe_2 = internal->n_vax;
  internal->dim_vbe_3 = internal->n_vax;
  internal->dim_vea = internal->n_vax;
  internal->dim_ved = internal->n_vax;
  internal->dim_vei = internal->n_vax;
  internal->dim_ves = internal->n_vax;
  internal->dim_vod_1 = internal->n_group;
  internal->dim_vod_2 = internal->n_vax;
  internal->dim_vod_3 = internal->n_vax;
  internal->dim_vopn_1 = internal->n_group;
  internal->dim_vopn_2 = internal->n_vax;
  internal->dim_vopn_3 = internal->n_vax;
  internal->dim_vos_1 = internal->n_group;
  internal->dim_vos_2 = internal->n_vax;
  internal->dim_vos_3 = internal->n_vax;
  internal->dim_w_1 = internal->n_vax;
  internal->dim_w_2 = internal->n_vax;
  internal->dim_wA_1 = internal->n_group;
  internal->dim_wA_2 = internal->n_vax;
  internal->dim_wA_3 = internal->n_vax;
  internal->dim_wd_1 = internal->n_vax;
  internal->dim_wd_2 = internal->n_vax;
  internal->dim_wdA_1 = internal->n_group;
  internal->dim_wdA_2 = internal->n_vax;
  internal->dim_wdA_3 = internal->n_vax;
  internal->dim_wdI_1 = internal->n_group;
  internal->dim_wdI_2 = internal->n_vax;
  internal->dim_wdI_3 = internal->n_vax;
  internal->dim_wdS_1 = internal->n_group;
  internal->dim_wdS_2 = internal->n_vax;
  internal->dim_wdS_3 = internal->n_vax;
  internal->dim_wdT_1 = internal->n_group;
  internal->dim_wdT_2 = internal->n_vax;
  internal->dim_wdT_3 = internal->n_vax;
  internal->dim_wdU_1 = internal->n_group;
  internal->dim_wdU_2 = internal->n_vax;
  internal->dim_wdU_3 = internal->n_vax;
  internal->dim_wI_1 = internal->n_group;
  internal->dim_wI_2 = internal->n_vax;
  internal->dim_wI_3 = internal->n_vax;
  internal->dim_willing = internal->n_vax;
  internal->dim_wS_1 = internal->n_group;
  internal->dim_wS_2 = internal->n_vax;
  internal->dim_wS_3 = internal->n_vax;
  internal->dim_wT_1 = internal->n_group;
  internal->dim_wT_2 = internal->n_vax;
  internal->dim_wT_3 = internal->n_vax;
  internal->dim_wU_1 = internal->n_group;
  internal->dim_wU_2 = internal->n_vax;
  internal->dim_wU_3 = internal->n_vax;
  internal->dim_xi_1 = internal->n_group;
  internal->dim_xi_2 = internal->n_vax;
  interpolate_check_y(internal->dim_vax_t, internal->dim_vax_y, 0, "vax_y", "vax_switch");
  cinterpolate_free(internal->interpolate_vax_switch);
  internal->interpolate_vax_switch = cinterpolate_alloc("constant", internal->dim_vax_t, 1, internal->vax_t, internal->vax_y, true, false);
  R_Free(internal->prop_C_hesgroup);
  internal->prop_C_hesgroup = (double*) R_Calloc(internal->dim_prop_C_hesgroup, double);
  internal->dim_A = internal->dim_A_1 * internal->dim_A_2;
  internal->dim_A0 = internal->dim_A0_1 * internal->dim_A0_2;
  internal->dim_beta_t = internal->dim_tt;
  internal->dim_C = internal->dim_C_1 * internal->dim_C_2;
  internal->dim_C_hesgroup = internal->dim_C_hesgroup_1 * internal->dim_C_hesgroup_2 * internal->dim_C_hesgroup_3;
  internal->dim_C_hesgroup_12 = internal->dim_C_hesgroup_1 * internal->dim_C_hesgroup_2;
  internal->dim_cum_diag_a = internal->dim_cum_diag_a_1 * internal->dim_cum_diag_a_2;
  internal->dim_cum_diag_s = internal->dim_cum_diag_s_1 * internal->dim_cum_diag_s_2;
  internal->dim_cum_entrants = internal->dim_cum_entrants_1 * internal->dim_cum_entrants_2;
  internal->dim_cum_incid = internal->dim_cum_incid_1 * internal->dim_cum_incid_2;
  internal->dim_cum_offered = internal->dim_cum_offered_1 * internal->dim_cum_offered_2;
  internal->dim_cum_offered_pn = internal->dim_cum_offered_pn_1 * internal->dim_cum_offered_pn_2;
  internal->dim_cum_offered_vbe = internal->dim_cum_offered_vbe_1 * internal->dim_cum_offered_vbe_2;
  internal->dim_cum_screened = internal->dim_cum_screened_1 * internal->dim_cum_screened_2;
  internal->dim_cum_treated = internal->dim_cum_treated_1 * internal->dim_cum_treated_2;
  internal->dim_cum_vaccinated = internal->dim_cum_vaccinated_1 * internal->dim_cum_vaccinated_2;
  internal->dim_cum_vaccinated_pn = internal->dim_cum_vaccinated_pn_1 * internal->dim_cum_vaccinated_pn_2;
  internal->dim_cum_vaccinated_screen = internal->dim_cum_vaccinated_screen_1 * internal->dim_cum_vaccinated_screen_2;
  internal->dim_cum_vbe = internal->dim_cum_vbe_1 * internal->dim_cum_vbe_2;
  internal->dim_diag_rec = internal->dim_diag_rec_1 * internal->dim_diag_rec_2 * internal->dim_diag_rec_3;
  internal->dim_diag_rec_12 = internal->dim_diag_rec_1 * internal->dim_diag_rec_2;
  internal->dim_entrants = internal->dim_entrants_1 * internal->dim_entrants_2;
  internal->dim_eta_h_t = internal->dim_tt;
  internal->dim_eta_l_t = internal->dim_tt;
  internal->dim_hesgroupmatrix = internal->dim_hesgroupmatrix_1 * internal->dim_hesgroupmatrix_2;
  internal->dim_I = internal->dim_I_1 * internal->dim_I_2;
  internal->dim_I0 = internal->dim_I0_1 * internal->dim_I0_2;
  internal->dim_lambda = internal->dim_lambda_1 * internal->dim_lambda_2;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_n_AT = internal->dim_n_AT_1 * internal->dim_n_AT_2;
  internal->dim_n_AU = internal->dim_n_AU_1 * internal->dim_n_AU_2;
  internal->dim_n_diag_rec = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2 * internal->dim_n_diag_rec_3;
  internal->dim_n_diag_rec_12 = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2;
  internal->dim_N_hesgroup = internal->dim_N_hesgroup_1 * internal->dim_N_hesgroup_2 * internal->dim_N_hesgroup_3;
  internal->dim_N_hesgroup_12 = internal->dim_N_hesgroup_1 * internal->dim_N_hesgroup_2;
  internal->dim_n_obe = internal->dim_n_obe_1 * internal->dim_n_obe_2 * internal->dim_n_obe_3;
  internal->dim_n_obe_12 = internal->dim_n_obe_1 * internal->dim_n_obe_2;
  internal->dim_n_ood = internal->dim_n_ood_1 * internal->dim_n_ood_2 * internal->dim_n_ood_3;
  internal->dim_n_ood_12 = internal->dim_n_ood_1 * internal->dim_n_ood_2;
  internal->dim_n_oopn = internal->dim_n_oopn_1 * internal->dim_n_oopn_2 * internal->dim_n_oopn_3;
  internal->dim_n_oopn_12 = internal->dim_n_oopn_1 * internal->dim_n_oopn_2;
  internal->dim_n_oos = internal->dim_n_oos_1 * internal->dim_n_oos_2 * internal->dim_n_oos_3;
  internal->dim_n_oos_12 = internal->dim_n_oos_1 * internal->dim_n_oos_2;
  internal->dim_n_ST = internal->dim_n_ST_1 * internal->dim_n_ST_2;
  internal->dim_n_TU = internal->dim_n_TU_1 * internal->dim_n_TU_2;
  internal->dim_n_UI = internal->dim_n_UI_1 * internal->dim_n_UI_2;
  internal->dim_n_vbe = internal->dim_n_vbe_1 * internal->dim_n_vbe_2 * internal->dim_n_vbe_3;
  internal->dim_n_vbe_12 = internal->dim_n_vbe_1 * internal->dim_n_vbe_2;
  internal->dim_n_vod = internal->dim_n_vod_1 * internal->dim_n_vod_2 * internal->dim_n_vod_3;
  internal->dim_n_vod_12 = internal->dim_n_vod_1 * internal->dim_n_vod_2;
  internal->dim_n_vopn = internal->dim_n_vopn_1 * internal->dim_n_vopn_2 * internal->dim_n_vopn_3;
  internal->dim_n_vopn_12 = internal->dim_n_vopn_1 * internal->dim_n_vopn_2;
  internal->dim_n_vos = internal->dim_n_vos_1 * internal->dim_n_vos_2 * internal->dim_n_vos_3;
  internal->dim_n_vos_12 = internal->dim_n_vos_1 * internal->dim_n_vos_2;
  internal->dim_notifiedandattended = internal->dim_notifiedandattended_1 * internal->dim_notifiedandattended_2;
  internal->dim_phi = internal->dim_phi_1 * internal->dim_phi_2;
  internal->dim_prop_C_hesriskgroup = internal->dim_prop_C_hesriskgroup_1 * internal->dim_prop_C_hesriskgroup_2;
  internal->dim_prop_CCsubgroup = internal->dim_prop_CCsubgroup_1 * internal->dim_prop_CCsubgroup_2;
  internal->dim_prop_UUsubgroup = internal->dim_prop_UUsubgroup_1 * internal->dim_prop_UUsubgroup_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_S0 = internal->dim_S0_1 * internal->dim_S0_2;
  internal->dim_screened = internal->dim_screened_1 * internal->dim_screened_2;
  internal->dim_T = internal->dim_T_1 * internal->dim_T_2;
  internal->dim_T0 = internal->dim_T0_1 * internal->dim_T0_2;
  internal->dim_U = internal->dim_U_1 * internal->dim_U_2;
  internal->dim_u_d = internal->dim_u_d_1 * internal->dim_u_d_2 * internal->dim_u_d_3;
  internal->dim_u_d_12 = internal->dim_u_d_1 * internal->dim_u_d_2;
  internal->dim_u_pn = internal->dim_u_pn_1 * internal->dim_u_pn_2 * internal->dim_u_pn_3;
  internal->dim_u_pn_12 = internal->dim_u_pn_1 * internal->dim_u_pn_2;
  internal->dim_u_s = internal->dim_u_s_1 * internal->dim_u_s_2 * internal->dim_u_s_3;
  internal->dim_u_s_12 = internal->dim_u_s_1 * internal->dim_u_s_2;
  internal->dim_U0 = internal->dim_U0_1 * internal->dim_U0_2;
  internal->dim_vbe = internal->dim_vbe_1 * internal->dim_vbe_2 * internal->dim_vbe_3;
  internal->dim_vbe_12 = internal->dim_vbe_1 * internal->dim_vbe_2;
  internal->dim_vod = internal->dim_vod_1 * internal->dim_vod_2 * internal->dim_vod_3;
  internal->dim_vod_12 = internal->dim_vod_1 * internal->dim_vod_2;
  internal->dim_vopn = internal->dim_vopn_1 * internal->dim_vopn_2 * internal->dim_vopn_3;
  internal->dim_vopn_12 = internal->dim_vopn_1 * internal->dim_vopn_2;
  internal->dim_vos = internal->dim_vos_1 * internal->dim_vos_2 * internal->dim_vos_3;
  internal->dim_vos_12 = internal->dim_vos_1 * internal->dim_vos_2;
  internal->dim_w = internal->dim_w_1 * internal->dim_w_2;
  internal->dim_wA = internal->dim_wA_1 * internal->dim_wA_2 * internal->dim_wA_3;
  internal->dim_wA_12 = internal->dim_wA_1 * internal->dim_wA_2;
  internal->dim_wd = internal->dim_wd_1 * internal->dim_wd_2;
  internal->dim_wdA = internal->dim_wdA_1 * internal->dim_wdA_2 * internal->dim_wdA_3;
  internal->dim_wdA_12 = internal->dim_wdA_1 * internal->dim_wdA_2;
  internal->dim_wdI = internal->dim_wdI_1 * internal->dim_wdI_2 * internal->dim_wdI_3;
  internal->dim_wdI_12 = internal->dim_wdI_1 * internal->dim_wdI_2;
  internal->dim_wdS = internal->dim_wdS_1 * internal->dim_wdS_2 * internal->dim_wdS_3;
  internal->dim_wdS_12 = internal->dim_wdS_1 * internal->dim_wdS_2;
  internal->dim_wdT = internal->dim_wdT_1 * internal->dim_wdT_2 * internal->dim_wdT_3;
  internal->dim_wdT_12 = internal->dim_wdT_1 * internal->dim_wdT_2;
  internal->dim_wdU = internal->dim_wdU_1 * internal->dim_wdU_2 * internal->dim_wdU_3;
  internal->dim_wdU_12 = internal->dim_wdU_1 * internal->dim_wdU_2;
  internal->dim_wI = internal->dim_wI_1 * internal->dim_wI_2 * internal->dim_wI_3;
  internal->dim_wI_12 = internal->dim_wI_1 * internal->dim_wI_2;
  internal->dim_wS = internal->dim_wS_1 * internal->dim_wS_2 * internal->dim_wS_3;
  internal->dim_wS_12 = internal->dim_wS_1 * internal->dim_wS_2;
  internal->dim_wT = internal->dim_wT_1 * internal->dim_wT_2 * internal->dim_wT_3;
  internal->dim_wT_12 = internal->dim_wT_1 * internal->dim_wT_2;
  internal->dim_wU = internal->dim_wU_1 * internal->dim_wU_2 * internal->dim_wU_3;
  internal->dim_wU_12 = internal->dim_wU_1 * internal->dim_wU_2;
  internal->dim_xi = internal->dim_xi_1 * internal->dim_xi_2;
  internal->offset_output_N = internal->dim_eta + internal->dim_prop_C_hesgroup + 3;
  internal->p = (double*) user_get_array(user, false, internal->p, "p", NA_REAL, NA_REAL, 1, internal->dim_p);
  internal->q = (double*) user_get_array(user, false, internal->q, "q", NA_REAL, NA_REAL, 1, internal->dim_q);
  internal->vea = (double*) user_get_array(user, false, internal->vea, "vea", NA_REAL, NA_REAL, 1, internal->dim_vea);
  internal->ved = (double*) user_get_array(user, false, internal->ved, "ved", NA_REAL, NA_REAL, 1, internal->dim_ved);
  internal->vei = (double*) user_get_array(user, false, internal->vei, "vei", NA_REAL, NA_REAL, 1, internal->dim_vei);
  internal->ves = (double*) user_get_array(user, false, internal->ves, "ves", NA_REAL, NA_REAL, 1, internal->dim_ves);
  internal->willing = (double*) user_get_array(user, false, internal->willing, "willing", NA_REAL, NA_REAL, 1, internal->dim_willing);
  internal->A0 = (double*) user_get_array(user, false, internal->A0, "A0", NA_REAL, NA_REAL, 2, internal->dim_A0_1, internal->dim_A0_2);
  R_Free(internal->C);
  internal->C = (double*) R_Calloc(internal->dim_C, double);
  R_Free(internal->C_hesgroup);
  internal->C_hesgroup = (double*) R_Calloc(internal->dim_C_hesgroup, double);
  R_Free(internal->entrants);
  internal->entrants = (double*) R_Calloc(internal->dim_entrants, double);
  R_Free(internal->initial_A);
  internal->initial_A = (double*) R_Calloc(internal->dim_A, double);
  R_Free(internal->initial_cum_diag_a);
  internal->initial_cum_diag_a = (double*) R_Calloc(internal->dim_cum_diag_a, double);
  R_Free(internal->initial_cum_diag_s);
  internal->initial_cum_diag_s = (double*) R_Calloc(internal->dim_cum_diag_s, double);
  R_Free(internal->initial_cum_entrants);
  internal->initial_cum_entrants = (double*) R_Calloc(internal->dim_cum_entrants, double);
  R_Free(internal->initial_cum_incid);
  internal->initial_cum_incid = (double*) R_Calloc(internal->dim_cum_incid, double);
  R_Free(internal->initial_cum_offered);
  internal->initial_cum_offered = (double*) R_Calloc(internal->dim_cum_offered, double);
  R_Free(internal->initial_cum_offered_pn);
  internal->initial_cum_offered_pn = (double*) R_Calloc(internal->dim_cum_offered_pn, double);
  R_Free(internal->initial_cum_offered_vbe);
  internal->initial_cum_offered_vbe = (double*) R_Calloc(internal->dim_cum_offered_vbe, double);
  R_Free(internal->initial_cum_screened);
  internal->initial_cum_screened = (double*) R_Calloc(internal->dim_cum_screened, double);
  R_Free(internal->initial_cum_treated);
  internal->initial_cum_treated = (double*) R_Calloc(internal->dim_cum_treated, double);
  R_Free(internal->initial_cum_vaccinated);
  internal->initial_cum_vaccinated = (double*) R_Calloc(internal->dim_cum_vaccinated, double);
  R_Free(internal->initial_cum_vaccinated_pn);
  internal->initial_cum_vaccinated_pn = (double*) R_Calloc(internal->dim_cum_vaccinated_pn, double);
  R_Free(internal->initial_cum_vaccinated_screen);
  internal->initial_cum_vaccinated_screen = (double*) R_Calloc(internal->dim_cum_vaccinated_screen, double);
  R_Free(internal->initial_cum_vbe);
  internal->initial_cum_vbe = (double*) R_Calloc(internal->dim_cum_vbe, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_T);
  internal->initial_T = (double*) R_Calloc(internal->dim_T, double);
  R_Free(internal->initial_U);
  internal->initial_U = (double*) R_Calloc(internal->dim_U, double);
  R_Free(internal->lambda);
  internal->lambda = (double*) R_Calloc(internal->dim_lambda, double);
  R_Free(internal->N);
  internal->N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->n_AT);
  internal->n_AT = (double*) R_Calloc(internal->dim_n_AT, double);
  R_Free(internal->n_AU);
  internal->n_AU = (double*) R_Calloc(internal->dim_n_AU, double);
  R_Free(internal->n_diag_rec);
  internal->n_diag_rec = (double*) R_Calloc(internal->dim_n_diag_rec, double);
  R_Free(internal->N_hesgroup);
  internal->N_hesgroup = (double*) R_Calloc(internal->dim_N_hesgroup, double);
  R_Free(internal->n_obe);
  internal->n_obe = (double*) R_Calloc(internal->dim_n_obe, double);
  R_Free(internal->n_ood);
  internal->n_ood = (double*) R_Calloc(internal->dim_n_ood, double);
  R_Free(internal->n_oopn);
  internal->n_oopn = (double*) R_Calloc(internal->dim_n_oopn, double);
  R_Free(internal->n_oos);
  internal->n_oos = (double*) R_Calloc(internal->dim_n_oos, double);
  R_Free(internal->n_ST);
  internal->n_ST = (double*) R_Calloc(internal->dim_n_ST, double);
  R_Free(internal->n_TU);
  internal->n_TU = (double*) R_Calloc(internal->dim_n_TU, double);
  R_Free(internal->n_UI);
  internal->n_UI = (double*) R_Calloc(internal->dim_n_UI, double);
  R_Free(internal->n_vbe);
  internal->n_vbe = (double*) R_Calloc(internal->dim_n_vbe, double);
  R_Free(internal->n_vod);
  internal->n_vod = (double*) R_Calloc(internal->dim_n_vod, double);
  R_Free(internal->n_vopn);
  internal->n_vopn = (double*) R_Calloc(internal->dim_n_vopn, double);
  R_Free(internal->n_vos);
  internal->n_vos = (double*) R_Calloc(internal->dim_n_vos, double);
  R_Free(internal->notifiedandattended);
  internal->notifiedandattended = (double*) R_Calloc(internal->dim_notifiedandattended, double);
  R_Free(internal->phi);
  internal->phi = (double*) R_Calloc(internal->dim_phi, double);
  R_Free(internal->prop_C_hesriskgroup);
  internal->prop_C_hesriskgroup = (double*) R_Calloc(internal->dim_prop_C_hesriskgroup, double);
  R_Free(internal->prop_CCsubgroup);
  internal->prop_CCsubgroup = (double*) R_Calloc(internal->dim_prop_CCsubgroup, double);
  R_Free(internal->prop_UUsubgroup);
  internal->prop_UUsubgroup = (double*) R_Calloc(internal->dim_prop_UUsubgroup, double);
  R_Free(internal->screened);
  internal->screened = (double*) R_Calloc(internal->dim_screened, double);
  R_Free(internal->wA);
  internal->wA = (double*) R_Calloc(internal->dim_wA, double);
  R_Free(internal->wdA);
  internal->wdA = (double*) R_Calloc(internal->dim_wdA, double);
  R_Free(internal->wdI);
  internal->wdI = (double*) R_Calloc(internal->dim_wdI, double);
  R_Free(internal->wdS);
  internal->wdS = (double*) R_Calloc(internal->dim_wdS, double);
  R_Free(internal->wdT);
  internal->wdT = (double*) R_Calloc(internal->dim_wdT, double);
  R_Free(internal->wdU);
  internal->wdU = (double*) R_Calloc(internal->dim_wdU, double);
  R_Free(internal->wI);
  internal->wI = (double*) R_Calloc(internal->dim_wI, double);
  R_Free(internal->wS);
  internal->wS = (double*) R_Calloc(internal->dim_wS, double);
  R_Free(internal->wT);
  internal->wT = (double*) R_Calloc(internal->dim_wT, double);
  R_Free(internal->wU);
  internal->wU = (double*) R_Calloc(internal->dim_wU, double);
  R_Free(internal->xi);
  internal->xi = (double*) R_Calloc(internal->dim_xi, double);
  internal->beta_t = (double*) user_get_array(user, false, internal->beta_t, "beta_t", NA_REAL, NA_REAL, 1, internal->dim_beta_t);
  internal->diag_rec = (double*) user_get_array(user, false, internal->diag_rec, "diag_rec", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_1, internal->dim_diag_rec_2, internal->dim_diag_rec_3);
  internal->eta_h_t = (double*) user_get_array(user, false, internal->eta_h_t, "eta_h_t", NA_REAL, NA_REAL, 1, internal->dim_eta_h_t);
  internal->eta_l_t = (double*) user_get_array(user, false, internal->eta_l_t, "eta_l_t", NA_REAL, NA_REAL, 1, internal->dim_eta_l_t);
  internal->hesgroupmatrix = (double*) user_get_array(user, false, internal->hesgroupmatrix, "hesgroupmatrix", NA_REAL, NA_REAL, 2, internal->dim_hesgroupmatrix_1, internal->dim_hesgroupmatrix_2);
  internal->I0 = (double*) user_get_array(user, false, internal->I0, "I0", NA_REAL, NA_REAL, 2, internal->dim_I0_1, internal->dim_I0_2);
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      internal->initial_cum_diag_a[i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      internal->initial_cum_diag_s[i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_entrants_2; ++j) {
      internal->initial_cum_entrants[i - 1 + internal->dim_cum_entrants_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      internal->initial_cum_incid[i - 1 + internal->dim_cum_incid_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      internal->initial_cum_offered[i - 1 + internal->dim_cum_offered_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_pn_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_pn_2; ++j) {
      internal->initial_cum_offered_pn[i - 1 + internal->dim_cum_offered_pn_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      internal->initial_cum_offered_vbe[i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      internal->initial_cum_screened[i - 1 + internal->dim_cum_screened_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      internal->initial_cum_treated[i - 1 + internal->dim_cum_treated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      internal->initial_cum_vaccinated[i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_pn_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_pn_2; ++j) {
      internal->initial_cum_vaccinated_pn[i - 1 + internal->dim_cum_vaccinated_pn_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_screen_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_screen_2; ++j) {
      internal->initial_cum_vaccinated_screen[i - 1 + internal->dim_cum_vaccinated_screen_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      internal->initial_cum_vbe[i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = 0;
    }
  }
  internal->offset_output_lambda = internal->dim_eta + internal->dim_N + internal->dim_prop_C_hesgroup + 3;
  internal->offset_output_notifiedandattended = internal->dim_eta + internal->dim_lambda + internal->dim_N + internal->dim_phi + internal->dim_prop_C_hesgroup + 3;
  internal->offset_output_phi = internal->dim_eta + internal->dim_lambda + internal->dim_N + internal->dim_prop_C_hesgroup + 3;
  internal->offset_output_prop_C_hesriskgroup = internal->dim_eta + internal->dim_lambda + internal->dim_N + internal->dim_notifiedandattended + internal->dim_phi + internal->dim_prop_C_hesgroup + 3;
  internal->offset_variable_A = internal->dim_I + internal->dim_U;
  internal->offset_variable_cum_diag_a = internal->dim_A + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_diag_s = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_entrants = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_pn + internal->dim_cum_offered_vbe + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_pn + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_incid = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered_pn = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_pn + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_pn + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_screened = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_treated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated_pn = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_pn + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated_screen = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_pn + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_pn + internal->dim_cum_vaccinated_screen + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_S = internal->dim_A + internal->dim_I + internal->dim_U;
  internal->offset_variable_T = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_U;
  internal->S0 = (double*) user_get_array(user, false, internal->S0, "S0", NA_REAL, NA_REAL, 2, internal->dim_S0_1, internal->dim_S0_2);
  internal->T0 = (double*) user_get_array(user, false, internal->T0, "T0", NA_REAL, NA_REAL, 2, internal->dim_T0_1, internal->dim_T0_2);
  internal->u_d = (double*) user_get_array(user, false, internal->u_d, "u_d", NA_REAL, NA_REAL, 3, internal->dim_u_d_1, internal->dim_u_d_2, internal->dim_u_d_3);
  internal->u_pn = (double*) user_get_array(user, false, internal->u_pn, "u_pn", NA_REAL, NA_REAL, 3, internal->dim_u_pn_1, internal->dim_u_pn_2, internal->dim_u_pn_3);
  internal->u_s = (double*) user_get_array(user, false, internal->u_s, "u_s", NA_REAL, NA_REAL, 3, internal->dim_u_s_1, internal->dim_u_s_2, internal->dim_u_s_3);
  internal->U0 = (double*) user_get_array(user, false, internal->U0, "U0", NA_REAL, NA_REAL, 2, internal->dim_U0_1, internal->dim_U0_2);
  internal->vbe = (double*) user_get_array(user, false, internal->vbe, "vbe", NA_REAL, NA_REAL, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  internal->vod = (double*) user_get_array(user, false, internal->vod, "vod", NA_REAL, NA_REAL, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  internal->vopn = (double*) user_get_array(user, false, internal->vopn, "vopn", NA_REAL, NA_REAL, 3, internal->dim_vopn_1, internal->dim_vopn_2, internal->dim_vopn_3);
  internal->vos = (double*) user_get_array(user, false, internal->vos, "vos", NA_REAL, NA_REAL, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  internal->w = (double*) user_get_array(user, false, internal->w, "w", NA_REAL, NA_REAL, 2, internal->dim_w_1, internal->dim_w_2);
  internal->wd = (double*) user_get_array(user, false, internal->wd, "wd", NA_REAL, NA_REAL, 2, internal->dim_wd_1, internal->dim_wd_2);
  for (int i = 1; i <= internal->dim_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_entrants_2; ++j) {
      internal->entrants[i - 1 + internal->dim_entrants_1 * (j - 1)] = internal->enr * internal->q[i - 1] * internal->willing[j - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      internal->initial_A[i - 1 + internal->dim_A_1 * (j - 1)] = internal->A0[internal->dim_A0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      internal->initial_I[i - 1 + internal->dim_I_1 * (j - 1)] = internal->I0[internal->dim_I0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1)] = internal->S0[internal->dim_S0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      internal->initial_T[i - 1 + internal->dim_T_1 * (j - 1)] = internal->T0[internal->dim_T0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      internal->initial_U[i - 1 + internal->dim_U_1 * (j - 1)] = internal->U0[internal->dim_U0_1 * (j - 1) + i - 1];
    }
  }
  interpolate_check_y(internal->dim_tt, internal->dim_beta_t, 0, "beta_t", "beta");
  cinterpolate_free(internal->interpolate_beta);
  internal->interpolate_beta = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->beta_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_h_t, 0, "eta_h_t", "eta_h");
  cinterpolate_free(internal->interpolate_eta_h);
  internal->interpolate_eta_h = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_h_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_l_t, 0, "eta_l_t", "eta_l");
  cinterpolate_free(internal->interpolate_eta_l);
  internal->interpolate_eta_l = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_l_t, true, false);
  for (int i = 1; i <= internal->dim_n_obe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_obe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_obe_3; ++k) {
        internal->n_obe[i - 1 + internal->dim_n_obe_1 * (j - 1) + internal->dim_n_obe_12 * (k - 1)] = internal->vbe[internal->dim_vbe_12 * (k - 1) + internal->dim_vbe_1 * (j - 1) + i - 1] * internal->entrants[internal->dim_entrants_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vbe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vbe_3; ++k) {
        internal->n_vbe[i - 1 + internal->dim_n_vbe_1 * (j - 1) + internal->dim_n_vbe_12 * (k - 1)] = internal->n_obe[internal->dim_n_obe_12 * (k - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1] * internal->u_vbe;
      }
    }
  }
  return R_NilValue;
}
SEXP model_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_use_dde_ptr) {
  return R_NilValue;
}
SEXP model_metadata(SEXP internal_p) {
  model_internal *internal = model_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 18));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 18));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, allocVector(INTSXP, 2));
  int * dim_U = INTEGER(VECTOR_ELT(variable_length, 0));
  dim_U[0] = internal->dim_U_1;
  dim_U[1] = internal->dim_U_2;
  SET_VECTOR_ELT(variable_length, 1, allocVector(INTSXP, 2));
  int * dim_I = INTEGER(VECTOR_ELT(variable_length, 1));
  dim_I[0] = internal->dim_I_1;
  dim_I[1] = internal->dim_I_2;
  SET_VECTOR_ELT(variable_length, 2, allocVector(INTSXP, 2));
  int * dim_A = INTEGER(VECTOR_ELT(variable_length, 2));
  dim_A[0] = internal->dim_A_1;
  dim_A[1] = internal->dim_A_2;
  SET_VECTOR_ELT(variable_length, 3, allocVector(INTSXP, 2));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 3));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  SET_VECTOR_ELT(variable_length, 4, allocVector(INTSXP, 2));
  int * dim_T = INTEGER(VECTOR_ELT(variable_length, 4));
  dim_T[0] = internal->dim_T_1;
  dim_T[1] = internal->dim_T_2;
  SET_VECTOR_ELT(variable_length, 5, allocVector(INTSXP, 2));
  int * dim_cum_incid = INTEGER(VECTOR_ELT(variable_length, 5));
  dim_cum_incid[0] = internal->dim_cum_incid_1;
  dim_cum_incid[1] = internal->dim_cum_incid_2;
  SET_VECTOR_ELT(variable_length, 6, allocVector(INTSXP, 2));
  int * dim_cum_diag_a = INTEGER(VECTOR_ELT(variable_length, 6));
  dim_cum_diag_a[0] = internal->dim_cum_diag_a_1;
  dim_cum_diag_a[1] = internal->dim_cum_diag_a_2;
  SET_VECTOR_ELT(variable_length, 7, allocVector(INTSXP, 2));
  int * dim_cum_diag_s = INTEGER(VECTOR_ELT(variable_length, 7));
  dim_cum_diag_s[0] = internal->dim_cum_diag_s_1;
  dim_cum_diag_s[1] = internal->dim_cum_diag_s_2;
  SET_VECTOR_ELT(variable_length, 8, allocVector(INTSXP, 2));
  int * dim_cum_treated = INTEGER(VECTOR_ELT(variable_length, 8));
  dim_cum_treated[0] = internal->dim_cum_treated_1;
  dim_cum_treated[1] = internal->dim_cum_treated_2;
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 2));
  int * dim_cum_screened = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_cum_screened[0] = internal->dim_cum_screened_1;
  dim_cum_screened[1] = internal->dim_cum_screened_2;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 2));
  int * dim_cum_offered = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_cum_offered[0] = internal->dim_cum_offered_1;
  dim_cum_offered[1] = internal->dim_cum_offered_2;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_cum_vaccinated[0] = internal->dim_cum_vaccinated_1;
  dim_cum_vaccinated[1] = internal->dim_cum_vaccinated_2;
  SET_VECTOR_ELT(variable_length, 12, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated_screen = INTEGER(VECTOR_ELT(variable_length, 12));
  dim_cum_vaccinated_screen[0] = internal->dim_cum_vaccinated_screen_1;
  dim_cum_vaccinated_screen[1] = internal->dim_cum_vaccinated_screen_2;
  SET_VECTOR_ELT(variable_length, 13, allocVector(INTSXP, 2));
  int * dim_cum_offered_pn = INTEGER(VECTOR_ELT(variable_length, 13));
  dim_cum_offered_pn[0] = internal->dim_cum_offered_pn_1;
  dim_cum_offered_pn[1] = internal->dim_cum_offered_pn_2;
  SET_VECTOR_ELT(variable_length, 14, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated_pn = INTEGER(VECTOR_ELT(variable_length, 14));
  dim_cum_vaccinated_pn[0] = internal->dim_cum_vaccinated_pn_1;
  dim_cum_vaccinated_pn[1] = internal->dim_cum_vaccinated_pn_2;
  SET_VECTOR_ELT(variable_length, 15, allocVector(INTSXP, 2));
  int * dim_cum_vbe = INTEGER(VECTOR_ELT(variable_length, 15));
  dim_cum_vbe[0] = internal->dim_cum_vbe_1;
  dim_cum_vbe[1] = internal->dim_cum_vbe_2;
  SET_VECTOR_ELT(variable_length, 16, allocVector(INTSXP, 2));
  int * dim_cum_offered_vbe = INTEGER(VECTOR_ELT(variable_length, 16));
  dim_cum_offered_vbe[0] = internal->dim_cum_offered_vbe_1;
  dim_cum_offered_vbe[1] = internal->dim_cum_offered_vbe_2;
  SET_VECTOR_ELT(variable_length, 17, allocVector(INTSXP, 2));
  int * dim_cum_entrants = INTEGER(VECTOR_ELT(variable_length, 17));
  dim_cum_entrants[0] = internal->dim_cum_entrants_1;
  dim_cum_entrants[1] = internal->dim_cum_entrants_2;
  SET_STRING_ELT(variable_names, 0, mkChar("U"));
  SET_STRING_ELT(variable_names, 1, mkChar("I"));
  SET_STRING_ELT(variable_names, 2, mkChar("A"));
  SET_STRING_ELT(variable_names, 3, mkChar("S"));
  SET_STRING_ELT(variable_names, 4, mkChar("T"));
  SET_STRING_ELT(variable_names, 5, mkChar("cum_incid"));
  SET_STRING_ELT(variable_names, 6, mkChar("cum_diag_a"));
  SET_STRING_ELT(variable_names, 7, mkChar("cum_diag_s"));
  SET_STRING_ELT(variable_names, 8, mkChar("cum_treated"));
  SET_STRING_ELT(variable_names, 9, mkChar("cum_screened"));
  SET_STRING_ELT(variable_names, 10, mkChar("cum_offered"));
  SET_STRING_ELT(variable_names, 11, mkChar("cum_vaccinated"));
  SET_STRING_ELT(variable_names, 12, mkChar("cum_vaccinated_screen"));
  SET_STRING_ELT(variable_names, 13, mkChar("cum_offered_pn"));
  SET_STRING_ELT(variable_names, 14, mkChar("cum_vaccinated_pn"));
  SET_STRING_ELT(variable_names, 15, mkChar("cum_vbe"));
  SET_STRING_ELT(variable_names, 16, mkChar("cum_offered_vbe"));
  SET_STRING_ELT(variable_names, 17, mkChar("cum_entrants"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 10));
  SEXP output_names = PROTECT(allocVector(STRSXP, 10));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, R_NilValue);
  SET_VECTOR_ELT(output_length, 3, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(output_length, 4, ScalarInteger(internal->dim_prop_C_hesgroup));
  SET_VECTOR_ELT(output_length, 5, allocVector(INTSXP, 2));
  int * dim_N = INTEGER(VECTOR_ELT(output_length, 5));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  SET_VECTOR_ELT(output_length, 6, allocVector(INTSXP, 2));
  int * dim_lambda = INTEGER(VECTOR_ELT(output_length, 6));
  dim_lambda[0] = internal->dim_lambda_1;
  dim_lambda[1] = internal->dim_lambda_2;
  SET_VECTOR_ELT(output_length, 7, allocVector(INTSXP, 2));
  int * dim_phi = INTEGER(VECTOR_ELT(output_length, 7));
  dim_phi[0] = internal->dim_phi_1;
  dim_phi[1] = internal->dim_phi_2;
  SET_VECTOR_ELT(output_length, 8, allocVector(INTSXP, 2));
  int * dim_notifiedandattended = INTEGER(VECTOR_ELT(output_length, 8));
  dim_notifiedandattended[0] = internal->dim_notifiedandattended_1;
  dim_notifiedandattended[1] = internal->dim_notifiedandattended_2;
  SET_VECTOR_ELT(output_length, 9, allocVector(INTSXP, 2));
  int * dim_prop_C_hesriskgroup = INTEGER(VECTOR_ELT(output_length, 9));
  dim_prop_C_hesriskgroup[0] = internal->dim_prop_C_hesriskgroup_1;
  dim_prop_C_hesriskgroup[1] = internal->dim_prop_C_hesriskgroup_2;
  SET_STRING_ELT(output_names, 0, mkChar("tot_treated"));
  SET_STRING_ELT(output_names, 1, mkChar("tot_attended"));
  SET_STRING_ELT(output_names, 2, mkChar("beta"));
  SET_STRING_ELT(output_names, 3, mkChar("eta"));
  SET_STRING_ELT(output_names, 4, mkChar("prop_C_hesgroup"));
  SET_STRING_ELT(output_names, 5, mkChar("N"));
  SET_STRING_ELT(output_names, 6, mkChar("lambda"));
  SET_STRING_ELT(output_names, 7, mkChar("phi"));
  SET_STRING_ELT(output_names, 8, mkChar("notifiedandattended"));
  SET_STRING_ELT(output_names, 9, mkChar("prop_C_hesriskgroup"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(internal->dim_eta + internal->dim_lambda + internal->dim_N + internal->dim_notifiedandattended + internal->dim_phi + internal->dim_prop_C_hesgroup + internal->dim_prop_C_hesriskgroup + 3));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(fmax(internal->tt[0], internal->vax_t[0])));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(internal->tt[internal->dim_tt - 1]));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP model_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  model_internal *internal = model_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_entrants + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_pn + internal->dim_cum_offered_vbe + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_pn + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_U, internal->dim_U * sizeof(double));
  memcpy(state + internal->dim_U, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_A, internal->initial_A, internal->dim_A * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_T, internal->initial_T, internal->dim_T * sizeof(double));
  memcpy(state + internal->offset_variable_cum_incid, internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_a, internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_s, internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  memcpy(state + internal->offset_variable_cum_treated, internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_screened, internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered, internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated, internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated_screen, internal->initial_cum_vaccinated_screen, internal->dim_cum_vaccinated_screen * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered_pn, internal->initial_cum_offered_pn, internal->dim_cum_offered_pn * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated_pn, internal->initial_cum_vaccinated_pn, internal->dim_cum_vaccinated_pn * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vbe, internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered_vbe, internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  memcpy(state + internal->offset_variable_cum_entrants, internal->initial_cum_entrants, internal->dim_cum_entrants * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void model_rhs(model_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double vax_switch = 0.0;
  cinterpolate_eval(t, internal->interpolate_vax_switch, &vax_switch);
  for (int i = 1; i <= internal->dim_Up; ++i) {
    internal->Up[i - 1] = odin_sum2(U, i - 1, i, 0, internal->dim_U_2, internal->dim_U_1) * internal->p[i - 1];
  }
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AU_2; ++j) {
      internal->n_AU[i - 1 + internal->dim_n_AU_1 * (j - 1)] = (internal->mu == 0 ? internal->nu * A[internal->dim_A_1 * (j - 1) + i - 1] : (internal->nu * internal->mu) / (double) ((internal->ved[j - 1] * internal->nu + (1 - internal->ved[j - 1]) * internal->mu)) * A[internal->dim_A_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_ST_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ST_2; ++j) {
      internal->n_ST[i - 1 + internal->dim_n_ST_1 * (j - 1)] = internal->mu * S[internal->dim_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_TU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_TU_2; ++j) {
      internal->n_TU[i - 1 + internal->dim_n_TU_1 * (j - 1)] = internal->rho * T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_omega_U_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_U_2; ++j) {
      internal->omega_U[i - 1 + internal->dim_omega_U_1 * (j - 1)] = (1 - internal->epsilon) * internal->Up[j - 1] / (double) odin_sum1(internal->Up, 0, internal->dim_Up) + ((i == j ? internal->epsilon : 0));
    }
  }
  for (int i = 1; i <= internal->dim_prop_UUsubgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_prop_UUsubgroup_2; ++j) {
      internal->prop_UUsubgroup[i - 1 + internal->dim_prop_UUsubgroup_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] / (double) odin_sum2(U, i - 1, i, 0, internal->dim_U_2, internal->dim_U_1);
    }
  }
  for (int i = 1; i <= internal->dim_wA_1; ++i) {
    for (int j = 1; j <= internal->dim_wA_2; ++j) {
      for (int k = 1; k <= internal->dim_wA_3; ++k) {
        internal->wA[i - 1 + internal->dim_wA_1 * (j - 1) + internal->dim_wA_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdA_1; ++i) {
    for (int j = 1; j <= internal->dim_wdA_2; ++j) {
      for (int k = 1; k <= internal->dim_wdA_3; ++k) {
        internal->wdA[i - 1 + internal->dim_wdA_1 * (j - 1) + internal->dim_wdA_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdI_1; ++i) {
    for (int j = 1; j <= internal->dim_wdI_2; ++j) {
      for (int k = 1; k <= internal->dim_wdI_3; ++k) {
        internal->wdI[i - 1 + internal->dim_wdI_1 * (j - 1) + internal->dim_wdI_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdS_1; ++i) {
    for (int j = 1; j <= internal->dim_wdS_2; ++j) {
      for (int k = 1; k <= internal->dim_wdS_3; ++k) {
        internal->wdS[i - 1 + internal->dim_wdS_1 * (j - 1) + internal->dim_wdS_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdT_1; ++i) {
    for (int j = 1; j <= internal->dim_wdT_2; ++j) {
      for (int k = 1; k <= internal->dim_wdT_3; ++k) {
        internal->wdT[i - 1 + internal->dim_wdT_1 * (j - 1) + internal->dim_wdT_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdU_1; ++i) {
    for (int j = 1; j <= internal->dim_wdU_2; ++j) {
      for (int k = 1; k <= internal->dim_wdU_3; ++k) {
        internal->wdU[i - 1 + internal->dim_wdU_1 * (j - 1) + internal->dim_wdU_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wI_1; ++i) {
    for (int j = 1; j <= internal->dim_wI_2; ++j) {
      for (int k = 1; k <= internal->dim_wI_3; ++k) {
        internal->wI[i - 1 + internal->dim_wI_1 * (j - 1) + internal->dim_wI_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wS_1; ++i) {
    for (int j = 1; j <= internal->dim_wS_2; ++j) {
      for (int k = 1; k <= internal->dim_wS_3; ++k) {
        internal->wS[i - 1 + internal->dim_wS_1 * (j - 1) + internal->dim_wS_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wT_1; ++i) {
    for (int j = 1; j <= internal->dim_wT_2; ++j) {
      for (int k = 1; k <= internal->dim_wT_3; ++k) {
        internal->wT[i - 1 + internal->dim_wT_1 * (j - 1) + internal->dim_wT_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wU_1; ++i) {
    for (int j = 1; j <= internal->dim_wU_2; ++j) {
      for (int k = 1; k <= internal->dim_wU_3; ++k) {
        internal->wU[i - 1 + internal->dim_wU_1 * (j - 1) + internal->dim_wU_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  for (int i = 1; i <= internal->dim_C_hesgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_C_hesgroup_2; ++j) {
      for (int k = 1; k <= internal->dim_C_hesgroup_3; ++k) {
        internal->C_hesgroup[i - 1 + internal->dim_C_hesgroup_1 * (j - 1) + internal->dim_C_hesgroup_12 * (k - 1)] = internal->C[internal->dim_C_1 * (j - 1) + i - 1] * internal->hesgroupmatrix[internal->dim_hesgroupmatrix_1 * (k - 1) + j - 1] * internal->p[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_s + i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_entrants_2; ++j) {
      dstatedt[internal->offset_variable_cum_entrants + i - 1 + internal->dim_cum_entrants_1 * (j - 1)] = internal->entrants[internal->dim_entrants_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      dstatedt[internal->offset_variable_cum_treated + i - 1 + internal->dim_cum_treated_1 * (j - 1)] = internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      dstatedt[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1)] = (1 - internal->ves[j - 1]) * internal->psi * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] - internal->exr * S[internal->dim_S_1 * (j - 1) + i - 1] + odin_sum3(internal->wS, i - 1, i, j - 1, j, 0, internal->dim_wS_3, internal->dim_wS_1, internal->dim_wS_12) + odin_sum3(internal->wdS, i - 1, i, j - 1, j, 0, internal->dim_wdS_3, internal->dim_wdS_1, internal->dim_wdS_12);
    }
  }
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_n_diag_rec_1; ++i) {
    for (int j = 1; j <= internal->dim_n_diag_rec_2; ++j) {
      for (int k = 1; k <= internal->dim_n_diag_rec_3; ++k) {
        internal->n_diag_rec[i - 1 + internal->dim_n_diag_rec_1 * (j - 1) + internal->dim_n_diag_rec_12 * (k - 1)] = internal->diag_rec[internal->dim_diag_rec_12 * (k - 1) + internal->dim_diag_rec_1 * (j - 1) + i - 1] * internal->n_TU[internal->dim_n_TU_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_N_hesgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_N_hesgroup_2; ++j) {
      for (int k = 1; k <= internal->dim_N_hesgroup_3; ++k) {
        internal->N_hesgroup[i - 1 + internal->dim_N_hesgroup_1 * (j - 1) + internal->dim_N_hesgroup_12 * (k - 1)] = internal->N[internal->dim_N_1 * (j - 1) + i - 1] * internal->hesgroupmatrix[internal->dim_hesgroupmatrix_1 * (k - 1) + j - 1] * internal->p[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_ood_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ood_2; ++j) {
      for (int k = 1; k <= internal->dim_n_ood_3; ++k) {
        internal->n_ood[i - 1 + internal->dim_n_ood_1 * (j - 1) + internal->dim_n_ood_12 * (k - 1)] = internal->vod[internal->dim_vod_12 * (k - 1) + internal->dim_vod_1 * (j - 1) + i - 1] * internal->n_TU[internal->dim_n_TU_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered_vbe + i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1];
    }
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  for (int i = 1; i <= internal->dim_n_vod_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vod_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vod_3; ++k) {
        internal->n_vod[i - 1 + internal->dim_n_vod_1 * (j - 1) + internal->dim_n_vod_12 * (k - 1)] = internal->n_ood[internal->dim_n_ood_12 * (k - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] * internal->u_d[internal->dim_u_d_12 * (k - 1) + internal->dim_u_d_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_prop_C_hesgroup; ++i) {
    internal->prop_C_hesgroup[i - 1] = odin_sum3(internal->C_hesgroup, 0, internal->dim_C_hesgroup_1, 0, internal->dim_C_hesgroup_2, i - 1, i, internal->dim_C_hesgroup_1, internal->dim_C_hesgroup_12) / (double) odin_sum3(internal->N_hesgroup, 0, internal->dim_N_hesgroup_1, 0, internal->dim_N_hesgroup_2, i - 1, i, internal->dim_N_hesgroup_1, internal->dim_N_hesgroup_12);
  }
  for (int i = 1; i <= internal->dim_prop_C_hesriskgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_prop_C_hesriskgroup_2; ++j) {
      internal->prop_C_hesriskgroup[i - 1 + internal->dim_prop_C_hesriskgroup_1 * (j - 1)] = odin_sum3(internal->C_hesgroup, i - 1, i, 0, internal->dim_C_hesgroup_2, j - 1, j, internal->dim_C_hesgroup_1, internal->dim_C_hesgroup_12) / (double) odin_sum3(internal->N_hesgroup, i - 1, i, 0, internal->dim_N_hesgroup_2, j - 1, j, internal->dim_N_hesgroup_1, internal->dim_N_hesgroup_12);
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_vbe + i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_lambda_1; ++i) {
    for (int j = 1; j <= internal->dim_lambda_2; ++j) {
      internal->lambda[i - 1 + internal->dim_lambda_1 * (j - 1)] = internal->p[i - 1] * beta * (internal->epsilon * internal->epsilon_hes * internal->prop_C_hesriskgroup[internal->dim_prop_C_hesriskgroup_1 * (j - 1) + i - 1] + internal->epsilon * (1 - internal->epsilon_hes) * internal->prop_C[i - 1] + (1 - internal->epsilon) * internal->epsilon_hes * internal->prop_C_hesgroup[j - 1] + (1 - internal->epsilon) * (1 - internal->epsilon_hes) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
    }
  }
  for (int i = 1; i <= internal->dim_n_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AT_2; ++j) {
      internal->n_AT[i - 1 + internal->dim_n_AT_1 * (j - 1)] = internal->eta[i - 1] * A[internal->dim_A_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_omega_U_withdiag_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_U_withdiag_2; ++j) {
      internal->omega_U_withdiag[i - 1 + internal->dim_omega_U_withdiag_1 * (j - 1)] = internal->omega_U[internal->dim_omega_U_1 * (j - 1) + i - 1] * (internal->mu * odin_sum2(S, i - 1, i, 0, internal->dim_S_2, internal->dim_S_1) + internal->eta[i - 1] * odin_sum2(A, i - 1, i, 0, internal->dim_A_2, internal->dim_A_1));
    }
  }
  for (int i = 1; i <= internal->dim_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_screened_2; ++j) {
      internal->screened[i - 1 + internal->dim_screened_1 * (j - 1)] = internal->eta[i - 1] * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      dstatedt[internal->offset_variable_A + i - 1 + internal->dim_A_1 * (j - 1)] = (1 - (1 - internal->ves[j - 1]) * internal->psi) * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] - internal->exr * A[internal->dim_A_1 * (j - 1) + i - 1] + odin_sum3(internal->wA, i - 1, i, j - 1, j, 0, internal->dim_wA_3, internal->dim_wA_1, internal->dim_wA_12) + odin_sum3(internal->wdA, i - 1, i, j - 1, j, 0, internal->dim_wdA_3, internal->dim_wdA_1, internal->dim_wdA_12);
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_a + i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      dstatedt[internal->offset_variable_cum_screened + i - 1 + internal->dim_cum_screened_1 * (j - 1)] = internal->screened[internal->dim_screened_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      dstatedt[internal->offset_variable_T + i - 1 + internal->dim_T_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->exr * T[internal->dim_T_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wT, i - 1, i, j - 1, j, 0, internal->dim_wT_3, internal->dim_wT_1, internal->dim_wT_12) + odin_sum3(internal->wdT, i - 1, i, j - 1, j, 0, internal->dim_wdT_3, internal->dim_wdT_1, internal->dim_wdT_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_oos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_oos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_oos_3; ++k) {
        internal->n_oos[i - 1 + internal->dim_n_oos_1 * (j - 1) + internal->dim_n_oos_12 * (k - 1)] = internal->vos[internal->dim_vos_12 * (k - 1) + internal->dim_vos_1 * (j - 1) + i - 1] * internal->screened[internal->dim_screened_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_UI_1; ++i) {
    for (int j = 1; j <= internal->dim_n_UI_2; ++j) {
      internal->n_UI[i - 1 + internal->dim_n_UI_1 * (j - 1)] = internal->lambda[internal->dim_lambda_1 * (j - 1) + i - 1] * (1 - internal->vea[j - 1]) * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_omega_U_withdiag_rg; ++i) {
    internal->omega_U_withdiag_rg[i - 1] = odin_sum2(internal->omega_U_withdiag, 0, internal->dim_omega_U_withdiag_1, i - 1, i, internal->dim_omega_U_withdiag_1);
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      dstatedt[internal->offset_variable_cum_incid + i - 1 + internal->dim_cum_incid_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      dstatedt[internal->dim_U + i - 1 + internal->dim_I_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - (internal->sigma + internal->exr) * I[internal->dim_I_1 * (j - 1) + i - 1] + odin_sum3(internal->wI, i - 1, i, j - 1, j, 0, internal->dim_wI_3, internal->dim_wI_1, internal->dim_wI_12) + odin_sum3(internal->wdI, i - 1, i, j - 1, j, 0, internal->dim_wdI_3, internal->dim_wdI_1, internal->dim_wdI_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_vos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vos_3; ++k) {
        internal->n_vos[i - 1 + internal->dim_n_vos_1 * (j - 1) + internal->dim_n_vos_12 * (k - 1)] = internal->n_oos[internal->dim_n_oos_12 * (k - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] * internal->u_s[internal->dim_u_s_12 * (k - 1) + internal->dim_u_s_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_phi_1; ++i) {
    for (int j = 1; j <= internal->dim_phi_2; ++j) {
      internal->phi[i - 1 + internal->dim_phi_1 * (j - 1)] = (1 - internal->notifiedprev) * internal->kappa * internal->omega_U_withdiag_rg[i - 1] * internal->prop_UUsubgroup[internal->dim_prop_UUsubgroup_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_screen_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_screen_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated_screen + i - 1 + internal->dim_cum_vaccinated_screen_1 * (j - 1)] = internal->n_vos[internal->dim_n_vos_12 * (j - 1) + internal->dim_n_vos_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_oopn_1; ++i) {
    for (int j = 1; j <= internal->dim_n_oopn_2; ++j) {
      for (int k = 1; k <= internal->dim_n_oopn_3; ++k) {
        internal->n_oopn[i - 1 + internal->dim_n_oopn_1 * (j - 1) + internal->dim_n_oopn_12 * (k - 1)] = internal->vopn[internal->dim_vopn_12 * (k - 1) + internal->dim_vopn_1 * (j - 1) + i - 1] * internal->phi[internal->dim_phi_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered + i - 1 + internal->dim_cum_offered_1 * (j - 1)] = internal->n_oos[internal->dim_n_oos_12 * (j - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] + internal->n_ood[internal->dim_n_ood_12 * (j - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] + internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1] + internal->n_oopn[internal->dim_n_oopn_12 * (j - 1) + internal->dim_n_oopn_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_pn_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_pn_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered_pn + i - 1 + internal->dim_cum_offered_pn_1 * (j - 1)] = internal->n_oopn[internal->dim_n_oopn_12 * (j - 1) + internal->dim_n_oopn_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_vopn_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vopn_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vopn_3; ++k) {
        internal->n_vopn[i - 1 + internal->dim_n_vopn_1 * (j - 1) + internal->dim_n_vopn_12 * (k - 1)] = internal->n_oopn[internal->dim_n_oopn_12 * (k - 1) + internal->dim_n_oopn_1 * (j - 1) + i - 1] * internal->u_pn[internal->dim_u_pn_12 * (k - 1) + internal->dim_u_pn_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated + i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = internal->n_vos[internal->dim_n_vos_12 * (j - 1) + internal->dim_n_vos_1 * (j - 1) + i - 1] + internal->n_vod[internal->dim_n_vod_12 * (j - 1) + internal->dim_n_vod_1 * (j - 1) + i - 1] + internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1] + internal->n_vopn[internal->dim_n_vopn_12 * (j - 1) + internal->dim_n_vopn_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_pn_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_pn_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated_pn + i - 1 + internal->dim_cum_vaccinated_pn_1 * (j - 1)] = internal->n_vopn[internal->dim_n_vopn_12 * (j - 1) + internal->dim_n_vopn_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      dstatedt[0 + i - 1 + internal->dim_U_1 * (j - 1)] = internal->entrants[internal->dim_entrants_1 * (j - 1) + i - 1] - internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - internal->exr * U[internal->dim_U_1 * (j - 1) + i - 1] + internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] - odin_sum3(internal->n_diag_rec, i - 1, i, j - 1, j, 0, internal->dim_n_diag_rec_3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_12) + odin_sum3(internal->wU, i - 1, i, j - 1, j, 0, internal->dim_wU_3, internal->dim_wU_1, internal->dim_wU_12) - odin_sum3(internal->n_vbe, i - 1, i, j - 1, j, 0, internal->dim_n_vbe_3, internal->dim_n_vbe_1, internal->dim_n_vbe_12) - odin_sum3(internal->n_vod, i - 1, i, j - 1, j, 0, internal->dim_n_vod_3, internal->dim_n_vod_1, internal->dim_n_vod_12) - odin_sum3(internal->n_vos, i - 1, i, j - 1, j, 0, internal->dim_n_vos_3, internal->dim_n_vos_1, internal->dim_n_vos_12) - odin_sum3(internal->n_vopn, i - 1, i, j - 1, j, 0, internal->dim_n_vopn_3, internal->dim_n_vopn_1, internal->dim_n_vopn_12) + odin_sum3(internal->wdU, i - 1, i, j - 1, j, 0, internal->dim_wdU_3, internal->dim_wdU_1, internal->dim_wdU_12);
    }
  }
  if (output) {
    double * cum_treated = state + internal->offset_variable_cum_treated;
    double * cum_screened = state + internal->offset_variable_cum_screened;
    output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
    output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
    for (int i = 1; i <= internal->dim_Cp; ++i) {
      internal->Cp[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) * internal->p[i - 1];
    }
    memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
    for (int i = 1; i <= internal->dim_prop_CCsubgroup_1; ++i) {
      for (int j = 1; j <= internal->dim_prop_CCsubgroup_2; ++j) {
        internal->prop_CCsubgroup[i - 1 + internal->dim_prop_CCsubgroup_1 * (j - 1)] = internal->C[internal->dim_C_1 * (j - 1) + i - 1] / (double) odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1);
      }
    }
    for (int i = 1; i <= internal->dim_omega_C_1; ++i) {
      for (int j = 1; j <= internal->dim_omega_C_2; ++j) {
        internal->omega_C[i - 1 + internal->dim_omega_C_1 * (j - 1)] = (1 - internal->epsilon) * internal->Cp[j - 1] / (double) odin_sum1(internal->Cp, 0, internal->dim_Cp) + ((i == j ? internal->epsilon : 0));
      }
    }
    output[2] = beta;
    for (int i = 1; i <= internal->dim_omega_C_withdiag_1; ++i) {
      for (int j = 1; j <= internal->dim_omega_C_withdiag_2; ++j) {
        internal->omega_C_withdiag[i - 1 + internal->dim_omega_C_withdiag_1 * (j - 1)] = internal->omega_C[internal->dim_omega_C_1 * (j - 1) + i - 1] * (internal->mu * odin_sum2(S, i - 1, i, 0, internal->dim_S_2, internal->dim_S_1) + internal->eta[i - 1] * odin_sum2(A, i - 1, i, 0, internal->dim_A_2, internal->dim_A_1));
      }
    }
    memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
    memcpy(output + internal->offset_output_prop_C_hesgroup, internal->prop_C_hesgroup, internal->dim_prop_C_hesgroup * sizeof(double));
    memcpy(output + internal->offset_output_prop_C_hesriskgroup, internal->prop_C_hesriskgroup, internal->dim_prop_C_hesriskgroup * sizeof(double));
    for (int i = 1; i <= internal->dim_omega_C_withdiag_rg; ++i) {
      internal->omega_C_withdiag_rg[i - 1] = odin_sum2(internal->omega_C_withdiag, 0, internal->dim_omega_C_withdiag_1, i - 1, i, internal->dim_omega_C_withdiag_1);
    }
    memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
    for (int i = 1; i <= internal->dim_xi_1; ++i) {
      for (int j = 1; j <= internal->dim_xi_2; ++j) {
        internal->xi[i - 1 + internal->dim_xi_1 * (j - 1)] = internal->notifiedprev * internal->kappa * internal->omega_C_withdiag_rg[i - 1] * internal->prop_CCsubgroup[internal->dim_prop_CCsubgroup_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 1; i <= internal->dim_notifiedandattended_1; ++i) {
      for (int j = 1; j <= internal->dim_notifiedandattended_2; ++j) {
        internal->notifiedandattended[i - 1 + internal->dim_notifiedandattended_1 * (j - 1)] = (internal->phi[internal->dim_phi_1 * (j - 1) + i - 1] + internal->xi[internal->dim_xi_1 * (j - 1) + i - 1] > 0 ? internal->phi[internal->dim_phi_1 * (j - 1) + i - 1] + internal->xi[internal->dim_xi_1 * (j - 1) + i - 1] : 0);
      }
    }
    memcpy(output + internal->offset_output_phi, internal->phi, internal->dim_phi * sizeof(double));
    memcpy(output + internal->offset_output_notifiedandattended, internal->notifiedandattended, internal->dim_notifiedandattended * sizeof(double));
  }
}
void model_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  model_rhs((model_internal*)internal, t, state, dstatedt, NULL);
}
void model_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  model_rhs(model_internal_ds, *t, state, dstatedt, output);
}
void model_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p) {
  model_internal *internal = (model_internal*) internal_p;
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double * cum_treated = state + internal->offset_variable_cum_treated;
  double * cum_screened = state + internal->offset_variable_cum_screened;
  output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
  output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
  for (int i = 1; i <= internal->dim_Up; ++i) {
    internal->Up[i - 1] = odin_sum2(U, i - 1, i, 0, internal->dim_U_2, internal->dim_U_1) * internal->p[i - 1];
  }
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_omega_U_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_U_2; ++j) {
      internal->omega_U[i - 1 + internal->dim_omega_U_1 * (j - 1)] = (1 - internal->epsilon) * internal->Up[j - 1] / (double) odin_sum1(internal->Up, 0, internal->dim_Up) + ((i == j ? internal->epsilon : 0));
    }
  }
  for (int i = 1; i <= internal->dim_prop_UUsubgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_prop_UUsubgroup_2; ++j) {
      internal->prop_UUsubgroup[i - 1 + internal->dim_prop_UUsubgroup_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] / (double) odin_sum2(U, i - 1, i, 0, internal->dim_U_2, internal->dim_U_1);
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  for (int i = 1; i <= internal->dim_C_hesgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_C_hesgroup_2; ++j) {
      for (int k = 1; k <= internal->dim_C_hesgroup_3; ++k) {
        internal->C_hesgroup[i - 1 + internal->dim_C_hesgroup_1 * (j - 1) + internal->dim_C_hesgroup_12 * (k - 1)] = internal->C[internal->dim_C_1 * (j - 1) + i - 1] * internal->hesgroupmatrix[internal->dim_hesgroupmatrix_1 * (k - 1) + j - 1] * internal->p[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_Cp; ++i) {
    internal->Cp[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) * internal->p[i - 1];
  }
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_N_hesgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_N_hesgroup_2; ++j) {
      for (int k = 1; k <= internal->dim_N_hesgroup_3; ++k) {
        internal->N_hesgroup[i - 1 + internal->dim_N_hesgroup_1 * (j - 1) + internal->dim_N_hesgroup_12 * (k - 1)] = internal->N[internal->dim_N_1 * (j - 1) + i - 1] * internal->hesgroupmatrix[internal->dim_hesgroupmatrix_1 * (k - 1) + j - 1] * internal->p[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  for (int i = 1; i <= internal->dim_prop_CCsubgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_prop_CCsubgroup_2; ++j) {
      internal->prop_CCsubgroup[i - 1 + internal->dim_prop_CCsubgroup_1 * (j - 1)] = internal->C[internal->dim_C_1 * (j - 1) + i - 1] / (double) odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1);
    }
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  for (int i = 1; i <= internal->dim_omega_C_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_C_2; ++j) {
      internal->omega_C[i - 1 + internal->dim_omega_C_1 * (j - 1)] = (1 - internal->epsilon) * internal->Cp[j - 1] / (double) odin_sum1(internal->Cp, 0, internal->dim_Cp) + ((i == j ? internal->epsilon : 0));
    }
  }
  output[2] = beta;
  for (int i = 1; i <= internal->dim_prop_C_hesgroup; ++i) {
    internal->prop_C_hesgroup[i - 1] = odin_sum3(internal->C_hesgroup, 0, internal->dim_C_hesgroup_1, 0, internal->dim_C_hesgroup_2, i - 1, i, internal->dim_C_hesgroup_1, internal->dim_C_hesgroup_12) / (double) odin_sum3(internal->N_hesgroup, 0, internal->dim_N_hesgroup_1, 0, internal->dim_N_hesgroup_2, i - 1, i, internal->dim_N_hesgroup_1, internal->dim_N_hesgroup_12);
  }
  for (int i = 1; i <= internal->dim_prop_C_hesriskgroup_1; ++i) {
    for (int j = 1; j <= internal->dim_prop_C_hesriskgroup_2; ++j) {
      internal->prop_C_hesriskgroup[i - 1 + internal->dim_prop_C_hesriskgroup_1 * (j - 1)] = odin_sum3(internal->C_hesgroup, i - 1, i, 0, internal->dim_C_hesgroup_2, j - 1, j, internal->dim_C_hesgroup_1, internal->dim_C_hesgroup_12) / (double) odin_sum3(internal->N_hesgroup, i - 1, i, 0, internal->dim_N_hesgroup_2, j - 1, j, internal->dim_N_hesgroup_1, internal->dim_N_hesgroup_12);
    }
  }
  for (int i = 1; i <= internal->dim_lambda_1; ++i) {
    for (int j = 1; j <= internal->dim_lambda_2; ++j) {
      internal->lambda[i - 1 + internal->dim_lambda_1 * (j - 1)] = internal->p[i - 1] * beta * (internal->epsilon * internal->epsilon_hes * internal->prop_C_hesriskgroup[internal->dim_prop_C_hesriskgroup_1 * (j - 1) + i - 1] + internal->epsilon * (1 - internal->epsilon_hes) * internal->prop_C[i - 1] + (1 - internal->epsilon) * internal->epsilon_hes * internal->prop_C_hesgroup[j - 1] + (1 - internal->epsilon) * (1 - internal->epsilon_hes) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
    }
  }
  for (int i = 1; i <= internal->dim_omega_C_withdiag_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_C_withdiag_2; ++j) {
      internal->omega_C_withdiag[i - 1 + internal->dim_omega_C_withdiag_1 * (j - 1)] = internal->omega_C[internal->dim_omega_C_1 * (j - 1) + i - 1] * (internal->mu * odin_sum2(S, i - 1, i, 0, internal->dim_S_2, internal->dim_S_1) + internal->eta[i - 1] * odin_sum2(A, i - 1, i, 0, internal->dim_A_2, internal->dim_A_1));
    }
  }
  for (int i = 1; i <= internal->dim_omega_U_withdiag_1; ++i) {
    for (int j = 1; j <= internal->dim_omega_U_withdiag_2; ++j) {
      internal->omega_U_withdiag[i - 1 + internal->dim_omega_U_withdiag_1 * (j - 1)] = internal->omega_U[internal->dim_omega_U_1 * (j - 1) + i - 1] * (internal->mu * odin_sum2(S, i - 1, i, 0, internal->dim_S_2, internal->dim_S_1) + internal->eta[i - 1] * odin_sum2(A, i - 1, i, 0, internal->dim_A_2, internal->dim_A_1));
    }
  }
  memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
  memcpy(output + internal->offset_output_prop_C_hesgroup, internal->prop_C_hesgroup, internal->dim_prop_C_hesgroup * sizeof(double));
  memcpy(output + internal->offset_output_prop_C_hesriskgroup, internal->prop_C_hesriskgroup, internal->dim_prop_C_hesriskgroup * sizeof(double));
  for (int i = 1; i <= internal->dim_omega_C_withdiag_rg; ++i) {
    internal->omega_C_withdiag_rg[i - 1] = odin_sum2(internal->omega_C_withdiag, 0, internal->dim_omega_C_withdiag_1, i - 1, i, internal->dim_omega_C_withdiag_1);
  }
  for (int i = 1; i <= internal->dim_omega_U_withdiag_rg; ++i) {
    internal->omega_U_withdiag_rg[i - 1] = odin_sum2(internal->omega_U_withdiag, 0, internal->dim_omega_U_withdiag_1, i - 1, i, internal->dim_omega_U_withdiag_1);
  }
  memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
  for (int i = 1; i <= internal->dim_phi_1; ++i) {
    for (int j = 1; j <= internal->dim_phi_2; ++j) {
      internal->phi[i - 1 + internal->dim_phi_1 * (j - 1)] = (1 - internal->notifiedprev) * internal->kappa * internal->omega_U_withdiag_rg[i - 1] * internal->prop_UUsubgroup[internal->dim_prop_UUsubgroup_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_xi_1; ++i) {
    for (int j = 1; j <= internal->dim_xi_2; ++j) {
      internal->xi[i - 1 + internal->dim_xi_1 * (j - 1)] = internal->notifiedprev * internal->kappa * internal->omega_C_withdiag_rg[i - 1] * internal->prop_CCsubgroup[internal->dim_prop_CCsubgroup_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_notifiedandattended_1; ++i) {
    for (int j = 1; j <= internal->dim_notifiedandattended_2; ++j) {
      internal->notifiedandattended[i - 1 + internal->dim_notifiedandattended_1 * (j - 1)] = (internal->phi[internal->dim_phi_1 * (j - 1) + i - 1] + internal->xi[internal->dim_xi_1 * (j - 1) + i - 1] > 0 ? internal->phi[internal->dim_phi_1 * (j - 1) + i - 1] + internal->xi[internal->dim_xi_1 * (j - 1) + i - 1] : 0);
    }
  }
  memcpy(output + internal->offset_output_phi, internal->phi, internal->dim_phi * sizeof(double));
  memcpy(output + internal->offset_output_notifiedandattended, internal->notifiedandattended, internal->dim_notifiedandattended * sizeof(double));
}
SEXP model_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  model_internal *internal = model_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, internal->dim_eta + internal->dim_lambda + internal->dim_N + internal->dim_notifiedandattended + internal->dim_phi + internal->dim_prop_C_hesgroup + internal->dim_prop_C_hesriskgroup + 3));
  setAttrib(dstatedt, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  model_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
model_trial_internal* model_trial_get_internal(SEXP internal_p, int closed_error) {
  model_trial_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (model_trial_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void model_trial_finalise(SEXP internal_p) {
  model_trial_internal *internal = model_trial_get_internal(internal_p, 0);
  if (internal_p) {
    R_Free(internal->A0);
    R_Free(internal->diag_rec_a);
    R_Free(internal->diag_rec_s);
    R_Free(internal->I0);
    R_Free(internal->initial_A);
    R_Free(internal->initial_cum_diag_a);
    R_Free(internal->initial_cum_diag_s);
    R_Free(internal->initial_cum_incid);
    R_Free(internal->initial_cum_pye_trial_pov);
    R_Free(internal->initial_cum_pye_true);
    R_Free(internal->initial_cum_screened);
    R_Free(internal->initial_cum_treated);
    R_Free(internal->initial_I);
    R_Free(internal->initial_S);
    R_Free(internal->initial_T);
    R_Free(internal->initial_U);
    R_Free(internal->N);
    R_Free(internal->n_AT);
    R_Free(internal->n_AU);
    R_Free(internal->n_diag_rec);
    R_Free(internal->n_ST);
    R_Free(internal->n_TU);
    R_Free(internal->n_UI);
    R_Free(internal->pye_trial);
    R_Free(internal->S0);
    R_Free(internal->screened);
    R_Free(internal->T0);
    R_Free(internal->U0);
    R_Free(internal->vea);
    R_Free(internal->ved);
    R_Free(internal->ves);
    R_Free(internal->w);
    R_Free(internal->wA);
    R_Free(internal->wI);
    R_Free(internal->wS);
    R_Free(internal->wT);
    R_Free(internal->wU);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP model_trial_create(SEXP user) {
  model_trial_internal *internal = (model_trial_internal*) R_Calloc(1, model_trial_internal);
  internal->A0 = NULL;
  internal->diag_rec_a = NULL;
  internal->diag_rec_s = NULL;
  internal->I0 = NULL;
  internal->initial_A = NULL;
  internal->initial_cum_diag_a = NULL;
  internal->initial_cum_diag_s = NULL;
  internal->initial_cum_incid = NULL;
  internal->initial_cum_pye_trial_pov = NULL;
  internal->initial_cum_pye_true = NULL;
  internal->initial_cum_screened = NULL;
  internal->initial_cum_treated = NULL;
  internal->initial_I = NULL;
  internal->initial_S = NULL;
  internal->initial_T = NULL;
  internal->initial_U = NULL;
  internal->N = NULL;
  internal->n_AT = NULL;
  internal->n_AU = NULL;
  internal->n_diag_rec = NULL;
  internal->n_ST = NULL;
  internal->n_TU = NULL;
  internal->n_UI = NULL;
  internal->pye_trial = NULL;
  internal->S0 = NULL;
  internal->screened = NULL;
  internal->T0 = NULL;
  internal->U0 = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->ves = NULL;
  internal->w = NULL;
  internal->wA = NULL;
  internal->wI = NULL;
  internal->wS = NULL;
  internal->wT = NULL;
  internal->wU = NULL;
  internal->n_group = 2;
  internal->A0 = NULL;
  internal->diag_rec_a = NULL;
  internal->diag_rec_s = NULL;
  internal->eta = NA_REAL;
  internal->I0 = NULL;
  internal->lambda = NA_REAL;
  internal->mu = NA_REAL;
  internal->nu = NA_REAL;
  internal->psi = NA_REAL;
  internal->rho = NA_REAL;
  internal->S0 = NULL;
  internal->sigma = NA_REAL;
  internal->T0 = NULL;
  internal->U0 = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->ves = NULL;
  internal->w = NULL;
  internal->n_vax = 1;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, model_trial_finalise);
  UNPROTECT(1);
  return ptr;
}
static model_trial_internal *model_trial_internal_ds;
void model_trial_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  model_trial_internal_ds = model_trial_get_internal(get_desolve_gparms(), 1);
}
SEXP model_trial_contents(SEXP internal_p) {
  model_trial_internal *internal = model_trial_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 177));
  SEXP A0 = PROTECT(allocVector(REALSXP, internal->dim_A0));
  memcpy(REAL(A0), internal->A0, internal->dim_A0 * sizeof(double));
  odin_set_dim(A0, 2, internal->dim_A0_1, internal->dim_A0_2);
  SET_VECTOR_ELT(contents, 0, A0);
  SEXP diag_rec_a = PROTECT(allocVector(REALSXP, internal->dim_diag_rec_a));
  memcpy(REAL(diag_rec_a), internal->diag_rec_a, internal->dim_diag_rec_a * sizeof(double));
  odin_set_dim(diag_rec_a, 3, internal->dim_diag_rec_a_1, internal->dim_diag_rec_a_2, internal->dim_diag_rec_a_3);
  SET_VECTOR_ELT(contents, 1, diag_rec_a);
  SEXP diag_rec_s = PROTECT(allocVector(REALSXP, internal->dim_diag_rec_s));
  memcpy(REAL(diag_rec_s), internal->diag_rec_s, internal->dim_diag_rec_s * sizeof(double));
  odin_set_dim(diag_rec_s, 3, internal->dim_diag_rec_s_1, internal->dim_diag_rec_s_2, internal->dim_diag_rec_s_3);
  SET_VECTOR_ELT(contents, 2, diag_rec_s);
  SET_VECTOR_ELT(contents, 3, ScalarInteger(internal->dim_A));
  SET_VECTOR_ELT(contents, 4, ScalarInteger(internal->dim_A_1));
  SET_VECTOR_ELT(contents, 5, ScalarInteger(internal->dim_A_2));
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_A0));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_A0_1));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_A0_2));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_cum_diag_a));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_cum_diag_a_1));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_cum_diag_a_2));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_cum_diag_s));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_cum_diag_s_1));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_cum_diag_s_2));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_cum_incid));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_cum_incid_1));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_cum_incid_2));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_cum_pye_trial_pov));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_cum_pye_trial_pov_1));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_cum_pye_trial_pov_2));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_cum_pye_true));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_cum_pye_true_1));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_cum_pye_true_2));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_cum_screened));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_cum_screened_1));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_cum_screened_2));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_cum_treated));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_cum_treated_1));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_cum_treated_2));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_diag_rec_a));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_diag_rec_a_1));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_diag_rec_a_12));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_diag_rec_a_2));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_diag_rec_a_3));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_diag_rec_s));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_diag_rec_s_1));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_diag_rec_s_12));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_diag_rec_s_2));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_diag_rec_s_3));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_I_1));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_I_2));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_I0));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_I0_1));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_I0_2));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_n_AT));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_n_AT_1));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_n_AT_2));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_n_AU));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_n_AU_1));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_n_AU_2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_n_diag_rec));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_n_diag_rec_1));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_n_diag_rec_12));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_n_diag_rec_2));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_n_diag_rec_3));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_n_ST));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_n_ST_1));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_n_ST_2));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_n_TU));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_n_TU_1));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_n_TU_2));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_n_UI));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_n_UI_1));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_n_UI_2));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_pye_trial));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_pye_trial_1));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_pye_trial_2));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_S0));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_S0_1));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_S0_2));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_screened));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_screened_1));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_screened_2));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_T));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_T_1));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_T_2));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_T0));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_T0_1));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_T0_2));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_U));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_U_1));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_U_2));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_U0));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_U0_1));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_U0_2));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_vea));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_ved));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_ves));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_w));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_w_1));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_w_2));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_wA));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_wA_1));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_wA_12));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_wA_2));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_wA_3));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_wI));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_wI_1));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_wI_12));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_wI_2));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_wI_3));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_wS));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_wS_1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_wS_12));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_wS_2));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_wS_3));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_wT));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_wT_1));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_wT_12));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_wT_2));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_wT_3));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_wU));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_wU_1));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_wU_12));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_wU_2));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_wU_3));
  SET_VECTOR_ELT(contents, 124, ScalarReal(internal->eta));
  SEXP I0 = PROTECT(allocVector(REALSXP, internal->dim_I0));
  memcpy(REAL(I0), internal->I0, internal->dim_I0 * sizeof(double));
  odin_set_dim(I0, 2, internal->dim_I0_1, internal->dim_I0_2);
  SET_VECTOR_ELT(contents, 125, I0);
  SEXP initial_A = PROTECT(allocVector(REALSXP, internal->dim_A));
  memcpy(REAL(initial_A), internal->initial_A, internal->dim_A * sizeof(double));
  odin_set_dim(initial_A, 2, internal->dim_A_1, internal->dim_A_2);
  SET_VECTOR_ELT(contents, 126, initial_A);
  SEXP initial_cum_diag_a = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_a));
  memcpy(REAL(initial_cum_diag_a), internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  odin_set_dim(initial_cum_diag_a, 2, internal->dim_cum_diag_a_1, internal->dim_cum_diag_a_2);
  SET_VECTOR_ELT(contents, 127, initial_cum_diag_a);
  SEXP initial_cum_diag_s = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_s));
  memcpy(REAL(initial_cum_diag_s), internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  odin_set_dim(initial_cum_diag_s, 2, internal->dim_cum_diag_s_1, internal->dim_cum_diag_s_2);
  SET_VECTOR_ELT(contents, 128, initial_cum_diag_s);
  SEXP initial_cum_incid = PROTECT(allocVector(REALSXP, internal->dim_cum_incid));
  memcpy(REAL(initial_cum_incid), internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  odin_set_dim(initial_cum_incid, 2, internal->dim_cum_incid_1, internal->dim_cum_incid_2);
  SET_VECTOR_ELT(contents, 129, initial_cum_incid);
  SEXP initial_cum_pye_trial_pov = PROTECT(allocVector(REALSXP, internal->dim_cum_pye_trial_pov));
  memcpy(REAL(initial_cum_pye_trial_pov), internal->initial_cum_pye_trial_pov, internal->dim_cum_pye_trial_pov * sizeof(double));
  odin_set_dim(initial_cum_pye_trial_pov, 2, internal->dim_cum_pye_trial_pov_1, internal->dim_cum_pye_trial_pov_2);
  SET_VECTOR_ELT(contents, 130, initial_cum_pye_trial_pov);
  SEXP initial_cum_pye_true = PROTECT(allocVector(REALSXP, internal->dim_cum_pye_true));
  memcpy(REAL(initial_cum_pye_true), internal->initial_cum_pye_true, internal->dim_cum_pye_true * sizeof(double));
  odin_set_dim(initial_cum_pye_true, 2, internal->dim_cum_pye_true_1, internal->dim_cum_pye_true_2);
  SET_VECTOR_ELT(contents, 131, initial_cum_pye_true);
  SEXP initial_cum_screened = PROTECT(allocVector(REALSXP, internal->dim_cum_screened));
  memcpy(REAL(initial_cum_screened), internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  odin_set_dim(initial_cum_screened, 2, internal->dim_cum_screened_1, internal->dim_cum_screened_2);
  SET_VECTOR_ELT(contents, 132, initial_cum_screened);
  SEXP initial_cum_treated = PROTECT(allocVector(REALSXP, internal->dim_cum_treated));
  memcpy(REAL(initial_cum_treated), internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  odin_set_dim(initial_cum_treated, 2, internal->dim_cum_treated_1, internal->dim_cum_treated_2);
  SET_VECTOR_ELT(contents, 133, initial_cum_treated);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  odin_set_dim(initial_I, 2, internal->dim_I_1, internal->dim_I_2);
  SET_VECTOR_ELT(contents, 134, initial_I);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 2, internal->dim_S_1, internal->dim_S_2);
  SET_VECTOR_ELT(contents, 135, initial_S);
  SEXP initial_T = PROTECT(allocVector(REALSXP, internal->dim_T));
  memcpy(REAL(initial_T), internal->initial_T, internal->dim_T * sizeof(double));
  odin_set_dim(initial_T, 2, internal->dim_T_1, internal->dim_T_2);
  SET_VECTOR_ELT(contents, 136, initial_T);
  SEXP initial_U = PROTECT(allocVector(REALSXP, internal->dim_U));
  memcpy(REAL(initial_U), internal->initial_U, internal->dim_U * sizeof(double));
  odin_set_dim(initial_U, 2, internal->dim_U_1, internal->dim_U_2);
  SET_VECTOR_ELT(contents, 137, initial_U);
  SET_VECTOR_ELT(contents, 138, ScalarReal(internal->lambda));
  SET_VECTOR_ELT(contents, 139, ScalarReal(internal->mu));
  SEXP N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(N), internal->N, internal->dim_N * sizeof(double));
  odin_set_dim(N, 2, internal->dim_N_1, internal->dim_N_2);
  SET_VECTOR_ELT(contents, 140, N);
  SEXP n_AT = PROTECT(allocVector(REALSXP, internal->dim_n_AT));
  memcpy(REAL(n_AT), internal->n_AT, internal->dim_n_AT * sizeof(double));
  odin_set_dim(n_AT, 2, internal->dim_n_AT_1, internal->dim_n_AT_2);
  SET_VECTOR_ELT(contents, 141, n_AT);
  SEXP n_AU = PROTECT(allocVector(REALSXP, internal->dim_n_AU));
  memcpy(REAL(n_AU), internal->n_AU, internal->dim_n_AU * sizeof(double));
  odin_set_dim(n_AU, 2, internal->dim_n_AU_1, internal->dim_n_AU_2);
  SET_VECTOR_ELT(contents, 142, n_AU);
  SEXP n_diag_rec = PROTECT(allocVector(REALSXP, internal->dim_n_diag_rec));
  memcpy(REAL(n_diag_rec), internal->n_diag_rec, internal->dim_n_diag_rec * sizeof(double));
  odin_set_dim(n_diag_rec, 3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_2, internal->dim_n_diag_rec_3);
  SET_VECTOR_ELT(contents, 143, n_diag_rec);
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->n_group));
  SEXP n_ST = PROTECT(allocVector(REALSXP, internal->dim_n_ST));
  memcpy(REAL(n_ST), internal->n_ST, internal->dim_n_ST * sizeof(double));
  odin_set_dim(n_ST, 2, internal->dim_n_ST_1, internal->dim_n_ST_2);
  SET_VECTOR_ELT(contents, 145, n_ST);
  SEXP n_TU = PROTECT(allocVector(REALSXP, internal->dim_n_TU));
  memcpy(REAL(n_TU), internal->n_TU, internal->dim_n_TU * sizeof(double));
  odin_set_dim(n_TU, 2, internal->dim_n_TU_1, internal->dim_n_TU_2);
  SET_VECTOR_ELT(contents, 146, n_TU);
  SEXP n_UI = PROTECT(allocVector(REALSXP, internal->dim_n_UI));
  memcpy(REAL(n_UI), internal->n_UI, internal->dim_n_UI * sizeof(double));
  odin_set_dim(n_UI, 2, internal->dim_n_UI_1, internal->dim_n_UI_2);
  SET_VECTOR_ELT(contents, 147, n_UI);
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->n_vax));
  SET_VECTOR_ELT(contents, 149, ScalarReal(internal->nu));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->offset_variable_A));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->offset_variable_cum_diag_a));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->offset_variable_cum_diag_s));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->offset_variable_cum_incid));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->offset_variable_cum_pye_trial_pov));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->offset_variable_cum_pye_true));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->offset_variable_cum_screened));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->offset_variable_cum_treated));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->offset_variable_T));
  SET_VECTOR_ELT(contents, 160, ScalarReal(internal->psi));
  SEXP pye_trial = PROTECT(allocVector(REALSXP, internal->dim_pye_trial));
  memcpy(REAL(pye_trial), internal->pye_trial, internal->dim_pye_trial * sizeof(double));
  odin_set_dim(pye_trial, 2, internal->dim_pye_trial_1, internal->dim_pye_trial_2);
  SET_VECTOR_ELT(contents, 161, pye_trial);
  SET_VECTOR_ELT(contents, 162, ScalarReal(internal->rho));
  SEXP S0 = PROTECT(allocVector(REALSXP, internal->dim_S0));
  memcpy(REAL(S0), internal->S0, internal->dim_S0 * sizeof(double));
  odin_set_dim(S0, 2, internal->dim_S0_1, internal->dim_S0_2);
  SET_VECTOR_ELT(contents, 163, S0);
  SEXP screened = PROTECT(allocVector(REALSXP, internal->dim_screened));
  memcpy(REAL(screened), internal->screened, internal->dim_screened * sizeof(double));
  odin_set_dim(screened, 2, internal->dim_screened_1, internal->dim_screened_2);
  SET_VECTOR_ELT(contents, 164, screened);
  SET_VECTOR_ELT(contents, 165, ScalarReal(internal->sigma));
  SEXP T0 = PROTECT(allocVector(REALSXP, internal->dim_T0));
  memcpy(REAL(T0), internal->T0, internal->dim_T0 * sizeof(double));
  odin_set_dim(T0, 2, internal->dim_T0_1, internal->dim_T0_2);
  SET_VECTOR_ELT(contents, 166, T0);
  SEXP U0 = PROTECT(allocVector(REALSXP, internal->dim_U0));
  memcpy(REAL(U0), internal->U0, internal->dim_U0 * sizeof(double));
  odin_set_dim(U0, 2, internal->dim_U0_1, internal->dim_U0_2);
  SET_VECTOR_ELT(contents, 167, U0);
  SEXP vea = PROTECT(allocVector(REALSXP, internal->dim_vea));
  memcpy(REAL(vea), internal->vea, internal->dim_vea * sizeof(double));
  SET_VECTOR_ELT(contents, 168, vea);
  SEXP ved = PROTECT(allocVector(REALSXP, internal->dim_ved));
  memcpy(REAL(ved), internal->ved, internal->dim_ved * sizeof(double));
  SET_VECTOR_ELT(contents, 169, ved);
  SEXP ves = PROTECT(allocVector(REALSXP, internal->dim_ves));
  memcpy(REAL(ves), internal->ves, internal->dim_ves * sizeof(double));
  SET_VECTOR_ELT(contents, 170, ves);
  SEXP w = PROTECT(allocVector(REALSXP, internal->dim_w));
  memcpy(REAL(w), internal->w, internal->dim_w * sizeof(double));
  odin_set_dim(w, 2, internal->dim_w_1, internal->dim_w_2);
  SET_VECTOR_ELT(contents, 171, w);
  SEXP wA = PROTECT(allocVector(REALSXP, internal->dim_wA));
  memcpy(REAL(wA), internal->wA, internal->dim_wA * sizeof(double));
  odin_set_dim(wA, 3, internal->dim_wA_1, internal->dim_wA_2, internal->dim_wA_3);
  SET_VECTOR_ELT(contents, 172, wA);
  SEXP wI = PROTECT(allocVector(REALSXP, internal->dim_wI));
  memcpy(REAL(wI), internal->wI, internal->dim_wI * sizeof(double));
  odin_set_dim(wI, 3, internal->dim_wI_1, internal->dim_wI_2, internal->dim_wI_3);
  SET_VECTOR_ELT(contents, 173, wI);
  SEXP wS = PROTECT(allocVector(REALSXP, internal->dim_wS));
  memcpy(REAL(wS), internal->wS, internal->dim_wS * sizeof(double));
  odin_set_dim(wS, 3, internal->dim_wS_1, internal->dim_wS_2, internal->dim_wS_3);
  SET_VECTOR_ELT(contents, 174, wS);
  SEXP wT = PROTECT(allocVector(REALSXP, internal->dim_wT));
  memcpy(REAL(wT), internal->wT, internal->dim_wT * sizeof(double));
  odin_set_dim(wT, 3, internal->dim_wT_1, internal->dim_wT_2, internal->dim_wT_3);
  SET_VECTOR_ELT(contents, 175, wT);
  SEXP wU = PROTECT(allocVector(REALSXP, internal->dim_wU));
  memcpy(REAL(wU), internal->wU, internal->dim_wU * sizeof(double));
  odin_set_dim(wU, 3, internal->dim_wU_1, internal->dim_wU_2, internal->dim_wU_3);
  SET_VECTOR_ELT(contents, 176, wU);
  SEXP nms = PROTECT(allocVector(STRSXP, 177));
  SET_STRING_ELT(nms, 0, mkChar("A0"));
  SET_STRING_ELT(nms, 1, mkChar("diag_rec_a"));
  SET_STRING_ELT(nms, 2, mkChar("diag_rec_s"));
  SET_STRING_ELT(nms, 3, mkChar("dim_A"));
  SET_STRING_ELT(nms, 4, mkChar("dim_A_1"));
  SET_STRING_ELT(nms, 5, mkChar("dim_A_2"));
  SET_STRING_ELT(nms, 6, mkChar("dim_A0"));
  SET_STRING_ELT(nms, 7, mkChar("dim_A0_1"));
  SET_STRING_ELT(nms, 8, mkChar("dim_A0_2"));
  SET_STRING_ELT(nms, 9, mkChar("dim_cum_diag_a"));
  SET_STRING_ELT(nms, 10, mkChar("dim_cum_diag_a_1"));
  SET_STRING_ELT(nms, 11, mkChar("dim_cum_diag_a_2"));
  SET_STRING_ELT(nms, 12, mkChar("dim_cum_diag_s"));
  SET_STRING_ELT(nms, 13, mkChar("dim_cum_diag_s_1"));
  SET_STRING_ELT(nms, 14, mkChar("dim_cum_diag_s_2"));
  SET_STRING_ELT(nms, 15, mkChar("dim_cum_incid"));
  SET_STRING_ELT(nms, 16, mkChar("dim_cum_incid_1"));
  SET_STRING_ELT(nms, 17, mkChar("dim_cum_incid_2"));
  SET_STRING_ELT(nms, 18, mkChar("dim_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 19, mkChar("dim_cum_pye_trial_pov_1"));
  SET_STRING_ELT(nms, 20, mkChar("dim_cum_pye_trial_pov_2"));
  SET_STRING_ELT(nms, 21, mkChar("dim_cum_pye_true"));
  SET_STRING_ELT(nms, 22, mkChar("dim_cum_pye_true_1"));
  SET_STRING_ELT(nms, 23, mkChar("dim_cum_pye_true_2"));
  SET_STRING_ELT(nms, 24, mkChar("dim_cum_screened"));
  SET_STRING_ELT(nms, 25, mkChar("dim_cum_screened_1"));
  SET_STRING_ELT(nms, 26, mkChar("dim_cum_screened_2"));
  SET_STRING_ELT(nms, 27, mkChar("dim_cum_treated"));
  SET_STRING_ELT(nms, 28, mkChar("dim_cum_treated_1"));
  SET_STRING_ELT(nms, 29, mkChar("dim_cum_treated_2"));
  SET_STRING_ELT(nms, 30, mkChar("dim_diag_rec_a"));
  SET_STRING_ELT(nms, 31, mkChar("dim_diag_rec_a_1"));
  SET_STRING_ELT(nms, 32, mkChar("dim_diag_rec_a_12"));
  SET_STRING_ELT(nms, 33, mkChar("dim_diag_rec_a_2"));
  SET_STRING_ELT(nms, 34, mkChar("dim_diag_rec_a_3"));
  SET_STRING_ELT(nms, 35, mkChar("dim_diag_rec_s"));
  SET_STRING_ELT(nms, 36, mkChar("dim_diag_rec_s_1"));
  SET_STRING_ELT(nms, 37, mkChar("dim_diag_rec_s_12"));
  SET_STRING_ELT(nms, 38, mkChar("dim_diag_rec_s_2"));
  SET_STRING_ELT(nms, 39, mkChar("dim_diag_rec_s_3"));
  SET_STRING_ELT(nms, 40, mkChar("dim_I"));
  SET_STRING_ELT(nms, 41, mkChar("dim_I_1"));
  SET_STRING_ELT(nms, 42, mkChar("dim_I_2"));
  SET_STRING_ELT(nms, 43, mkChar("dim_I0"));
  SET_STRING_ELT(nms, 44, mkChar("dim_I0_1"));
  SET_STRING_ELT(nms, 45, mkChar("dim_I0_2"));
  SET_STRING_ELT(nms, 46, mkChar("dim_N"));
  SET_STRING_ELT(nms, 47, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 48, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 49, mkChar("dim_n_AT"));
  SET_STRING_ELT(nms, 50, mkChar("dim_n_AT_1"));
  SET_STRING_ELT(nms, 51, mkChar("dim_n_AT_2"));
  SET_STRING_ELT(nms, 52, mkChar("dim_n_AU"));
  SET_STRING_ELT(nms, 53, mkChar("dim_n_AU_1"));
  SET_STRING_ELT(nms, 54, mkChar("dim_n_AU_2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_n_diag_rec"));
  SET_STRING_ELT(nms, 56, mkChar("dim_n_diag_rec_1"));
  SET_STRING_ELT(nms, 57, mkChar("dim_n_diag_rec_12"));
  SET_STRING_ELT(nms, 58, mkChar("dim_n_diag_rec_2"));
  SET_STRING_ELT(nms, 59, mkChar("dim_n_diag_rec_3"));
  SET_STRING_ELT(nms, 60, mkChar("dim_n_ST"));
  SET_STRING_ELT(nms, 61, mkChar("dim_n_ST_1"));
  SET_STRING_ELT(nms, 62, mkChar("dim_n_ST_2"));
  SET_STRING_ELT(nms, 63, mkChar("dim_n_TU"));
  SET_STRING_ELT(nms, 64, mkChar("dim_n_TU_1"));
  SET_STRING_ELT(nms, 65, mkChar("dim_n_TU_2"));
  SET_STRING_ELT(nms, 66, mkChar("dim_n_UI"));
  SET_STRING_ELT(nms, 67, mkChar("dim_n_UI_1"));
  SET_STRING_ELT(nms, 68, mkChar("dim_n_UI_2"));
  SET_STRING_ELT(nms, 69, mkChar("dim_pye_trial"));
  SET_STRING_ELT(nms, 70, mkChar("dim_pye_trial_1"));
  SET_STRING_ELT(nms, 71, mkChar("dim_pye_trial_2"));
  SET_STRING_ELT(nms, 72, mkChar("dim_S"));
  SET_STRING_ELT(nms, 73, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 74, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 75, mkChar("dim_S0"));
  SET_STRING_ELT(nms, 76, mkChar("dim_S0_1"));
  SET_STRING_ELT(nms, 77, mkChar("dim_S0_2"));
  SET_STRING_ELT(nms, 78, mkChar("dim_screened"));
  SET_STRING_ELT(nms, 79, mkChar("dim_screened_1"));
  SET_STRING_ELT(nms, 80, mkChar("dim_screened_2"));
  SET_STRING_ELT(nms, 81, mkChar("dim_T"));
  SET_STRING_ELT(nms, 82, mkChar("dim_T_1"));
  SET_STRING_ELT(nms, 83, mkChar("dim_T_2"));
  SET_STRING_ELT(nms, 84, mkChar("dim_T0"));
  SET_STRING_ELT(nms, 85, mkChar("dim_T0_1"));
  SET_STRING_ELT(nms, 86, mkChar("dim_T0_2"));
  SET_STRING_ELT(nms, 87, mkChar("dim_U"));
  SET_STRING_ELT(nms, 88, mkChar("dim_U_1"));
  SET_STRING_ELT(nms, 89, mkChar("dim_U_2"));
  SET_STRING_ELT(nms, 90, mkChar("dim_U0"));
  SET_STRING_ELT(nms, 91, mkChar("dim_U0_1"));
  SET_STRING_ELT(nms, 92, mkChar("dim_U0_2"));
  SET_STRING_ELT(nms, 93, mkChar("dim_vea"));
  SET_STRING_ELT(nms, 94, mkChar("dim_ved"));
  SET_STRING_ELT(nms, 95, mkChar("dim_ves"));
  SET_STRING_ELT(nms, 96, mkChar("dim_w"));
  SET_STRING_ELT(nms, 97, mkChar("dim_w_1"));
  SET_STRING_ELT(nms, 98, mkChar("dim_w_2"));
  SET_STRING_ELT(nms, 99, mkChar("dim_wA"));
  SET_STRING_ELT(nms, 100, mkChar("dim_wA_1"));
  SET_STRING_ELT(nms, 101, mkChar("dim_wA_12"));
  SET_STRING_ELT(nms, 102, mkChar("dim_wA_2"));
  SET_STRING_ELT(nms, 103, mkChar("dim_wA_3"));
  SET_STRING_ELT(nms, 104, mkChar("dim_wI"));
  SET_STRING_ELT(nms, 105, mkChar("dim_wI_1"));
  SET_STRING_ELT(nms, 106, mkChar("dim_wI_12"));
  SET_STRING_ELT(nms, 107, mkChar("dim_wI_2"));
  SET_STRING_ELT(nms, 108, mkChar("dim_wI_3"));
  SET_STRING_ELT(nms, 109, mkChar("dim_wS"));
  SET_STRING_ELT(nms, 110, mkChar("dim_wS_1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_wS_12"));
  SET_STRING_ELT(nms, 112, mkChar("dim_wS_2"));
  SET_STRING_ELT(nms, 113, mkChar("dim_wS_3"));
  SET_STRING_ELT(nms, 114, mkChar("dim_wT"));
  SET_STRING_ELT(nms, 115, mkChar("dim_wT_1"));
  SET_STRING_ELT(nms, 116, mkChar("dim_wT_12"));
  SET_STRING_ELT(nms, 117, mkChar("dim_wT_2"));
  SET_STRING_ELT(nms, 118, mkChar("dim_wT_3"));
  SET_STRING_ELT(nms, 119, mkChar("dim_wU"));
  SET_STRING_ELT(nms, 120, mkChar("dim_wU_1"));
  SET_STRING_ELT(nms, 121, mkChar("dim_wU_12"));
  SET_STRING_ELT(nms, 122, mkChar("dim_wU_2"));
  SET_STRING_ELT(nms, 123, mkChar("dim_wU_3"));
  SET_STRING_ELT(nms, 124, mkChar("eta"));
  SET_STRING_ELT(nms, 125, mkChar("I0"));
  SET_STRING_ELT(nms, 126, mkChar("initial_A"));
  SET_STRING_ELT(nms, 127, mkChar("initial_cum_diag_a"));
  SET_STRING_ELT(nms, 128, mkChar("initial_cum_diag_s"));
  SET_STRING_ELT(nms, 129, mkChar("initial_cum_incid"));
  SET_STRING_ELT(nms, 130, mkChar("initial_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 131, mkChar("initial_cum_pye_true"));
  SET_STRING_ELT(nms, 132, mkChar("initial_cum_screened"));
  SET_STRING_ELT(nms, 133, mkChar("initial_cum_treated"));
  SET_STRING_ELT(nms, 134, mkChar("initial_I"));
  SET_STRING_ELT(nms, 135, mkChar("initial_S"));
  SET_STRING_ELT(nms, 136, mkChar("initial_T"));
  SET_STRING_ELT(nms, 137, mkChar("initial_U"));
  SET_STRING_ELT(nms, 138, mkChar("lambda"));
  SET_STRING_ELT(nms, 139, mkChar("mu"));
  SET_STRING_ELT(nms, 140, mkChar("N"));
  SET_STRING_ELT(nms, 141, mkChar("n_AT"));
  SET_STRING_ELT(nms, 142, mkChar("n_AU"));
  SET_STRING_ELT(nms, 143, mkChar("n_diag_rec"));
  SET_STRING_ELT(nms, 144, mkChar("n_group"));
  SET_STRING_ELT(nms, 145, mkChar("n_ST"));
  SET_STRING_ELT(nms, 146, mkChar("n_TU"));
  SET_STRING_ELT(nms, 147, mkChar("n_UI"));
  SET_STRING_ELT(nms, 148, mkChar("n_vax"));
  SET_STRING_ELT(nms, 149, mkChar("nu"));
  SET_STRING_ELT(nms, 150, mkChar("offset_variable_A"));
  SET_STRING_ELT(nms, 151, mkChar("offset_variable_cum_diag_a"));
  SET_STRING_ELT(nms, 152, mkChar("offset_variable_cum_diag_s"));
  SET_STRING_ELT(nms, 153, mkChar("offset_variable_cum_incid"));
  SET_STRING_ELT(nms, 154, mkChar("offset_variable_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 155, mkChar("offset_variable_cum_pye_true"));
  SET_STRING_ELT(nms, 156, mkChar("offset_variable_cum_screened"));
  SET_STRING_ELT(nms, 157, mkChar("offset_variable_cum_treated"));
  SET_STRING_ELT(nms, 158, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 159, mkChar("offset_variable_T"));
  SET_STRING_ELT(nms, 160, mkChar("psi"));
  SET_STRING_ELT(nms, 161, mkChar("pye_trial"));
  SET_STRING_ELT(nms, 162, mkChar("rho"));
  SET_STRING_ELT(nms, 163, mkChar("S0"));
  SET_STRING_ELT(nms, 164, mkChar("screened"));
  SET_STRING_ELT(nms, 165, mkChar("sigma"));
  SET_STRING_ELT(nms, 166, mkChar("T0"));
  SET_STRING_ELT(nms, 167, mkChar("U0"));
  SET_STRING_ELT(nms, 168, mkChar("vea"));
  SET_STRING_ELT(nms, 169, mkChar("ved"));
  SET_STRING_ELT(nms, 170, mkChar("ves"));
  SET_STRING_ELT(nms, 171, mkChar("w"));
  SET_STRING_ELT(nms, 172, mkChar("wA"));
  SET_STRING_ELT(nms, 173, mkChar("wI"));
  SET_STRING_ELT(nms, 174, mkChar("wS"));
  SET_STRING_ELT(nms, 175, mkChar("wT"));
  SET_STRING_ELT(nms, 176, mkChar("wU"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(39);
  return contents;
}
SEXP model_trial_set_user(SEXP internal_p, SEXP user) {
  model_trial_internal *internal = model_trial_get_internal(internal_p, 1);
  internal->eta = user_get_scalar_double(user, "eta", internal->eta, NA_REAL, NA_REAL);
  internal->lambda = user_get_scalar_double(user, "lambda", internal->lambda, NA_REAL, NA_REAL);
  internal->mu = user_get_scalar_double(user, "mu", internal->mu, NA_REAL, NA_REAL);
  internal->n_vax = user_get_scalar_int(user, "n_vax", internal->n_vax, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->psi = user_get_scalar_double(user, "psi", internal->psi, NA_REAL, NA_REAL);
  internal->rho = user_get_scalar_double(user, "rho", internal->rho, NA_REAL, NA_REAL);
  internal->sigma = user_get_scalar_double(user, "sigma", internal->sigma, NA_REAL, NA_REAL);
  internal->dim_A_1 = internal->n_group;
  internal->dim_A_2 = internal->n_vax;
  internal->dim_A0_1 = internal->n_group;
  internal->dim_A0_2 = internal->n_vax;
  internal->dim_cum_diag_a_1 = internal->n_group;
  internal->dim_cum_diag_a_2 = internal->n_vax;
  internal->dim_cum_diag_s_1 = internal->n_group;
  internal->dim_cum_diag_s_2 = internal->n_vax;
  internal->dim_cum_incid_1 = internal->n_group;
  internal->dim_cum_incid_2 = internal->n_vax;
  internal->dim_cum_pye_trial_pov_1 = internal->n_group;
  internal->dim_cum_pye_trial_pov_2 = internal->n_vax;
  internal->dim_cum_pye_true_1 = internal->n_group;
  internal->dim_cum_pye_true_2 = internal->n_vax;
  internal->dim_cum_screened_1 = internal->n_group;
  internal->dim_cum_screened_2 = internal->n_vax;
  internal->dim_cum_treated_1 = internal->n_group;
  internal->dim_cum_treated_2 = internal->n_vax;
  internal->dim_diag_rec_a_1 = internal->n_group;
  internal->dim_diag_rec_a_2 = internal->n_vax;
  internal->dim_diag_rec_a_3 = internal->n_vax;
  internal->dim_diag_rec_s_1 = internal->n_group;
  internal->dim_diag_rec_s_2 = internal->n_vax;
  internal->dim_diag_rec_s_3 = internal->n_vax;
  internal->dim_I_1 = internal->n_group;
  internal->dim_I_2 = internal->n_vax;
  internal->dim_I0_1 = internal->n_group;
  internal->dim_I0_2 = internal->n_vax;
  internal->dim_N_1 = internal->n_group;
  internal->dim_N_2 = internal->n_vax;
  internal->dim_n_AT_1 = internal->n_group;
  internal->dim_n_AT_2 = internal->n_vax;
  internal->dim_n_AU_1 = internal->n_group;
  internal->dim_n_AU_2 = internal->n_vax;
  internal->dim_n_diag_rec_1 = internal->n_group;
  internal->dim_n_diag_rec_2 = internal->n_vax;
  internal->dim_n_diag_rec_3 = internal->n_vax;
  internal->dim_n_ST_1 = internal->n_group;
  internal->dim_n_ST_2 = internal->n_vax;
  internal->dim_n_TU_1 = internal->n_group;
  internal->dim_n_TU_2 = internal->n_vax;
  internal->dim_n_UI_1 = internal->n_group;
  internal->dim_n_UI_2 = internal->n_vax;
  internal->dim_pye_trial_1 = internal->n_group;
  internal->dim_pye_trial_2 = internal->n_vax;
  internal->dim_S_1 = internal->n_group;
  internal->dim_S_2 = internal->n_vax;
  internal->dim_S0_1 = internal->n_group;
  internal->dim_S0_2 = internal->n_vax;
  internal->dim_screened_1 = internal->n_group;
  internal->dim_screened_2 = internal->n_vax;
  internal->dim_T_1 = internal->n_group;
  internal->dim_T_2 = internal->n_vax;
  internal->dim_T0_1 = internal->n_group;
  internal->dim_T0_2 = internal->n_vax;
  internal->dim_U_1 = internal->n_group;
  internal->dim_U_2 = internal->n_vax;
  internal->dim_U0_1 = internal->n_group;
  internal->dim_U0_2 = internal->n_vax;
  internal->dim_vea = internal->n_vax;
  internal->dim_ved = internal->n_vax;
  internal->dim_ves = internal->n_vax;
  internal->dim_w_1 = internal->n_vax;
  internal->dim_w_2 = internal->n_vax;
  internal->dim_wA_1 = internal->n_group;
  internal->dim_wA_2 = internal->n_vax;
  internal->dim_wA_3 = internal->n_vax;
  internal->dim_wI_1 = internal->n_group;
  internal->dim_wI_2 = internal->n_vax;
  internal->dim_wI_3 = internal->n_vax;
  internal->dim_wS_1 = internal->n_group;
  internal->dim_wS_2 = internal->n_vax;
  internal->dim_wS_3 = internal->n_vax;
  internal->dim_wT_1 = internal->n_group;
  internal->dim_wT_2 = internal->n_vax;
  internal->dim_wT_3 = internal->n_vax;
  internal->dim_wU_1 = internal->n_group;
  internal->dim_wU_2 = internal->n_vax;
  internal->dim_wU_3 = internal->n_vax;
  internal->dim_A = internal->dim_A_1 * internal->dim_A_2;
  internal->dim_A0 = internal->dim_A0_1 * internal->dim_A0_2;
  internal->dim_cum_diag_a = internal->dim_cum_diag_a_1 * internal->dim_cum_diag_a_2;
  internal->dim_cum_diag_s = internal->dim_cum_diag_s_1 * internal->dim_cum_diag_s_2;
  internal->dim_cum_incid = internal->dim_cum_incid_1 * internal->dim_cum_incid_2;
  internal->dim_cum_pye_trial_pov = internal->dim_cum_pye_trial_pov_1 * internal->dim_cum_pye_trial_pov_2;
  internal->dim_cum_pye_true = internal->dim_cum_pye_true_1 * internal->dim_cum_pye_true_2;
  internal->dim_cum_screened = internal->dim_cum_screened_1 * internal->dim_cum_screened_2;
  internal->dim_cum_treated = internal->dim_cum_treated_1 * internal->dim_cum_treated_2;
  internal->dim_diag_rec_a = internal->dim_diag_rec_a_1 * internal->dim_diag_rec_a_2 * internal->dim_diag_rec_a_3;
  internal->dim_diag_rec_a_12 = internal->dim_diag_rec_a_1 * internal->dim_diag_rec_a_2;
  internal->dim_diag_rec_s = internal->dim_diag_rec_s_1 * internal->dim_diag_rec_s_2 * internal->dim_diag_rec_s_3;
  internal->dim_diag_rec_s_12 = internal->dim_diag_rec_s_1 * internal->dim_diag_rec_s_2;
  internal->dim_I = internal->dim_I_1 * internal->dim_I_2;
  internal->dim_I0 = internal->dim_I0_1 * internal->dim_I0_2;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_n_AT = internal->dim_n_AT_1 * internal->dim_n_AT_2;
  internal->dim_n_AU = internal->dim_n_AU_1 * internal->dim_n_AU_2;
  internal->dim_n_diag_rec = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2 * internal->dim_n_diag_rec_3;
  internal->dim_n_diag_rec_12 = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2;
  internal->dim_n_ST = internal->dim_n_ST_1 * internal->dim_n_ST_2;
  internal->dim_n_TU = internal->dim_n_TU_1 * internal->dim_n_TU_2;
  internal->dim_n_UI = internal->dim_n_UI_1 * internal->dim_n_UI_2;
  internal->dim_pye_trial = internal->dim_pye_trial_1 * internal->dim_pye_trial_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_S0 = internal->dim_S0_1 * internal->dim_S0_2;
  internal->dim_screened = internal->dim_screened_1 * internal->dim_screened_2;
  internal->dim_T = internal->dim_T_1 * internal->dim_T_2;
  internal->dim_T0 = internal->dim_T0_1 * internal->dim_T0_2;
  internal->dim_U = internal->dim_U_1 * internal->dim_U_2;
  internal->dim_U0 = internal->dim_U0_1 * internal->dim_U0_2;
  internal->dim_w = internal->dim_w_1 * internal->dim_w_2;
  internal->dim_wA = internal->dim_wA_1 * internal->dim_wA_2 * internal->dim_wA_3;
  internal->dim_wA_12 = internal->dim_wA_1 * internal->dim_wA_2;
  internal->dim_wI = internal->dim_wI_1 * internal->dim_wI_2 * internal->dim_wI_3;
  internal->dim_wI_12 = internal->dim_wI_1 * internal->dim_wI_2;
  internal->dim_wS = internal->dim_wS_1 * internal->dim_wS_2 * internal->dim_wS_3;
  internal->dim_wS_12 = internal->dim_wS_1 * internal->dim_wS_2;
  internal->dim_wT = internal->dim_wT_1 * internal->dim_wT_2 * internal->dim_wT_3;
  internal->dim_wT_12 = internal->dim_wT_1 * internal->dim_wT_2;
  internal->dim_wU = internal->dim_wU_1 * internal->dim_wU_2 * internal->dim_wU_3;
  internal->dim_wU_12 = internal->dim_wU_1 * internal->dim_wU_2;
  internal->vea = (double*) user_get_array(user, false, internal->vea, "vea", NA_REAL, NA_REAL, 1, internal->dim_vea);
  internal->ved = (double*) user_get_array(user, false, internal->ved, "ved", NA_REAL, NA_REAL, 1, internal->dim_ved);
  internal->ves = (double*) user_get_array(user, false, internal->ves, "ves", NA_REAL, NA_REAL, 1, internal->dim_ves);
  internal->A0 = (double*) user_get_array(user, false, internal->A0, "A0", NA_REAL, NA_REAL, 2, internal->dim_A0_1, internal->dim_A0_2);
  R_Free(internal->initial_A);
  internal->initial_A = (double*) R_Calloc(internal->dim_A, double);
  R_Free(internal->initial_cum_diag_a);
  internal->initial_cum_diag_a = (double*) R_Calloc(internal->dim_cum_diag_a, double);
  R_Free(internal->initial_cum_diag_s);
  internal->initial_cum_diag_s = (double*) R_Calloc(internal->dim_cum_diag_s, double);
  R_Free(internal->initial_cum_incid);
  internal->initial_cum_incid = (double*) R_Calloc(internal->dim_cum_incid, double);
  R_Free(internal->initial_cum_pye_trial_pov);
  internal->initial_cum_pye_trial_pov = (double*) R_Calloc(internal->dim_cum_pye_trial_pov, double);
  R_Free(internal->initial_cum_pye_true);
  internal->initial_cum_pye_true = (double*) R_Calloc(internal->dim_cum_pye_true, double);
  R_Free(internal->initial_cum_screened);
  internal->initial_cum_screened = (double*) R_Calloc(internal->dim_cum_screened, double);
  R_Free(internal->initial_cum_treated);
  internal->initial_cum_treated = (double*) R_Calloc(internal->dim_cum_treated, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_T);
  internal->initial_T = (double*) R_Calloc(internal->dim_T, double);
  R_Free(internal->initial_U);
  internal->initial_U = (double*) R_Calloc(internal->dim_U, double);
  R_Free(internal->N);
  internal->N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->n_AT);
  internal->n_AT = (double*) R_Calloc(internal->dim_n_AT, double);
  R_Free(internal->n_AU);
  internal->n_AU = (double*) R_Calloc(internal->dim_n_AU, double);
  R_Free(internal->n_diag_rec);
  internal->n_diag_rec = (double*) R_Calloc(internal->dim_n_diag_rec, double);
  R_Free(internal->n_ST);
  internal->n_ST = (double*) R_Calloc(internal->dim_n_ST, double);
  R_Free(internal->n_TU);
  internal->n_TU = (double*) R_Calloc(internal->dim_n_TU, double);
  R_Free(internal->n_UI);
  internal->n_UI = (double*) R_Calloc(internal->dim_n_UI, double);
  R_Free(internal->pye_trial);
  internal->pye_trial = (double*) R_Calloc(internal->dim_pye_trial, double);
  R_Free(internal->screened);
  internal->screened = (double*) R_Calloc(internal->dim_screened, double);
  R_Free(internal->wA);
  internal->wA = (double*) R_Calloc(internal->dim_wA, double);
  R_Free(internal->wI);
  internal->wI = (double*) R_Calloc(internal->dim_wI, double);
  R_Free(internal->wS);
  internal->wS = (double*) R_Calloc(internal->dim_wS, double);
  R_Free(internal->wT);
  internal->wT = (double*) R_Calloc(internal->dim_wT, double);
  R_Free(internal->wU);
  internal->wU = (double*) R_Calloc(internal->dim_wU, double);
  internal->diag_rec_a = (double*) user_get_array(user, false, internal->diag_rec_a, "diag_rec_a", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_a_1, internal->dim_diag_rec_a_2, internal->dim_diag_rec_a_3);
  internal->diag_rec_s = (double*) user_get_array(user, false, internal->diag_rec_s, "diag_rec_s", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_s_1, internal->dim_diag_rec_s_2, internal->dim_diag_rec_s_3);
  internal->I0 = (double*) user_get_array(user, false, internal->I0, "I0", NA_REAL, NA_REAL, 2, internal->dim_I0_1, internal->dim_I0_2);
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      internal->initial_cum_diag_a[i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      internal->initial_cum_diag_s[i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      internal->initial_cum_incid[i - 1 + internal->dim_cum_incid_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_trial_pov_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_trial_pov_2; ++j) {
      internal->initial_cum_pye_trial_pov[i - 1 + internal->dim_cum_pye_trial_pov_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_true_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_true_2; ++j) {
      internal->initial_cum_pye_true[i - 1 + internal->dim_cum_pye_true_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      internal->initial_cum_screened[i - 1 + internal->dim_cum_screened_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      internal->initial_cum_treated[i - 1 + internal->dim_cum_treated_1 * (j - 1)] = 0;
    }
  }
  internal->offset_variable_A = internal->dim_I + internal->dim_U;
  internal->offset_variable_cum_diag_a = internal->dim_A + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_diag_s = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_incid = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_pye_trial_pov = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_pye_true = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_pye_trial_pov + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_screened = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_treated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_S = internal->dim_A + internal->dim_I + internal->dim_U;
  internal->offset_variable_T = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_U;
  internal->S0 = (double*) user_get_array(user, false, internal->S0, "S0", NA_REAL, NA_REAL, 2, internal->dim_S0_1, internal->dim_S0_2);
  internal->T0 = (double*) user_get_array(user, false, internal->T0, "T0", NA_REAL, NA_REAL, 2, internal->dim_T0_1, internal->dim_T0_2);
  internal->U0 = (double*) user_get_array(user, false, internal->U0, "U0", NA_REAL, NA_REAL, 2, internal->dim_U0_1, internal->dim_U0_2);
  internal->w = (double*) user_get_array(user, false, internal->w, "w", NA_REAL, NA_REAL, 2, internal->dim_w_1, internal->dim_w_2);
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      internal->initial_A[i - 1 + internal->dim_A_1 * (j - 1)] = internal->A0[internal->dim_A0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      internal->initial_I[i - 1 + internal->dim_I_1 * (j - 1)] = internal->I0[internal->dim_I0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1)] = internal->S0[internal->dim_S0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      internal->initial_T[i - 1 + internal->dim_T_1 * (j - 1)] = internal->T0[internal->dim_T0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      internal->initial_U[i - 1 + internal->dim_U_1 * (j - 1)] = internal->U0[internal->dim_U0_1 * (j - 1) + i - 1];
    }
  }
  return R_NilValue;
}
SEXP model_trial_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_trial_use_dde_ptr) {
  return R_NilValue;
}
SEXP model_trial_metadata(SEXP internal_p) {
  model_trial_internal *internal = model_trial_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 12));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 12));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, allocVector(INTSXP, 2));
  int * dim_U = INTEGER(VECTOR_ELT(variable_length, 0));
  dim_U[0] = internal->dim_U_1;
  dim_U[1] = internal->dim_U_2;
  SET_VECTOR_ELT(variable_length, 1, allocVector(INTSXP, 2));
  int * dim_I = INTEGER(VECTOR_ELT(variable_length, 1));
  dim_I[0] = internal->dim_I_1;
  dim_I[1] = internal->dim_I_2;
  SET_VECTOR_ELT(variable_length, 2, allocVector(INTSXP, 2));
  int * dim_A = INTEGER(VECTOR_ELT(variable_length, 2));
  dim_A[0] = internal->dim_A_1;
  dim_A[1] = internal->dim_A_2;
  SET_VECTOR_ELT(variable_length, 3, allocVector(INTSXP, 2));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 3));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  SET_VECTOR_ELT(variable_length, 4, allocVector(INTSXP, 2));
  int * dim_T = INTEGER(VECTOR_ELT(variable_length, 4));
  dim_T[0] = internal->dim_T_1;
  dim_T[1] = internal->dim_T_2;
  SET_VECTOR_ELT(variable_length, 5, allocVector(INTSXP, 2));
  int * dim_cum_incid = INTEGER(VECTOR_ELT(variable_length, 5));
  dim_cum_incid[0] = internal->dim_cum_incid_1;
  dim_cum_incid[1] = internal->dim_cum_incid_2;
  SET_VECTOR_ELT(variable_length, 6, allocVector(INTSXP, 2));
  int * dim_cum_diag_a = INTEGER(VECTOR_ELT(variable_length, 6));
  dim_cum_diag_a[0] = internal->dim_cum_diag_a_1;
  dim_cum_diag_a[1] = internal->dim_cum_diag_a_2;
  SET_VECTOR_ELT(variable_length, 7, allocVector(INTSXP, 2));
  int * dim_cum_diag_s = INTEGER(VECTOR_ELT(variable_length, 7));
  dim_cum_diag_s[0] = internal->dim_cum_diag_s_1;
  dim_cum_diag_s[1] = internal->dim_cum_diag_s_2;
  SET_VECTOR_ELT(variable_length, 8, allocVector(INTSXP, 2));
  int * dim_cum_treated = INTEGER(VECTOR_ELT(variable_length, 8));
  dim_cum_treated[0] = internal->dim_cum_treated_1;
  dim_cum_treated[1] = internal->dim_cum_treated_2;
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 2));
  int * dim_cum_screened = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_cum_screened[0] = internal->dim_cum_screened_1;
  dim_cum_screened[1] = internal->dim_cum_screened_2;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 2));
  int * dim_cum_pye_trial_pov = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_cum_pye_trial_pov[0] = internal->dim_cum_pye_trial_pov_1;
  dim_cum_pye_trial_pov[1] = internal->dim_cum_pye_trial_pov_2;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 2));
  int * dim_cum_pye_true = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_cum_pye_true[0] = internal->dim_cum_pye_true_1;
  dim_cum_pye_true[1] = internal->dim_cum_pye_true_2;
  SET_STRING_ELT(variable_names, 0, mkChar("U"));
  SET_STRING_ELT(variable_names, 1, mkChar("I"));
  SET_STRING_ELT(variable_names, 2, mkChar("A"));
  SET_STRING_ELT(variable_names, 3, mkChar("S"));
  SET_STRING_ELT(variable_names, 4, mkChar("T"));
  SET_STRING_ELT(variable_names, 5, mkChar("cum_incid"));
  SET_STRING_ELT(variable_names, 6, mkChar("cum_diag_a"));
  SET_STRING_ELT(variable_names, 7, mkChar("cum_diag_s"));
  SET_STRING_ELT(variable_names, 8, mkChar("cum_treated"));
  SET_STRING_ELT(variable_names, 9, mkChar("cum_screened"));
  SET_STRING_ELT(variable_names, 10, mkChar("cum_pye_trial_pov"));
  SET_STRING_ELT(variable_names, 11, mkChar("cum_pye_true"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 3));
  SEXP output_names = PROTECT(allocVector(STRSXP, 3));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, allocVector(INTSXP, 2));
  int * dim_N = INTEGER(VECTOR_ELT(output_length, 2));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  SET_STRING_ELT(output_names, 0, mkChar("tot_treated"));
  SET_STRING_ELT(output_names, 1, mkChar("tot_attended"));
  SET_STRING_ELT(output_names, 2, mkChar("N"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(internal->dim_N + 2));
  UNPROTECT(2);
  return ret;
}
SEXP model_trial_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  model_trial_internal *internal = model_trial_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_pye_trial_pov + internal->dim_cum_pye_true + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_U, internal->dim_U * sizeof(double));
  memcpy(state + internal->dim_U, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_A, internal->initial_A, internal->dim_A * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_T, internal->initial_T, internal->dim_T * sizeof(double));
  memcpy(state + internal->offset_variable_cum_incid, internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_a, internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_s, internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  memcpy(state + internal->offset_variable_cum_treated, internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_screened, internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  memcpy(state + internal->offset_variable_cum_pye_trial_pov, internal->initial_cum_pye_trial_pov, internal->dim_cum_pye_trial_pov * sizeof(double));
  memcpy(state + internal->offset_variable_cum_pye_true, internal->initial_cum_pye_true, internal->dim_cum_pye_true * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void model_trial_rhs(model_trial_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  for (int i = 1; i <= internal->dim_cum_pye_true_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_true_2; ++j) {
      dstatedt[internal->offset_variable_cum_pye_true + i - 1 + internal->dim_cum_pye_true_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AT_2; ++j) {
      internal->n_AT[i - 1 + internal->dim_n_AT_1 * (j - 1)] = internal->eta * A[internal->dim_A_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AU_2; ++j) {
      internal->n_AU[i - 1 + internal->dim_n_AU_1 * (j - 1)] = (internal->mu == 0 ? internal->nu * A[internal->dim_A_1 * (j - 1) + i - 1] : internal->nu * internal->mu / (double) (internal->ved[j - 1] * internal->nu + (1 - internal->ved[j - 1]) * internal->mu) * A[internal->dim_A_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_ST_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ST_2; ++j) {
      internal->n_ST[i - 1 + internal->dim_n_ST_1 * (j - 1)] = internal->mu * S[internal->dim_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_TU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_TU_2; ++j) {
      internal->n_TU[i - 1 + internal->dim_n_TU_1 * (j - 1)] = internal->rho * T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_UI_1; ++i) {
    for (int j = 1; j <= internal->dim_n_UI_2; ++j) {
      internal->n_UI[i - 1 + internal->dim_n_UI_1 * (j - 1)] = internal->lambda * (1 - internal->vea[j - 1]) * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_pye_trial_1; ++i) {
    for (int j = 1; j <= internal->dim_pye_trial_2; ++j) {
      internal->pye_trial[i - 1 + internal->dim_pye_trial_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_screened_2; ++j) {
      internal->screened[i - 1 + internal->dim_screened_1 * (j - 1)] = internal->eta * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_wA_1; ++i) {
    for (int j = 1; j <= internal->dim_wA_2; ++j) {
      for (int k = 1; k <= internal->dim_wA_3; ++k) {
        internal->wA[i - 1 + internal->dim_wA_1 * (j - 1) + internal->dim_wA_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wI_1; ++i) {
    for (int j = 1; j <= internal->dim_wI_2; ++j) {
      for (int k = 1; k <= internal->dim_wI_3; ++k) {
        internal->wI[i - 1 + internal->dim_wI_1 * (j - 1) + internal->dim_wI_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wS_1; ++i) {
    for (int j = 1; j <= internal->dim_wS_2; ++j) {
      for (int k = 1; k <= internal->dim_wS_3; ++k) {
        internal->wS[i - 1 + internal->dim_wS_1 * (j - 1) + internal->dim_wS_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wT_1; ++i) {
    for (int j = 1; j <= internal->dim_wT_2; ++j) {
      for (int k = 1; k <= internal->dim_wT_3; ++k) {
        internal->wT[i - 1 + internal->dim_wT_1 * (j - 1) + internal->dim_wT_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wU_1; ++i) {
    for (int j = 1; j <= internal->dim_wU_2; ++j) {
      for (int k = 1; k <= internal->dim_wU_3; ++k) {
        internal->wU[i - 1 + internal->dim_wU_1 * (j - 1) + internal->dim_wU_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      dstatedt[internal->offset_variable_A + i - 1 + internal->dim_A_1 * (j - 1)] = (1 - (1 - internal->ves[j - 1]) * internal->psi) * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + odin_sum3(internal->wA, i - 1, i, j - 1, j, 0, internal->dim_wA_3, internal->dim_wA_1, internal->dim_wA_12);
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_a + i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_s + i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      dstatedt[internal->offset_variable_cum_incid + i - 1 + internal->dim_cum_incid_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_trial_pov_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_trial_pov_2; ++j) {
      dstatedt[internal->offset_variable_cum_pye_trial_pov + i - 1 + internal->dim_cum_pye_trial_pov_1 * (j - 1)] = internal->pye_trial[internal->dim_pye_trial_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      dstatedt[internal->offset_variable_cum_screened + i - 1 + internal->dim_cum_screened_1 * (j - 1)] = internal->screened[internal->dim_screened_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      dstatedt[internal->offset_variable_cum_treated + i - 1 + internal->dim_cum_treated_1 * (j - 1)] = internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      dstatedt[internal->dim_U + i - 1 + internal->dim_I_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] + odin_sum3(internal->wI, i - 1, i, j - 1, j, 0, internal->dim_wI_3, internal->dim_wI_1, internal->dim_wI_12);
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      dstatedt[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1)] = (1 - internal->ves[j - 1]) * internal->psi * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + odin_sum3(internal->wS, i - 1, i, j - 1, j, 0, internal->dim_wS_3, internal->dim_wS_1, internal->dim_wS_12);
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      dstatedt[0 + i - 1 + internal->dim_U_1 * (j - 1)] = -(internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1]) + internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wU, i - 1, i, j - 1, j, 0, internal->dim_wU_3, internal->dim_wU_1, internal->dim_wU_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_diag_rec_1; ++i) {
    for (int j = 1; j <= internal->dim_n_diag_rec_2; ++j) {
      for (int k = 1; k <= internal->dim_n_diag_rec_3; ++k) {
        internal->n_diag_rec[i - 1 + internal->dim_n_diag_rec_1 * (j - 1) + internal->dim_n_diag_rec_12 * (k - 1)] = (internal->diag_rec_s[internal->dim_diag_rec_s_12 * (k - 1) + internal->dim_diag_rec_s_1 * (j - 1) + i - 1] * internal->n_ST[internal->dim_n_ST_1 * (k - 1) + i - 1]) + (internal->diag_rec_a[internal->dim_diag_rec_a_12 * (k - 1) + internal->dim_diag_rec_a_1 * (j - 1) + i - 1] * internal->n_AT[internal->dim_n_AT_1 * (k - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      dstatedt[internal->offset_variable_T + i - 1 + internal->dim_T_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wT, i - 1, i, j - 1, j, 0, internal->dim_wT_3, internal->dim_wT_1, internal->dim_wT_12) - odin_sum3(internal->n_diag_rec, i - 1, i, j - 1, j, 0, internal->dim_n_diag_rec_3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_12);
    }
  }
  if (output) {
    double * cum_treated = state + internal->offset_variable_cum_treated;
    double * cum_screened = state + internal->offset_variable_cum_screened;
    output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
    output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
    for (int i = 1; i <= internal->dim_N_1; ++i) {
      for (int j = 1; j <= internal->dim_N_2; ++j) {
        internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
      }
    }
    memcpy(output + 2, internal->N, internal->dim_N * sizeof(double));
  }
}
void model_trial_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  model_trial_rhs((model_trial_internal*)internal, t, state, dstatedt, NULL);
}
void model_trial_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  model_trial_rhs(model_trial_internal_ds, *t, state, dstatedt, output);
}
void model_trial_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p) {
  model_trial_internal *internal = (model_trial_internal*) internal_p;
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double * cum_treated = state + internal->offset_variable_cum_treated;
  double * cum_screened = state + internal->offset_variable_cum_screened;
  output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
  output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  memcpy(output + 2, internal->N, internal->dim_N * sizeof(double));
}
SEXP model_trial_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  model_trial_internal *internal = model_trial_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, internal->dim_N + 2));
  setAttrib(dstatedt, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  model_trial_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
model_trial_stochastic_internal* model_trial_stochastic_get_internal(SEXP internal_p, int closed_error) {
  model_trial_stochastic_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (model_trial_stochastic_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void model_trial_stochastic_finalise(SEXP internal_p) {
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 0);
  if (internal_p) {
    R_Free(internal->A0);
    R_Free(internal->D);
    R_Free(internal->diag_rec_a);
    R_Free(internal->diag_rec_s);
    R_Free(internal->I0);
    R_Free(internal->initial_A);
    R_Free(internal->initial_cum_diag_a);
    R_Free(internal->initial_cum_diag_s);
    R_Free(internal->initial_cum_incid);
    R_Free(internal->initial_cum_pye_trial_pov);
    R_Free(internal->initial_cum_pye_true);
    R_Free(internal->initial_cum_screened);
    R_Free(internal->initial_cum_treated);
    R_Free(internal->initial_I);
    R_Free(internal->initial_S);
    R_Free(internal->initial_T);
    R_Free(internal->initial_U);
    R_Free(internal->N);
    R_Free(internal->n_A_ext);
    R_Free(internal->n_AT);
    R_Free(internal->n_AU);
    R_Free(internal->n_AUT);
    R_Free(internal->n_Aw);
    R_Free(internal->n_diag_rec);
    R_Free(internal->n_I_ext);
    R_Free(internal->n_IA);
    R_Free(internal->n_IAS);
    R_Free(internal->n_IS);
    R_Free(internal->n_Iw);
    R_Free(internal->n_S_ext);
    R_Free(internal->n_ST);
    R_Free(internal->n_Sw);
    R_Free(internal->n_T_ext);
    R_Free(internal->n_TU);
    R_Free(internal->n_Tw);
    R_Free(internal->n_U_ext);
    R_Free(internal->n_UI);
    R_Free(internal->n_Uw);
    R_Free(internal->p_A_ext);
    R_Free(internal->p_I_ext);
    R_Free(internal->p_S_ext);
    R_Free(internal->p_T_ext);
    R_Free(internal->p_U_ext);
    R_Free(internal->pye_trial);
    R_Free(internal->r_AT);
    R_Free(internal->r_AU);
    R_Free(internal->Rel_A);
    R_Free(internal->Rel_I);
    R_Free(internal->Rel_S);
    R_Free(internal->Rel_T);
    R_Free(internal->Rel_U);
    R_Free(internal->S0);
    R_Free(internal->screened);
    R_Free(internal->T0);
    R_Free(internal->U0);
    R_Free(internal->vea);
    R_Free(internal->ved);
    R_Free(internal->ves);
    R_Free(internal->w);
    R_Free(internal->wA);
    R_Free(internal->wI);
    R_Free(internal->wS);
    R_Free(internal->wT);
    R_Free(internal->wU);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP model_trial_stochastic_create(SEXP user) {
  model_trial_stochastic_internal *internal = (model_trial_stochastic_internal*) R_Calloc(1, model_trial_stochastic_internal);
  internal->A0 = NULL;
  internal->D = NULL;
  internal->diag_rec_a = NULL;
  internal->diag_rec_s = NULL;
  internal->I0 = NULL;
  internal->initial_A = NULL;
  internal->initial_cum_diag_a = NULL;
  internal->initial_cum_diag_s = NULL;
  internal->initial_cum_incid = NULL;
  internal->initial_cum_pye_trial_pov = NULL;
  internal->initial_cum_pye_true = NULL;
  internal->initial_cum_screened = NULL;
  internal->initial_cum_treated = NULL;
  internal->initial_I = NULL;
  internal->initial_S = NULL;
  internal->initial_T = NULL;
  internal->initial_U = NULL;
  internal->N = NULL;
  internal->n_A_ext = NULL;
  internal->n_AT = NULL;
  internal->n_AU = NULL;
  internal->n_AUT = NULL;
  internal->n_Aw = NULL;
  internal->n_diag_rec = NULL;
  internal->n_I_ext = NULL;
  internal->n_IA = NULL;
  internal->n_IAS = NULL;
  internal->n_IS = NULL;
  internal->n_Iw = NULL;
  internal->n_S_ext = NULL;
  internal->n_ST = NULL;
  internal->n_Sw = NULL;
  internal->n_T_ext = NULL;
  internal->n_TU = NULL;
  internal->n_Tw = NULL;
  internal->n_U_ext = NULL;
  internal->n_UI = NULL;
  internal->n_Uw = NULL;
  internal->p_A_ext = NULL;
  internal->p_I_ext = NULL;
  internal->p_S_ext = NULL;
  internal->p_T_ext = NULL;
  internal->p_U_ext = NULL;
  internal->pye_trial = NULL;
  internal->r_AT = NULL;
  internal->r_AU = NULL;
  internal->Rel_A = NULL;
  internal->Rel_I = NULL;
  internal->Rel_S = NULL;
  internal->Rel_T = NULL;
  internal->Rel_U = NULL;
  internal->S0 = NULL;
  internal->screened = NULL;
  internal->T0 = NULL;
  internal->U0 = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->ves = NULL;
  internal->w = NULL;
  internal->wA = NULL;
  internal->wI = NULL;
  internal->wS = NULL;
  internal->wT = NULL;
  internal->wU = NULL;
  internal->initial_time = 0;
  internal->n_group = 2;
  internal->steps_per_year = 365;
  internal->dt = 1 / (double) internal->steps_per_year;
  internal->A0 = NULL;
  internal->D = NULL;
  internal->diag_rec_a = NULL;
  internal->diag_rec_s = NULL;
  internal->eta = NA_REAL;
  internal->I0 = NULL;
  internal->lambda = NA_REAL;
  internal->mu = NA_REAL;
  internal->nu = NA_REAL;
  internal->psi = NA_REAL;
  internal->rho = NA_REAL;
  internal->S0 = NULL;
  internal->sigma = NA_REAL;
  internal->T0 = NULL;
  internal->U0 = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->ves = NULL;
  internal->w = NULL;
  internal->n_vax = 1;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, model_trial_stochastic_finalise);
  UNPROTECT(1);
  return ptr;
}
static model_trial_stochastic_internal *model_trial_stochastic_internal_ds;
void model_trial_stochastic_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  model_trial_stochastic_internal_ds = model_trial_stochastic_get_internal(get_desolve_gparms(), 1);
}
SEXP model_trial_stochastic_contents(SEXP internal_p) {
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 287));
  SEXP A0 = PROTECT(allocVector(REALSXP, internal->dim_A0));
  memcpy(REAL(A0), internal->A0, internal->dim_A0 * sizeof(double));
  odin_set_dim(A0, 2, internal->dim_A0_1, internal->dim_A0_2);
  SET_VECTOR_ELT(contents, 0, A0);
  SEXP D = PROTECT(allocVector(REALSXP, internal->dim_D));
  memcpy(REAL(D), internal->D, internal->dim_D * sizeof(double));
  SET_VECTOR_ELT(contents, 1, D);
  SEXP diag_rec_a = PROTECT(allocVector(REALSXP, internal->dim_diag_rec_a));
  memcpy(REAL(diag_rec_a), internal->diag_rec_a, internal->dim_diag_rec_a * sizeof(double));
  odin_set_dim(diag_rec_a, 3, internal->dim_diag_rec_a_1, internal->dim_diag_rec_a_2, internal->dim_diag_rec_a_3);
  SET_VECTOR_ELT(contents, 2, diag_rec_a);
  SEXP diag_rec_s = PROTECT(allocVector(REALSXP, internal->dim_diag_rec_s));
  memcpy(REAL(diag_rec_s), internal->diag_rec_s, internal->dim_diag_rec_s * sizeof(double));
  odin_set_dim(diag_rec_s, 3, internal->dim_diag_rec_s_1, internal->dim_diag_rec_s_2, internal->dim_diag_rec_s_3);
  SET_VECTOR_ELT(contents, 3, diag_rec_s);
  SET_VECTOR_ELT(contents, 4, ScalarInteger(internal->dim_A));
  SET_VECTOR_ELT(contents, 5, ScalarInteger(internal->dim_A_1));
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_A_2));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_A0));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_A0_1));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_A0_2));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_cum_diag_a));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_cum_diag_a_1));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_cum_diag_a_2));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_cum_diag_s));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_cum_diag_s_1));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_cum_diag_s_2));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_cum_incid));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_cum_incid_1));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_cum_incid_2));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_cum_pye_trial_pov));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_cum_pye_trial_pov_1));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_cum_pye_trial_pov_2));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_cum_pye_true));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_cum_pye_true_1));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_cum_pye_true_2));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_cum_screened));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_cum_screened_1));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_cum_screened_2));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_cum_treated));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_cum_treated_1));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_cum_treated_2));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_D));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_diag_rec_a));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_diag_rec_a_1));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_diag_rec_a_12));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_diag_rec_a_2));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_diag_rec_a_3));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_diag_rec_s));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_diag_rec_s_1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_diag_rec_s_12));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_diag_rec_s_2));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_diag_rec_s_3));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_I_1));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_I_2));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_I0));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_I0_1));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_I0_2));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_n_A_ext));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_n_A_ext_1));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_n_A_ext_2));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_n_AT));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_n_AT_1));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_n_AT_2));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_n_AU));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_n_AU_1));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_n_AU_2));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_n_AUT));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_n_AUT_1));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_n_AUT_2));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_n_Aw));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_n_Aw_1));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_n_Aw_2));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_n_diag_rec));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_n_diag_rec_1));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_n_diag_rec_12));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_n_diag_rec_2));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_n_diag_rec_3));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_n_I_ext));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_n_I_ext_1));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_n_I_ext_2));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_n_IA));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_n_IA_1));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_n_IA_2));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_n_IAS));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_n_IAS_1));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_n_IAS_2));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_n_IS));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_n_IS_1));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_n_IS_2));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_n_Iw));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_n_Iw_1));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_n_Iw_2));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_n_S_ext));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_n_S_ext_1));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_n_S_ext_2));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_n_ST));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_n_ST_1));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_n_ST_2));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_n_Sw));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_n_Sw_1));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_n_Sw_2));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_n_T_ext));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_n_T_ext_1));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_n_T_ext_2));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_n_TU));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_n_TU_1));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_n_TU_2));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_n_Tw));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_n_Tw_1));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_n_Tw_2));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_n_U_ext));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_n_U_ext_1));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_n_U_ext_2));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_n_UI));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_n_UI_1));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_n_UI_2));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_n_Uw));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_n_Uw_1));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_n_Uw_2));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_p_A_ext));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_p_A_ext_1));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_p_A_ext_2));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_p_I_ext));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_p_I_ext_1));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_p_I_ext_2));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_p_S_ext));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_p_S_ext_1));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_p_S_ext_2));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_p_T_ext));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_p_T_ext_1));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_p_T_ext_2));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_p_U_ext));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_p_U_ext_1));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_p_U_ext_2));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_pye_trial));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_pye_trial_1));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_pye_trial_2));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_r_AT));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_r_AT_1));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_r_AT_2));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_r_AU));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_r_AU_1));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_r_AU_2));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_Rel_A));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_Rel_A_1));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_Rel_A_2));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_Rel_I));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_Rel_I_1));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_Rel_I_2));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_Rel_S));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_Rel_S_1));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_Rel_S_2));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_Rel_T));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_Rel_T_1));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_Rel_T_2));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_Rel_U));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_Rel_U_1));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_Rel_U_2));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_S0));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_S0_1));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_S0_2));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_screened));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_screened_1));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_screened_2));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_T));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_T_1));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_T_2));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_T0));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_T0_1));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_T0_2));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_U));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_U_1));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_U_2));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_U0));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_U0_1));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_U0_2));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_vea));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_ved));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_ves));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_w));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_w_1));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_w_2));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_wA));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_wA_1));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_wA_12));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_wA_2));
  SET_VECTOR_ELT(contents, 183, ScalarInteger(internal->dim_wA_3));
  SET_VECTOR_ELT(contents, 184, ScalarInteger(internal->dim_wI));
  SET_VECTOR_ELT(contents, 185, ScalarInteger(internal->dim_wI_1));
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->dim_wI_12));
  SET_VECTOR_ELT(contents, 187, ScalarInteger(internal->dim_wI_2));
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->dim_wI_3));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->dim_wS));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->dim_wS_1));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->dim_wS_12));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->dim_wS_2));
  SET_VECTOR_ELT(contents, 193, ScalarInteger(internal->dim_wS_3));
  SET_VECTOR_ELT(contents, 194, ScalarInteger(internal->dim_wT));
  SET_VECTOR_ELT(contents, 195, ScalarInteger(internal->dim_wT_1));
  SET_VECTOR_ELT(contents, 196, ScalarInteger(internal->dim_wT_12));
  SET_VECTOR_ELT(contents, 197, ScalarInteger(internal->dim_wT_2));
  SET_VECTOR_ELT(contents, 198, ScalarInteger(internal->dim_wT_3));
  SET_VECTOR_ELT(contents, 199, ScalarInteger(internal->dim_wU));
  SET_VECTOR_ELT(contents, 200, ScalarInteger(internal->dim_wU_1));
  SET_VECTOR_ELT(contents, 201, ScalarInteger(internal->dim_wU_12));
  SET_VECTOR_ELT(contents, 202, ScalarInteger(internal->dim_wU_2));
  SET_VECTOR_ELT(contents, 203, ScalarInteger(internal->dim_wU_3));
  SET_VECTOR_ELT(contents, 204, ScalarReal(internal->dt));
  SET_VECTOR_ELT(contents, 205, ScalarReal(internal->eta));
  SEXP I0 = PROTECT(allocVector(REALSXP, internal->dim_I0));
  memcpy(REAL(I0), internal->I0, internal->dim_I0 * sizeof(double));
  odin_set_dim(I0, 2, internal->dim_I0_1, internal->dim_I0_2);
  SET_VECTOR_ELT(contents, 206, I0);
  SEXP initial_A = PROTECT(allocVector(REALSXP, internal->dim_A));
  memcpy(REAL(initial_A), internal->initial_A, internal->dim_A * sizeof(double));
  odin_set_dim(initial_A, 2, internal->dim_A_1, internal->dim_A_2);
  SET_VECTOR_ELT(contents, 207, initial_A);
  SEXP initial_cum_diag_a = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_a));
  memcpy(REAL(initial_cum_diag_a), internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  odin_set_dim(initial_cum_diag_a, 2, internal->dim_cum_diag_a_1, internal->dim_cum_diag_a_2);
  SET_VECTOR_ELT(contents, 208, initial_cum_diag_a);
  SEXP initial_cum_diag_s = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_s));
  memcpy(REAL(initial_cum_diag_s), internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  odin_set_dim(initial_cum_diag_s, 2, internal->dim_cum_diag_s_1, internal->dim_cum_diag_s_2);
  SET_VECTOR_ELT(contents, 209, initial_cum_diag_s);
  SEXP initial_cum_incid = PROTECT(allocVector(REALSXP, internal->dim_cum_incid));
  memcpy(REAL(initial_cum_incid), internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  odin_set_dim(initial_cum_incid, 2, internal->dim_cum_incid_1, internal->dim_cum_incid_2);
  SET_VECTOR_ELT(contents, 210, initial_cum_incid);
  SEXP initial_cum_pye_trial_pov = PROTECT(allocVector(REALSXP, internal->dim_cum_pye_trial_pov));
  memcpy(REAL(initial_cum_pye_trial_pov), internal->initial_cum_pye_trial_pov, internal->dim_cum_pye_trial_pov * sizeof(double));
  odin_set_dim(initial_cum_pye_trial_pov, 2, internal->dim_cum_pye_trial_pov_1, internal->dim_cum_pye_trial_pov_2);
  SET_VECTOR_ELT(contents, 211, initial_cum_pye_trial_pov);
  SEXP initial_cum_pye_true = PROTECT(allocVector(REALSXP, internal->dim_cum_pye_true));
  memcpy(REAL(initial_cum_pye_true), internal->initial_cum_pye_true, internal->dim_cum_pye_true * sizeof(double));
  odin_set_dim(initial_cum_pye_true, 2, internal->dim_cum_pye_true_1, internal->dim_cum_pye_true_2);
  SET_VECTOR_ELT(contents, 212, initial_cum_pye_true);
  SEXP initial_cum_screened = PROTECT(allocVector(REALSXP, internal->dim_cum_screened));
  memcpy(REAL(initial_cum_screened), internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  odin_set_dim(initial_cum_screened, 2, internal->dim_cum_screened_1, internal->dim_cum_screened_2);
  SET_VECTOR_ELT(contents, 213, initial_cum_screened);
  SEXP initial_cum_treated = PROTECT(allocVector(REALSXP, internal->dim_cum_treated));
  memcpy(REAL(initial_cum_treated), internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  odin_set_dim(initial_cum_treated, 2, internal->dim_cum_treated_1, internal->dim_cum_treated_2);
  SET_VECTOR_ELT(contents, 214, initial_cum_treated);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  odin_set_dim(initial_I, 2, internal->dim_I_1, internal->dim_I_2);
  SET_VECTOR_ELT(contents, 215, initial_I);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 2, internal->dim_S_1, internal->dim_S_2);
  SET_VECTOR_ELT(contents, 216, initial_S);
  SEXP initial_T = PROTECT(allocVector(REALSXP, internal->dim_T));
  memcpy(REAL(initial_T), internal->initial_T, internal->dim_T * sizeof(double));
  odin_set_dim(initial_T, 2, internal->dim_T_1, internal->dim_T_2);
  SET_VECTOR_ELT(contents, 217, initial_T);
  SET_VECTOR_ELT(contents, 218, ScalarReal(internal->initial_time));
  SEXP initial_U = PROTECT(allocVector(REALSXP, internal->dim_U));
  memcpy(REAL(initial_U), internal->initial_U, internal->dim_U * sizeof(double));
  odin_set_dim(initial_U, 2, internal->dim_U_1, internal->dim_U_2);
  SET_VECTOR_ELT(contents, 219, initial_U);
  SET_VECTOR_ELT(contents, 220, ScalarReal(internal->lambda));
  SET_VECTOR_ELT(contents, 221, ScalarReal(internal->mu));
  SEXP N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(N), internal->N, internal->dim_N * sizeof(double));
  odin_set_dim(N, 2, internal->dim_N_1, internal->dim_N_2);
  SET_VECTOR_ELT(contents, 222, N);
  SEXP n_A_ext = PROTECT(allocVector(REALSXP, internal->dim_n_A_ext));
  memcpy(REAL(n_A_ext), internal->n_A_ext, internal->dim_n_A_ext * sizeof(double));
  odin_set_dim(n_A_ext, 2, internal->dim_n_A_ext_1, internal->dim_n_A_ext_2);
  SET_VECTOR_ELT(contents, 223, n_A_ext);
  SEXP n_AT = PROTECT(allocVector(REALSXP, internal->dim_n_AT));
  memcpy(REAL(n_AT), internal->n_AT, internal->dim_n_AT * sizeof(double));
  odin_set_dim(n_AT, 2, internal->dim_n_AT_1, internal->dim_n_AT_2);
  SET_VECTOR_ELT(contents, 224, n_AT);
  SEXP n_AU = PROTECT(allocVector(REALSXP, internal->dim_n_AU));
  memcpy(REAL(n_AU), internal->n_AU, internal->dim_n_AU * sizeof(double));
  odin_set_dim(n_AU, 2, internal->dim_n_AU_1, internal->dim_n_AU_2);
  SET_VECTOR_ELT(contents, 225, n_AU);
  SEXP n_AUT = PROTECT(allocVector(REALSXP, internal->dim_n_AUT));
  memcpy(REAL(n_AUT), internal->n_AUT, internal->dim_n_AUT * sizeof(double));
  odin_set_dim(n_AUT, 2, internal->dim_n_AUT_1, internal->dim_n_AUT_2);
  SET_VECTOR_ELT(contents, 226, n_AUT);
  SEXP n_Aw = PROTECT(allocVector(REALSXP, internal->dim_n_Aw));
  memcpy(REAL(n_Aw), internal->n_Aw, internal->dim_n_Aw * sizeof(double));
  odin_set_dim(n_Aw, 2, internal->dim_n_Aw_1, internal->dim_n_Aw_2);
  SET_VECTOR_ELT(contents, 227, n_Aw);
  SEXP n_diag_rec = PROTECT(allocVector(REALSXP, internal->dim_n_diag_rec));
  memcpy(REAL(n_diag_rec), internal->n_diag_rec, internal->dim_n_diag_rec * sizeof(double));
  odin_set_dim(n_diag_rec, 3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_2, internal->dim_n_diag_rec_3);
  SET_VECTOR_ELT(contents, 228, n_diag_rec);
  SET_VECTOR_ELT(contents, 229, ScalarInteger(internal->n_group));
  SEXP n_I_ext = PROTECT(allocVector(REALSXP, internal->dim_n_I_ext));
  memcpy(REAL(n_I_ext), internal->n_I_ext, internal->dim_n_I_ext * sizeof(double));
  odin_set_dim(n_I_ext, 2, internal->dim_n_I_ext_1, internal->dim_n_I_ext_2);
  SET_VECTOR_ELT(contents, 230, n_I_ext);
  SEXP n_IA = PROTECT(allocVector(REALSXP, internal->dim_n_IA));
  memcpy(REAL(n_IA), internal->n_IA, internal->dim_n_IA * sizeof(double));
  odin_set_dim(n_IA, 2, internal->dim_n_IA_1, internal->dim_n_IA_2);
  SET_VECTOR_ELT(contents, 231, n_IA);
  SEXP n_IAS = PROTECT(allocVector(REALSXP, internal->dim_n_IAS));
  memcpy(REAL(n_IAS), internal->n_IAS, internal->dim_n_IAS * sizeof(double));
  odin_set_dim(n_IAS, 2, internal->dim_n_IAS_1, internal->dim_n_IAS_2);
  SET_VECTOR_ELT(contents, 232, n_IAS);
  SEXP n_IS = PROTECT(allocVector(REALSXP, internal->dim_n_IS));
  memcpy(REAL(n_IS), internal->n_IS, internal->dim_n_IS * sizeof(double));
  odin_set_dim(n_IS, 2, internal->dim_n_IS_1, internal->dim_n_IS_2);
  SET_VECTOR_ELT(contents, 233, n_IS);
  SEXP n_Iw = PROTECT(allocVector(REALSXP, internal->dim_n_Iw));
  memcpy(REAL(n_Iw), internal->n_Iw, internal->dim_n_Iw * sizeof(double));
  odin_set_dim(n_Iw, 2, internal->dim_n_Iw_1, internal->dim_n_Iw_2);
  SET_VECTOR_ELT(contents, 234, n_Iw);
  SEXP n_S_ext = PROTECT(allocVector(REALSXP, internal->dim_n_S_ext));
  memcpy(REAL(n_S_ext), internal->n_S_ext, internal->dim_n_S_ext * sizeof(double));
  odin_set_dim(n_S_ext, 2, internal->dim_n_S_ext_1, internal->dim_n_S_ext_2);
  SET_VECTOR_ELT(contents, 235, n_S_ext);
  SEXP n_ST = PROTECT(allocVector(REALSXP, internal->dim_n_ST));
  memcpy(REAL(n_ST), internal->n_ST, internal->dim_n_ST * sizeof(double));
  odin_set_dim(n_ST, 2, internal->dim_n_ST_1, internal->dim_n_ST_2);
  SET_VECTOR_ELT(contents, 236, n_ST);
  SEXP n_Sw = PROTECT(allocVector(REALSXP, internal->dim_n_Sw));
  memcpy(REAL(n_Sw), internal->n_Sw, internal->dim_n_Sw * sizeof(double));
  odin_set_dim(n_Sw, 2, internal->dim_n_Sw_1, internal->dim_n_Sw_2);
  SET_VECTOR_ELT(contents, 237, n_Sw);
  SEXP n_T_ext = PROTECT(allocVector(REALSXP, internal->dim_n_T_ext));
  memcpy(REAL(n_T_ext), internal->n_T_ext, internal->dim_n_T_ext * sizeof(double));
  odin_set_dim(n_T_ext, 2, internal->dim_n_T_ext_1, internal->dim_n_T_ext_2);
  SET_VECTOR_ELT(contents, 238, n_T_ext);
  SEXP n_TU = PROTECT(allocVector(REALSXP, internal->dim_n_TU));
  memcpy(REAL(n_TU), internal->n_TU, internal->dim_n_TU * sizeof(double));
  odin_set_dim(n_TU, 2, internal->dim_n_TU_1, internal->dim_n_TU_2);
  SET_VECTOR_ELT(contents, 239, n_TU);
  SEXP n_Tw = PROTECT(allocVector(REALSXP, internal->dim_n_Tw));
  memcpy(REAL(n_Tw), internal->n_Tw, internal->dim_n_Tw * sizeof(double));
  odin_set_dim(n_Tw, 2, internal->dim_n_Tw_1, internal->dim_n_Tw_2);
  SET_VECTOR_ELT(contents, 240, n_Tw);
  SEXP n_U_ext = PROTECT(allocVector(REALSXP, internal->dim_n_U_ext));
  memcpy(REAL(n_U_ext), internal->n_U_ext, internal->dim_n_U_ext * sizeof(double));
  odin_set_dim(n_U_ext, 2, internal->dim_n_U_ext_1, internal->dim_n_U_ext_2);
  SET_VECTOR_ELT(contents, 241, n_U_ext);
  SEXP n_UI = PROTECT(allocVector(REALSXP, internal->dim_n_UI));
  memcpy(REAL(n_UI), internal->n_UI, internal->dim_n_UI * sizeof(double));
  odin_set_dim(n_UI, 2, internal->dim_n_UI_1, internal->dim_n_UI_2);
  SET_VECTOR_ELT(contents, 242, n_UI);
  SEXP n_Uw = PROTECT(allocVector(REALSXP, internal->dim_n_Uw));
  memcpy(REAL(n_Uw), internal->n_Uw, internal->dim_n_Uw * sizeof(double));
  odin_set_dim(n_Uw, 2, internal->dim_n_Uw_1, internal->dim_n_Uw_2);
  SET_VECTOR_ELT(contents, 243, n_Uw);
  SET_VECTOR_ELT(contents, 244, ScalarInteger(internal->n_vax));
  SET_VECTOR_ELT(contents, 245, ScalarReal(internal->nu));
  SET_VECTOR_ELT(contents, 246, ScalarInteger(internal->offset_variable_A));
  SET_VECTOR_ELT(contents, 247, ScalarInteger(internal->offset_variable_cum_diag_a));
  SET_VECTOR_ELT(contents, 248, ScalarInteger(internal->offset_variable_cum_diag_s));
  SET_VECTOR_ELT(contents, 249, ScalarInteger(internal->offset_variable_cum_incid));
  SET_VECTOR_ELT(contents, 250, ScalarInteger(internal->offset_variable_cum_pye_trial_pov));
  SET_VECTOR_ELT(contents, 251, ScalarInteger(internal->offset_variable_cum_pye_true));
  SET_VECTOR_ELT(contents, 252, ScalarInteger(internal->offset_variable_cum_screened));
  SET_VECTOR_ELT(contents, 253, ScalarInteger(internal->offset_variable_cum_treated));
  SET_VECTOR_ELT(contents, 254, ScalarInteger(internal->offset_variable_I));
  SET_VECTOR_ELT(contents, 255, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 256, ScalarInteger(internal->offset_variable_T));
  SEXP p_A_ext = PROTECT(allocVector(REALSXP, internal->dim_p_A_ext));
  memcpy(REAL(p_A_ext), internal->p_A_ext, internal->dim_p_A_ext * sizeof(double));
  odin_set_dim(p_A_ext, 2, internal->dim_p_A_ext_1, internal->dim_p_A_ext_2);
  SET_VECTOR_ELT(contents, 257, p_A_ext);
  SEXP p_I_ext = PROTECT(allocVector(REALSXP, internal->dim_p_I_ext));
  memcpy(REAL(p_I_ext), internal->p_I_ext, internal->dim_p_I_ext * sizeof(double));
  odin_set_dim(p_I_ext, 2, internal->dim_p_I_ext_1, internal->dim_p_I_ext_2);
  SET_VECTOR_ELT(contents, 258, p_I_ext);
  SEXP p_S_ext = PROTECT(allocVector(REALSXP, internal->dim_p_S_ext));
  memcpy(REAL(p_S_ext), internal->p_S_ext, internal->dim_p_S_ext * sizeof(double));
  odin_set_dim(p_S_ext, 2, internal->dim_p_S_ext_1, internal->dim_p_S_ext_2);
  SET_VECTOR_ELT(contents, 259, p_S_ext);
  SEXP p_T_ext = PROTECT(allocVector(REALSXP, internal->dim_p_T_ext));
  memcpy(REAL(p_T_ext), internal->p_T_ext, internal->dim_p_T_ext * sizeof(double));
  odin_set_dim(p_T_ext, 2, internal->dim_p_T_ext_1, internal->dim_p_T_ext_2);
  SET_VECTOR_ELT(contents, 260, p_T_ext);
  SEXP p_U_ext = PROTECT(allocVector(REALSXP, internal->dim_p_U_ext));
  memcpy(REAL(p_U_ext), internal->p_U_ext, internal->dim_p_U_ext * sizeof(double));
  odin_set_dim(p_U_ext, 2, internal->dim_p_U_ext_1, internal->dim_p_U_ext_2);
  SET_VECTOR_ELT(contents, 261, p_U_ext);
  SET_VECTOR_ELT(contents, 262, ScalarReal(internal->psi));
  SEXP pye_trial = PROTECT(allocVector(REALSXP, internal->dim_pye_trial));
  memcpy(REAL(pye_trial), internal->pye_trial, internal->dim_pye_trial * sizeof(double));
  odin_set_dim(pye_trial, 2, internal->dim_pye_trial_1, internal->dim_pye_trial_2);
  SET_VECTOR_ELT(contents, 263, pye_trial);
  SEXP r_AT = PROTECT(allocVector(REALSXP, internal->dim_r_AT));
  memcpy(REAL(r_AT), internal->r_AT, internal->dim_r_AT * sizeof(double));
  odin_set_dim(r_AT, 2, internal->dim_r_AT_1, internal->dim_r_AT_2);
  SET_VECTOR_ELT(contents, 264, r_AT);
  SEXP r_AU = PROTECT(allocVector(REALSXP, internal->dim_r_AU));
  memcpy(REAL(r_AU), internal->r_AU, internal->dim_r_AU * sizeof(double));
  odin_set_dim(r_AU, 2, internal->dim_r_AU_1, internal->dim_r_AU_2);
  SET_VECTOR_ELT(contents, 265, r_AU);
  SEXP Rel_A = PROTECT(allocVector(REALSXP, internal->dim_Rel_A));
  memcpy(REAL(Rel_A), internal->Rel_A, internal->dim_Rel_A * sizeof(double));
  odin_set_dim(Rel_A, 2, internal->dim_Rel_A_1, internal->dim_Rel_A_2);
  SET_VECTOR_ELT(contents, 266, Rel_A);
  SEXP Rel_I = PROTECT(allocVector(REALSXP, internal->dim_Rel_I));
  memcpy(REAL(Rel_I), internal->Rel_I, internal->dim_Rel_I * sizeof(double));
  odin_set_dim(Rel_I, 2, internal->dim_Rel_I_1, internal->dim_Rel_I_2);
  SET_VECTOR_ELT(contents, 267, Rel_I);
  SEXP Rel_S = PROTECT(allocVector(REALSXP, internal->dim_Rel_S));
  memcpy(REAL(Rel_S), internal->Rel_S, internal->dim_Rel_S * sizeof(double));
  odin_set_dim(Rel_S, 2, internal->dim_Rel_S_1, internal->dim_Rel_S_2);
  SET_VECTOR_ELT(contents, 268, Rel_S);
  SEXP Rel_T = PROTECT(allocVector(REALSXP, internal->dim_Rel_T));
  memcpy(REAL(Rel_T), internal->Rel_T, internal->dim_Rel_T * sizeof(double));
  odin_set_dim(Rel_T, 2, internal->dim_Rel_T_1, internal->dim_Rel_T_2);
  SET_VECTOR_ELT(contents, 269, Rel_T);
  SEXP Rel_U = PROTECT(allocVector(REALSXP, internal->dim_Rel_U));
  memcpy(REAL(Rel_U), internal->Rel_U, internal->dim_Rel_U * sizeof(double));
  odin_set_dim(Rel_U, 2, internal->dim_Rel_U_1, internal->dim_Rel_U_2);
  SET_VECTOR_ELT(contents, 270, Rel_U);
  SET_VECTOR_ELT(contents, 271, ScalarReal(internal->rho));
  SEXP S0 = PROTECT(allocVector(REALSXP, internal->dim_S0));
  memcpy(REAL(S0), internal->S0, internal->dim_S0 * sizeof(double));
  odin_set_dim(S0, 2, internal->dim_S0_1, internal->dim_S0_2);
  SET_VECTOR_ELT(contents, 272, S0);
  SEXP screened = PROTECT(allocVector(REALSXP, internal->dim_screened));
  memcpy(REAL(screened), internal->screened, internal->dim_screened * sizeof(double));
  odin_set_dim(screened, 2, internal->dim_screened_1, internal->dim_screened_2);
  SET_VECTOR_ELT(contents, 273, screened);
  SET_VECTOR_ELT(contents, 274, ScalarReal(internal->sigma));
  SET_VECTOR_ELT(contents, 275, ScalarReal(internal->steps_per_year));
  SEXP T0 = PROTECT(allocVector(REALSXP, internal->dim_T0));
  memcpy(REAL(T0), internal->T0, internal->dim_T0 * sizeof(double));
  odin_set_dim(T0, 2, internal->dim_T0_1, internal->dim_T0_2);
  SET_VECTOR_ELT(contents, 276, T0);
  SEXP U0 = PROTECT(allocVector(REALSXP, internal->dim_U0));
  memcpy(REAL(U0), internal->U0, internal->dim_U0 * sizeof(double));
  odin_set_dim(U0, 2, internal->dim_U0_1, internal->dim_U0_2);
  SET_VECTOR_ELT(contents, 277, U0);
  SEXP vea = PROTECT(allocVector(REALSXP, internal->dim_vea));
  memcpy(REAL(vea), internal->vea, internal->dim_vea * sizeof(double));
  SET_VECTOR_ELT(contents, 278, vea);
  SEXP ved = PROTECT(allocVector(REALSXP, internal->dim_ved));
  memcpy(REAL(ved), internal->ved, internal->dim_ved * sizeof(double));
  SET_VECTOR_ELT(contents, 279, ved);
  SEXP ves = PROTECT(allocVector(REALSXP, internal->dim_ves));
  memcpy(REAL(ves), internal->ves, internal->dim_ves * sizeof(double));
  SET_VECTOR_ELT(contents, 280, ves);
  SEXP w = PROTECT(allocVector(REALSXP, internal->dim_w));
  memcpy(REAL(w), internal->w, internal->dim_w * sizeof(double));
  odin_set_dim(w, 2, internal->dim_w_1, internal->dim_w_2);
  SET_VECTOR_ELT(contents, 281, w);
  SEXP wA = PROTECT(allocVector(REALSXP, internal->dim_wA));
  memcpy(REAL(wA), internal->wA, internal->dim_wA * sizeof(double));
  odin_set_dim(wA, 3, internal->dim_wA_1, internal->dim_wA_2, internal->dim_wA_3);
  SET_VECTOR_ELT(contents, 282, wA);
  SEXP wI = PROTECT(allocVector(REALSXP, internal->dim_wI));
  memcpy(REAL(wI), internal->wI, internal->dim_wI * sizeof(double));
  odin_set_dim(wI, 3, internal->dim_wI_1, internal->dim_wI_2, internal->dim_wI_3);
  SET_VECTOR_ELT(contents, 283, wI);
  SEXP wS = PROTECT(allocVector(REALSXP, internal->dim_wS));
  memcpy(REAL(wS), internal->wS, internal->dim_wS * sizeof(double));
  odin_set_dim(wS, 3, internal->dim_wS_1, internal->dim_wS_2, internal->dim_wS_3);
  SET_VECTOR_ELT(contents, 284, wS);
  SEXP wT = PROTECT(allocVector(REALSXP, internal->dim_wT));
  memcpy(REAL(wT), internal->wT, internal->dim_wT * sizeof(double));
  odin_set_dim(wT, 3, internal->dim_wT_1, internal->dim_wT_2, internal->dim_wT_3);
  SET_VECTOR_ELT(contents, 285, wT);
  SEXP wU = PROTECT(allocVector(REALSXP, internal->dim_wU));
  memcpy(REAL(wU), internal->wU, internal->dim_wU * sizeof(double));
  odin_set_dim(wU, 3, internal->dim_wU_1, internal->dim_wU_2, internal->dim_wU_3);
  SET_VECTOR_ELT(contents, 286, wU);
  SEXP nms = PROTECT(allocVector(STRSXP, 287));
  SET_STRING_ELT(nms, 0, mkChar("A0"));
  SET_STRING_ELT(nms, 1, mkChar("D"));
  SET_STRING_ELT(nms, 2, mkChar("diag_rec_a"));
  SET_STRING_ELT(nms, 3, mkChar("diag_rec_s"));
  SET_STRING_ELT(nms, 4, mkChar("dim_A"));
  SET_STRING_ELT(nms, 5, mkChar("dim_A_1"));
  SET_STRING_ELT(nms, 6, mkChar("dim_A_2"));
  SET_STRING_ELT(nms, 7, mkChar("dim_A0"));
  SET_STRING_ELT(nms, 8, mkChar("dim_A0_1"));
  SET_STRING_ELT(nms, 9, mkChar("dim_A0_2"));
  SET_STRING_ELT(nms, 10, mkChar("dim_cum_diag_a"));
  SET_STRING_ELT(nms, 11, mkChar("dim_cum_diag_a_1"));
  SET_STRING_ELT(nms, 12, mkChar("dim_cum_diag_a_2"));
  SET_STRING_ELT(nms, 13, mkChar("dim_cum_diag_s"));
  SET_STRING_ELT(nms, 14, mkChar("dim_cum_diag_s_1"));
  SET_STRING_ELT(nms, 15, mkChar("dim_cum_diag_s_2"));
  SET_STRING_ELT(nms, 16, mkChar("dim_cum_incid"));
  SET_STRING_ELT(nms, 17, mkChar("dim_cum_incid_1"));
  SET_STRING_ELT(nms, 18, mkChar("dim_cum_incid_2"));
  SET_STRING_ELT(nms, 19, mkChar("dim_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 20, mkChar("dim_cum_pye_trial_pov_1"));
  SET_STRING_ELT(nms, 21, mkChar("dim_cum_pye_trial_pov_2"));
  SET_STRING_ELT(nms, 22, mkChar("dim_cum_pye_true"));
  SET_STRING_ELT(nms, 23, mkChar("dim_cum_pye_true_1"));
  SET_STRING_ELT(nms, 24, mkChar("dim_cum_pye_true_2"));
  SET_STRING_ELT(nms, 25, mkChar("dim_cum_screened"));
  SET_STRING_ELT(nms, 26, mkChar("dim_cum_screened_1"));
  SET_STRING_ELT(nms, 27, mkChar("dim_cum_screened_2"));
  SET_STRING_ELT(nms, 28, mkChar("dim_cum_treated"));
  SET_STRING_ELT(nms, 29, mkChar("dim_cum_treated_1"));
  SET_STRING_ELT(nms, 30, mkChar("dim_cum_treated_2"));
  SET_STRING_ELT(nms, 31, mkChar("dim_D"));
  SET_STRING_ELT(nms, 32, mkChar("dim_diag_rec_a"));
  SET_STRING_ELT(nms, 33, mkChar("dim_diag_rec_a_1"));
  SET_STRING_ELT(nms, 34, mkChar("dim_diag_rec_a_12"));
  SET_STRING_ELT(nms, 35, mkChar("dim_diag_rec_a_2"));
  SET_STRING_ELT(nms, 36, mkChar("dim_diag_rec_a_3"));
  SET_STRING_ELT(nms, 37, mkChar("dim_diag_rec_s"));
  SET_STRING_ELT(nms, 38, mkChar("dim_diag_rec_s_1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_diag_rec_s_12"));
  SET_STRING_ELT(nms, 40, mkChar("dim_diag_rec_s_2"));
  SET_STRING_ELT(nms, 41, mkChar("dim_diag_rec_s_3"));
  SET_STRING_ELT(nms, 42, mkChar("dim_I"));
  SET_STRING_ELT(nms, 43, mkChar("dim_I_1"));
  SET_STRING_ELT(nms, 44, mkChar("dim_I_2"));
  SET_STRING_ELT(nms, 45, mkChar("dim_I0"));
  SET_STRING_ELT(nms, 46, mkChar("dim_I0_1"));
  SET_STRING_ELT(nms, 47, mkChar("dim_I0_2"));
  SET_STRING_ELT(nms, 48, mkChar("dim_N"));
  SET_STRING_ELT(nms, 49, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 50, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 51, mkChar("dim_n_A_ext"));
  SET_STRING_ELT(nms, 52, mkChar("dim_n_A_ext_1"));
  SET_STRING_ELT(nms, 53, mkChar("dim_n_A_ext_2"));
  SET_STRING_ELT(nms, 54, mkChar("dim_n_AT"));
  SET_STRING_ELT(nms, 55, mkChar("dim_n_AT_1"));
  SET_STRING_ELT(nms, 56, mkChar("dim_n_AT_2"));
  SET_STRING_ELT(nms, 57, mkChar("dim_n_AU"));
  SET_STRING_ELT(nms, 58, mkChar("dim_n_AU_1"));
  SET_STRING_ELT(nms, 59, mkChar("dim_n_AU_2"));
  SET_STRING_ELT(nms, 60, mkChar("dim_n_AUT"));
  SET_STRING_ELT(nms, 61, mkChar("dim_n_AUT_1"));
  SET_STRING_ELT(nms, 62, mkChar("dim_n_AUT_2"));
  SET_STRING_ELT(nms, 63, mkChar("dim_n_Aw"));
  SET_STRING_ELT(nms, 64, mkChar("dim_n_Aw_1"));
  SET_STRING_ELT(nms, 65, mkChar("dim_n_Aw_2"));
  SET_STRING_ELT(nms, 66, mkChar("dim_n_diag_rec"));
  SET_STRING_ELT(nms, 67, mkChar("dim_n_diag_rec_1"));
  SET_STRING_ELT(nms, 68, mkChar("dim_n_diag_rec_12"));
  SET_STRING_ELT(nms, 69, mkChar("dim_n_diag_rec_2"));
  SET_STRING_ELT(nms, 70, mkChar("dim_n_diag_rec_3"));
  SET_STRING_ELT(nms, 71, mkChar("dim_n_I_ext"));
  SET_STRING_ELT(nms, 72, mkChar("dim_n_I_ext_1"));
  SET_STRING_ELT(nms, 73, mkChar("dim_n_I_ext_2"));
  SET_STRING_ELT(nms, 74, mkChar("dim_n_IA"));
  SET_STRING_ELT(nms, 75, mkChar("dim_n_IA_1"));
  SET_STRING_ELT(nms, 76, mkChar("dim_n_IA_2"));
  SET_STRING_ELT(nms, 77, mkChar("dim_n_IAS"));
  SET_STRING_ELT(nms, 78, mkChar("dim_n_IAS_1"));
  SET_STRING_ELT(nms, 79, mkChar("dim_n_IAS_2"));
  SET_STRING_ELT(nms, 80, mkChar("dim_n_IS"));
  SET_STRING_ELT(nms, 81, mkChar("dim_n_IS_1"));
  SET_STRING_ELT(nms, 82, mkChar("dim_n_IS_2"));
  SET_STRING_ELT(nms, 83, mkChar("dim_n_Iw"));
  SET_STRING_ELT(nms, 84, mkChar("dim_n_Iw_1"));
  SET_STRING_ELT(nms, 85, mkChar("dim_n_Iw_2"));
  SET_STRING_ELT(nms, 86, mkChar("dim_n_S_ext"));
  SET_STRING_ELT(nms, 87, mkChar("dim_n_S_ext_1"));
  SET_STRING_ELT(nms, 88, mkChar("dim_n_S_ext_2"));
  SET_STRING_ELT(nms, 89, mkChar("dim_n_ST"));
  SET_STRING_ELT(nms, 90, mkChar("dim_n_ST_1"));
  SET_STRING_ELT(nms, 91, mkChar("dim_n_ST_2"));
  SET_STRING_ELT(nms, 92, mkChar("dim_n_Sw"));
  SET_STRING_ELT(nms, 93, mkChar("dim_n_Sw_1"));
  SET_STRING_ELT(nms, 94, mkChar("dim_n_Sw_2"));
  SET_STRING_ELT(nms, 95, mkChar("dim_n_T_ext"));
  SET_STRING_ELT(nms, 96, mkChar("dim_n_T_ext_1"));
  SET_STRING_ELT(nms, 97, mkChar("dim_n_T_ext_2"));
  SET_STRING_ELT(nms, 98, mkChar("dim_n_TU"));
  SET_STRING_ELT(nms, 99, mkChar("dim_n_TU_1"));
  SET_STRING_ELT(nms, 100, mkChar("dim_n_TU_2"));
  SET_STRING_ELT(nms, 101, mkChar("dim_n_Tw"));
  SET_STRING_ELT(nms, 102, mkChar("dim_n_Tw_1"));
  SET_STRING_ELT(nms, 103, mkChar("dim_n_Tw_2"));
  SET_STRING_ELT(nms, 104, mkChar("dim_n_U_ext"));
  SET_STRING_ELT(nms, 105, mkChar("dim_n_U_ext_1"));
  SET_STRING_ELT(nms, 106, mkChar("dim_n_U_ext_2"));
  SET_STRING_ELT(nms, 107, mkChar("dim_n_UI"));
  SET_STRING_ELT(nms, 108, mkChar("dim_n_UI_1"));
  SET_STRING_ELT(nms, 109, mkChar("dim_n_UI_2"));
  SET_STRING_ELT(nms, 110, mkChar("dim_n_Uw"));
  SET_STRING_ELT(nms, 111, mkChar("dim_n_Uw_1"));
  SET_STRING_ELT(nms, 112, mkChar("dim_n_Uw_2"));
  SET_STRING_ELT(nms, 113, mkChar("dim_p_A_ext"));
  SET_STRING_ELT(nms, 114, mkChar("dim_p_A_ext_1"));
  SET_STRING_ELT(nms, 115, mkChar("dim_p_A_ext_2"));
  SET_STRING_ELT(nms, 116, mkChar("dim_p_I_ext"));
  SET_STRING_ELT(nms, 117, mkChar("dim_p_I_ext_1"));
  SET_STRING_ELT(nms, 118, mkChar("dim_p_I_ext_2"));
  SET_STRING_ELT(nms, 119, mkChar("dim_p_S_ext"));
  SET_STRING_ELT(nms, 120, mkChar("dim_p_S_ext_1"));
  SET_STRING_ELT(nms, 121, mkChar("dim_p_S_ext_2"));
  SET_STRING_ELT(nms, 122, mkChar("dim_p_T_ext"));
  SET_STRING_ELT(nms, 123, mkChar("dim_p_T_ext_1"));
  SET_STRING_ELT(nms, 124, mkChar("dim_p_T_ext_2"));
  SET_STRING_ELT(nms, 125, mkChar("dim_p_U_ext"));
  SET_STRING_ELT(nms, 126, mkChar("dim_p_U_ext_1"));
  SET_STRING_ELT(nms, 127, mkChar("dim_p_U_ext_2"));
  SET_STRING_ELT(nms, 128, mkChar("dim_pye_trial"));
  SET_STRING_ELT(nms, 129, mkChar("dim_pye_trial_1"));
  SET_STRING_ELT(nms, 130, mkChar("dim_pye_trial_2"));
  SET_STRING_ELT(nms, 131, mkChar("dim_r_AT"));
  SET_STRING_ELT(nms, 132, mkChar("dim_r_AT_1"));
  SET_STRING_ELT(nms, 133, mkChar("dim_r_AT_2"));
  SET_STRING_ELT(nms, 134, mkChar("dim_r_AU"));
  SET_STRING_ELT(nms, 135, mkChar("dim_r_AU_1"));
  SET_STRING_ELT(nms, 136, mkChar("dim_r_AU_2"));
  SET_STRING_ELT(nms, 137, mkChar("dim_Rel_A"));
  SET_STRING_ELT(nms, 138, mkChar("dim_Rel_A_1"));
  SET_STRING_ELT(nms, 139, mkChar("dim_Rel_A_2"));
  SET_STRING_ELT(nms, 140, mkChar("dim_Rel_I"));
  SET_STRING_ELT(nms, 141, mkChar("dim_Rel_I_1"));
  SET_STRING_ELT(nms, 142, mkChar("dim_Rel_I_2"));
  SET_STRING_ELT(nms, 143, mkChar("dim_Rel_S"));
  SET_STRING_ELT(nms, 144, mkChar("dim_Rel_S_1"));
  SET_STRING_ELT(nms, 145, mkChar("dim_Rel_S_2"));
  SET_STRING_ELT(nms, 146, mkChar("dim_Rel_T"));
  SET_STRING_ELT(nms, 147, mkChar("dim_Rel_T_1"));
  SET_STRING_ELT(nms, 148, mkChar("dim_Rel_T_2"));
  SET_STRING_ELT(nms, 149, mkChar("dim_Rel_U"));
  SET_STRING_ELT(nms, 150, mkChar("dim_Rel_U_1"));
  SET_STRING_ELT(nms, 151, mkChar("dim_Rel_U_2"));
  SET_STRING_ELT(nms, 152, mkChar("dim_S"));
  SET_STRING_ELT(nms, 153, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 154, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 155, mkChar("dim_S0"));
  SET_STRING_ELT(nms, 156, mkChar("dim_S0_1"));
  SET_STRING_ELT(nms, 157, mkChar("dim_S0_2"));
  SET_STRING_ELT(nms, 158, mkChar("dim_screened"));
  SET_STRING_ELT(nms, 159, mkChar("dim_screened_1"));
  SET_STRING_ELT(nms, 160, mkChar("dim_screened_2"));
  SET_STRING_ELT(nms, 161, mkChar("dim_T"));
  SET_STRING_ELT(nms, 162, mkChar("dim_T_1"));
  SET_STRING_ELT(nms, 163, mkChar("dim_T_2"));
  SET_STRING_ELT(nms, 164, mkChar("dim_T0"));
  SET_STRING_ELT(nms, 165, mkChar("dim_T0_1"));
  SET_STRING_ELT(nms, 166, mkChar("dim_T0_2"));
  SET_STRING_ELT(nms, 167, mkChar("dim_U"));
  SET_STRING_ELT(nms, 168, mkChar("dim_U_1"));
  SET_STRING_ELT(nms, 169, mkChar("dim_U_2"));
  SET_STRING_ELT(nms, 170, mkChar("dim_U0"));
  SET_STRING_ELT(nms, 171, mkChar("dim_U0_1"));
  SET_STRING_ELT(nms, 172, mkChar("dim_U0_2"));
  SET_STRING_ELT(nms, 173, mkChar("dim_vea"));
  SET_STRING_ELT(nms, 174, mkChar("dim_ved"));
  SET_STRING_ELT(nms, 175, mkChar("dim_ves"));
  SET_STRING_ELT(nms, 176, mkChar("dim_w"));
  SET_STRING_ELT(nms, 177, mkChar("dim_w_1"));
  SET_STRING_ELT(nms, 178, mkChar("dim_w_2"));
  SET_STRING_ELT(nms, 179, mkChar("dim_wA"));
  SET_STRING_ELT(nms, 180, mkChar("dim_wA_1"));
  SET_STRING_ELT(nms, 181, mkChar("dim_wA_12"));
  SET_STRING_ELT(nms, 182, mkChar("dim_wA_2"));
  SET_STRING_ELT(nms, 183, mkChar("dim_wA_3"));
  SET_STRING_ELT(nms, 184, mkChar("dim_wI"));
  SET_STRING_ELT(nms, 185, mkChar("dim_wI_1"));
  SET_STRING_ELT(nms, 186, mkChar("dim_wI_12"));
  SET_STRING_ELT(nms, 187, mkChar("dim_wI_2"));
  SET_STRING_ELT(nms, 188, mkChar("dim_wI_3"));
  SET_STRING_ELT(nms, 189, mkChar("dim_wS"));
  SET_STRING_ELT(nms, 190, mkChar("dim_wS_1"));
  SET_STRING_ELT(nms, 191, mkChar("dim_wS_12"));
  SET_STRING_ELT(nms, 192, mkChar("dim_wS_2"));
  SET_STRING_ELT(nms, 193, mkChar("dim_wS_3"));
  SET_STRING_ELT(nms, 194, mkChar("dim_wT"));
  SET_STRING_ELT(nms, 195, mkChar("dim_wT_1"));
  SET_STRING_ELT(nms, 196, mkChar("dim_wT_12"));
  SET_STRING_ELT(nms, 197, mkChar("dim_wT_2"));
  SET_STRING_ELT(nms, 198, mkChar("dim_wT_3"));
  SET_STRING_ELT(nms, 199, mkChar("dim_wU"));
  SET_STRING_ELT(nms, 200, mkChar("dim_wU_1"));
  SET_STRING_ELT(nms, 201, mkChar("dim_wU_12"));
  SET_STRING_ELT(nms, 202, mkChar("dim_wU_2"));
  SET_STRING_ELT(nms, 203, mkChar("dim_wU_3"));
  SET_STRING_ELT(nms, 204, mkChar("dt"));
  SET_STRING_ELT(nms, 205, mkChar("eta"));
  SET_STRING_ELT(nms, 206, mkChar("I0"));
  SET_STRING_ELT(nms, 207, mkChar("initial_A"));
  SET_STRING_ELT(nms, 208, mkChar("initial_cum_diag_a"));
  SET_STRING_ELT(nms, 209, mkChar("initial_cum_diag_s"));
  SET_STRING_ELT(nms, 210, mkChar("initial_cum_incid"));
  SET_STRING_ELT(nms, 211, mkChar("initial_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 212, mkChar("initial_cum_pye_true"));
  SET_STRING_ELT(nms, 213, mkChar("initial_cum_screened"));
  SET_STRING_ELT(nms, 214, mkChar("initial_cum_treated"));
  SET_STRING_ELT(nms, 215, mkChar("initial_I"));
  SET_STRING_ELT(nms, 216, mkChar("initial_S"));
  SET_STRING_ELT(nms, 217, mkChar("initial_T"));
  SET_STRING_ELT(nms, 218, mkChar("initial_time"));
  SET_STRING_ELT(nms, 219, mkChar("initial_U"));
  SET_STRING_ELT(nms, 220, mkChar("lambda"));
  SET_STRING_ELT(nms, 221, mkChar("mu"));
  SET_STRING_ELT(nms, 222, mkChar("N"));
  SET_STRING_ELT(nms, 223, mkChar("n_A_ext"));
  SET_STRING_ELT(nms, 224, mkChar("n_AT"));
  SET_STRING_ELT(nms, 225, mkChar("n_AU"));
  SET_STRING_ELT(nms, 226, mkChar("n_AUT"));
  SET_STRING_ELT(nms, 227, mkChar("n_Aw"));
  SET_STRING_ELT(nms, 228, mkChar("n_diag_rec"));
  SET_STRING_ELT(nms, 229, mkChar("n_group"));
  SET_STRING_ELT(nms, 230, mkChar("n_I_ext"));
  SET_STRING_ELT(nms, 231, mkChar("n_IA"));
  SET_STRING_ELT(nms, 232, mkChar("n_IAS"));
  SET_STRING_ELT(nms, 233, mkChar("n_IS"));
  SET_STRING_ELT(nms, 234, mkChar("n_Iw"));
  SET_STRING_ELT(nms, 235, mkChar("n_S_ext"));
  SET_STRING_ELT(nms, 236, mkChar("n_ST"));
  SET_STRING_ELT(nms, 237, mkChar("n_Sw"));
  SET_STRING_ELT(nms, 238, mkChar("n_T_ext"));
  SET_STRING_ELT(nms, 239, mkChar("n_TU"));
  SET_STRING_ELT(nms, 240, mkChar("n_Tw"));
  SET_STRING_ELT(nms, 241, mkChar("n_U_ext"));
  SET_STRING_ELT(nms, 242, mkChar("n_UI"));
  SET_STRING_ELT(nms, 243, mkChar("n_Uw"));
  SET_STRING_ELT(nms, 244, mkChar("n_vax"));
  SET_STRING_ELT(nms, 245, mkChar("nu"));
  SET_STRING_ELT(nms, 246, mkChar("offset_variable_A"));
  SET_STRING_ELT(nms, 247, mkChar("offset_variable_cum_diag_a"));
  SET_STRING_ELT(nms, 248, mkChar("offset_variable_cum_diag_s"));
  SET_STRING_ELT(nms, 249, mkChar("offset_variable_cum_incid"));
  SET_STRING_ELT(nms, 250, mkChar("offset_variable_cum_pye_trial_pov"));
  SET_STRING_ELT(nms, 251, mkChar("offset_variable_cum_pye_true"));
  SET_STRING_ELT(nms, 252, mkChar("offset_variable_cum_screened"));
  SET_STRING_ELT(nms, 253, mkChar("offset_variable_cum_treated"));
  SET_STRING_ELT(nms, 254, mkChar("offset_variable_I"));
  SET_STRING_ELT(nms, 255, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 256, mkChar("offset_variable_T"));
  SET_STRING_ELT(nms, 257, mkChar("p_A_ext"));
  SET_STRING_ELT(nms, 258, mkChar("p_I_ext"));
  SET_STRING_ELT(nms, 259, mkChar("p_S_ext"));
  SET_STRING_ELT(nms, 260, mkChar("p_T_ext"));
  SET_STRING_ELT(nms, 261, mkChar("p_U_ext"));
  SET_STRING_ELT(nms, 262, mkChar("psi"));
  SET_STRING_ELT(nms, 263, mkChar("pye_trial"));
  SET_STRING_ELT(nms, 264, mkChar("r_AT"));
  SET_STRING_ELT(nms, 265, mkChar("r_AU"));
  SET_STRING_ELT(nms, 266, mkChar("Rel_A"));
  SET_STRING_ELT(nms, 267, mkChar("Rel_I"));
  SET_STRING_ELT(nms, 268, mkChar("Rel_S"));
  SET_STRING_ELT(nms, 269, mkChar("Rel_T"));
  SET_STRING_ELT(nms, 270, mkChar("Rel_U"));
  SET_STRING_ELT(nms, 271, mkChar("rho"));
  SET_STRING_ELT(nms, 272, mkChar("S0"));
  SET_STRING_ELT(nms, 273, mkChar("screened"));
  SET_STRING_ELT(nms, 274, mkChar("sigma"));
  SET_STRING_ELT(nms, 275, mkChar("steps_per_year"));
  SET_STRING_ELT(nms, 276, mkChar("T0"));
  SET_STRING_ELT(nms, 277, mkChar("U0"));
  SET_STRING_ELT(nms, 278, mkChar("vea"));
  SET_STRING_ELT(nms, 279, mkChar("ved"));
  SET_STRING_ELT(nms, 280, mkChar("ves"));
  SET_STRING_ELT(nms, 281, mkChar("w"));
  SET_STRING_ELT(nms, 282, mkChar("wA"));
  SET_STRING_ELT(nms, 283, mkChar("wI"));
  SET_STRING_ELT(nms, 284, mkChar("wS"));
  SET_STRING_ELT(nms, 285, mkChar("wT"));
  SET_STRING_ELT(nms, 286, mkChar("wU"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(66);
  return contents;
}
SEXP model_trial_stochastic_set_user(SEXP internal_p, SEXP user) {
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 1);
  internal->eta = user_get_scalar_double(user, "eta", internal->eta, NA_REAL, NA_REAL);
  internal->lambda = user_get_scalar_double(user, "lambda", internal->lambda, NA_REAL, NA_REAL);
  internal->mu = user_get_scalar_double(user, "mu", internal->mu, NA_REAL, NA_REAL);
  internal->n_vax = user_get_scalar_int(user, "n_vax", internal->n_vax, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->psi = user_get_scalar_double(user, "psi", internal->psi, NA_REAL, NA_REAL);
  internal->rho = user_get_scalar_double(user, "rho", internal->rho, NA_REAL, NA_REAL);
  internal->sigma = user_get_scalar_double(user, "sigma", internal->sigma, NA_REAL, NA_REAL);
  internal->dim_A_1 = internal->n_group;
  internal->dim_A_2 = internal->n_vax;
  internal->dim_A0_1 = internal->n_group;
  internal->dim_A0_2 = internal->n_vax;
  internal->dim_cum_diag_a_1 = internal->n_group;
  internal->dim_cum_diag_a_2 = internal->n_vax;
  internal->dim_cum_diag_s_1 = internal->n_group;
  internal->dim_cum_diag_s_2 = internal->n_vax;
  internal->dim_cum_incid_1 = internal->n_group;
  internal->dim_cum_incid_2 = internal->n_vax;
  internal->dim_cum_pye_trial_pov_1 = internal->n_group;
  internal->dim_cum_pye_trial_pov_2 = internal->n_vax;
  internal->dim_cum_pye_true_1 = internal->n_group;
  internal->dim_cum_pye_true_2 = internal->n_vax;
  internal->dim_cum_screened_1 = internal->n_group;
  internal->dim_cum_screened_2 = internal->n_vax;
  internal->dim_cum_treated_1 = internal->n_group;
  internal->dim_cum_treated_2 = internal->n_vax;
  internal->dim_D = internal->n_vax;
  internal->dim_diag_rec_a_1 = internal->n_group;
  internal->dim_diag_rec_a_2 = internal->n_vax;
  internal->dim_diag_rec_a_3 = internal->n_vax;
  internal->dim_diag_rec_s_1 = internal->n_group;
  internal->dim_diag_rec_s_2 = internal->n_vax;
  internal->dim_diag_rec_s_3 = internal->n_vax;
  internal->dim_I_1 = internal->n_group;
  internal->dim_I_2 = internal->n_vax;
  internal->dim_I0_1 = internal->n_group;
  internal->dim_I0_2 = internal->n_vax;
  internal->dim_N_1 = internal->n_group;
  internal->dim_N_2 = internal->n_vax;
  internal->dim_n_A_ext_1 = internal->n_group;
  internal->dim_n_A_ext_2 = internal->n_vax;
  internal->dim_n_AT_1 = internal->n_group;
  internal->dim_n_AT_2 = internal->n_vax;
  internal->dim_n_AU_1 = internal->n_group;
  internal->dim_n_AU_2 = internal->n_vax;
  internal->dim_n_AUT_1 = internal->n_group;
  internal->dim_n_AUT_2 = internal->n_vax;
  internal->dim_n_Aw_1 = internal->n_group;
  internal->dim_n_Aw_2 = internal->n_vax;
  internal->dim_n_diag_rec_1 = internal->n_group;
  internal->dim_n_diag_rec_2 = internal->n_vax;
  internal->dim_n_diag_rec_3 = internal->n_vax;
  internal->dim_n_I_ext_1 = internal->n_group;
  internal->dim_n_I_ext_2 = internal->n_vax;
  internal->dim_n_IA_1 = internal->n_group;
  internal->dim_n_IA_2 = internal->n_vax;
  internal->dim_n_IAS_1 = internal->n_group;
  internal->dim_n_IAS_2 = internal->n_vax;
  internal->dim_n_IS_1 = internal->n_group;
  internal->dim_n_IS_2 = internal->n_vax;
  internal->dim_n_Iw_1 = internal->n_group;
  internal->dim_n_Iw_2 = internal->n_vax;
  internal->dim_n_S_ext_1 = internal->n_group;
  internal->dim_n_S_ext_2 = internal->n_vax;
  internal->dim_n_ST_1 = internal->n_group;
  internal->dim_n_ST_2 = internal->n_vax;
  internal->dim_n_Sw_1 = internal->n_group;
  internal->dim_n_Sw_2 = internal->n_vax;
  internal->dim_n_T_ext_1 = internal->n_group;
  internal->dim_n_T_ext_2 = internal->n_vax;
  internal->dim_n_TU_1 = internal->n_group;
  internal->dim_n_TU_2 = internal->n_vax;
  internal->dim_n_Tw_1 = internal->n_group;
  internal->dim_n_Tw_2 = internal->n_vax;
  internal->dim_n_U_ext_1 = internal->n_group;
  internal->dim_n_U_ext_2 = internal->n_vax;
  internal->dim_n_UI_1 = internal->n_group;
  internal->dim_n_UI_2 = internal->n_vax;
  internal->dim_n_Uw_1 = internal->n_group;
  internal->dim_n_Uw_2 = internal->n_vax;
  internal->dim_p_A_ext_1 = internal->n_group;
  internal->dim_p_A_ext_2 = internal->n_vax;
  internal->dim_p_I_ext_1 = internal->n_group;
  internal->dim_p_I_ext_2 = internal->n_vax;
  internal->dim_p_S_ext_1 = internal->n_group;
  internal->dim_p_S_ext_2 = internal->n_vax;
  internal->dim_p_T_ext_1 = internal->n_group;
  internal->dim_p_T_ext_2 = internal->n_vax;
  internal->dim_p_U_ext_1 = internal->n_group;
  internal->dim_p_U_ext_2 = internal->n_vax;
  internal->dim_pye_trial_1 = internal->n_group;
  internal->dim_pye_trial_2 = internal->n_vax;
  internal->dim_r_AT_1 = internal->n_group;
  internal->dim_r_AT_2 = internal->n_vax;
  internal->dim_r_AU_1 = internal->n_group;
  internal->dim_r_AU_2 = internal->n_vax;
  internal->dim_Rel_A_1 = internal->n_group;
  internal->dim_Rel_A_2 = internal->n_vax;
  internal->dim_Rel_I_1 = internal->n_group;
  internal->dim_Rel_I_2 = internal->n_vax;
  internal->dim_Rel_S_1 = internal->n_group;
  internal->dim_Rel_S_2 = internal->n_vax;
  internal->dim_Rel_T_1 = internal->n_group;
  internal->dim_Rel_T_2 = internal->n_vax;
  internal->dim_Rel_U_1 = internal->n_group;
  internal->dim_Rel_U_2 = internal->n_vax;
  internal->dim_S_1 = internal->n_group;
  internal->dim_S_2 = internal->n_vax;
  internal->dim_S0_1 = internal->n_group;
  internal->dim_S0_2 = internal->n_vax;
  internal->dim_screened_1 = internal->n_group;
  internal->dim_screened_2 = internal->n_vax;
  internal->dim_T_1 = internal->n_group;
  internal->dim_T_2 = internal->n_vax;
  internal->dim_T0_1 = internal->n_group;
  internal->dim_T0_2 = internal->n_vax;
  internal->dim_U_1 = internal->n_group;
  internal->dim_U_2 = internal->n_vax;
  internal->dim_U0_1 = internal->n_group;
  internal->dim_U0_2 = internal->n_vax;
  internal->dim_vea = internal->n_vax;
  internal->dim_ved = internal->n_vax;
  internal->dim_ves = internal->n_vax;
  internal->dim_w_1 = internal->n_vax;
  internal->dim_w_2 = internal->n_vax;
  internal->dim_wA_1 = internal->n_group;
  internal->dim_wA_2 = internal->n_vax;
  internal->dim_wA_3 = internal->n_vax;
  internal->dim_wI_1 = internal->n_group;
  internal->dim_wI_2 = internal->n_vax;
  internal->dim_wI_3 = internal->n_vax;
  internal->dim_wS_1 = internal->n_group;
  internal->dim_wS_2 = internal->n_vax;
  internal->dim_wS_3 = internal->n_vax;
  internal->dim_wT_1 = internal->n_group;
  internal->dim_wT_2 = internal->n_vax;
  internal->dim_wT_3 = internal->n_vax;
  internal->dim_wU_1 = internal->n_group;
  internal->dim_wU_2 = internal->n_vax;
  internal->dim_wU_3 = internal->n_vax;
  internal->D = (double*) user_get_array(user, false, internal->D, "D", NA_REAL, NA_REAL, 1, internal->dim_D);
  internal->dim_A = internal->dim_A_1 * internal->dim_A_2;
  internal->dim_A0 = internal->dim_A0_1 * internal->dim_A0_2;
  internal->dim_cum_diag_a = internal->dim_cum_diag_a_1 * internal->dim_cum_diag_a_2;
  internal->dim_cum_diag_s = internal->dim_cum_diag_s_1 * internal->dim_cum_diag_s_2;
  internal->dim_cum_incid = internal->dim_cum_incid_1 * internal->dim_cum_incid_2;
  internal->dim_cum_pye_trial_pov = internal->dim_cum_pye_trial_pov_1 * internal->dim_cum_pye_trial_pov_2;
  internal->dim_cum_pye_true = internal->dim_cum_pye_true_1 * internal->dim_cum_pye_true_2;
  internal->dim_cum_screened = internal->dim_cum_screened_1 * internal->dim_cum_screened_2;
  internal->dim_cum_treated = internal->dim_cum_treated_1 * internal->dim_cum_treated_2;
  internal->dim_diag_rec_a = internal->dim_diag_rec_a_1 * internal->dim_diag_rec_a_2 * internal->dim_diag_rec_a_3;
  internal->dim_diag_rec_a_12 = internal->dim_diag_rec_a_1 * internal->dim_diag_rec_a_2;
  internal->dim_diag_rec_s = internal->dim_diag_rec_s_1 * internal->dim_diag_rec_s_2 * internal->dim_diag_rec_s_3;
  internal->dim_diag_rec_s_12 = internal->dim_diag_rec_s_1 * internal->dim_diag_rec_s_2;
  internal->dim_I = internal->dim_I_1 * internal->dim_I_2;
  internal->dim_I0 = internal->dim_I0_1 * internal->dim_I0_2;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_n_A_ext = internal->dim_n_A_ext_1 * internal->dim_n_A_ext_2;
  internal->dim_n_AT = internal->dim_n_AT_1 * internal->dim_n_AT_2;
  internal->dim_n_AU = internal->dim_n_AU_1 * internal->dim_n_AU_2;
  internal->dim_n_AUT = internal->dim_n_AUT_1 * internal->dim_n_AUT_2;
  internal->dim_n_Aw = internal->dim_n_Aw_1 * internal->dim_n_Aw_2;
  internal->dim_n_diag_rec = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2 * internal->dim_n_diag_rec_3;
  internal->dim_n_diag_rec_12 = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2;
  internal->dim_n_I_ext = internal->dim_n_I_ext_1 * internal->dim_n_I_ext_2;
  internal->dim_n_IA = internal->dim_n_IA_1 * internal->dim_n_IA_2;
  internal->dim_n_IAS = internal->dim_n_IAS_1 * internal->dim_n_IAS_2;
  internal->dim_n_IS = internal->dim_n_IS_1 * internal->dim_n_IS_2;
  internal->dim_n_Iw = internal->dim_n_Iw_1 * internal->dim_n_Iw_2;
  internal->dim_n_S_ext = internal->dim_n_S_ext_1 * internal->dim_n_S_ext_2;
  internal->dim_n_ST = internal->dim_n_ST_1 * internal->dim_n_ST_2;
  internal->dim_n_Sw = internal->dim_n_Sw_1 * internal->dim_n_Sw_2;
  internal->dim_n_T_ext = internal->dim_n_T_ext_1 * internal->dim_n_T_ext_2;
  internal->dim_n_TU = internal->dim_n_TU_1 * internal->dim_n_TU_2;
  internal->dim_n_Tw = internal->dim_n_Tw_1 * internal->dim_n_Tw_2;
  internal->dim_n_U_ext = internal->dim_n_U_ext_1 * internal->dim_n_U_ext_2;
  internal->dim_n_UI = internal->dim_n_UI_1 * internal->dim_n_UI_2;
  internal->dim_n_Uw = internal->dim_n_Uw_1 * internal->dim_n_Uw_2;
  internal->dim_p_A_ext = internal->dim_p_A_ext_1 * internal->dim_p_A_ext_2;
  internal->dim_p_I_ext = internal->dim_p_I_ext_1 * internal->dim_p_I_ext_2;
  internal->dim_p_S_ext = internal->dim_p_S_ext_1 * internal->dim_p_S_ext_2;
  internal->dim_p_T_ext = internal->dim_p_T_ext_1 * internal->dim_p_T_ext_2;
  internal->dim_p_U_ext = internal->dim_p_U_ext_1 * internal->dim_p_U_ext_2;
  internal->dim_pye_trial = internal->dim_pye_trial_1 * internal->dim_pye_trial_2;
  internal->dim_r_AT = internal->dim_r_AT_1 * internal->dim_r_AT_2;
  internal->dim_r_AU = internal->dim_r_AU_1 * internal->dim_r_AU_2;
  internal->dim_Rel_A = internal->dim_Rel_A_1 * internal->dim_Rel_A_2;
  internal->dim_Rel_I = internal->dim_Rel_I_1 * internal->dim_Rel_I_2;
  internal->dim_Rel_S = internal->dim_Rel_S_1 * internal->dim_Rel_S_2;
  internal->dim_Rel_T = internal->dim_Rel_T_1 * internal->dim_Rel_T_2;
  internal->dim_Rel_U = internal->dim_Rel_U_1 * internal->dim_Rel_U_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_S0 = internal->dim_S0_1 * internal->dim_S0_2;
  internal->dim_screened = internal->dim_screened_1 * internal->dim_screened_2;
  internal->dim_T = internal->dim_T_1 * internal->dim_T_2;
  internal->dim_T0 = internal->dim_T0_1 * internal->dim_T0_2;
  internal->dim_U = internal->dim_U_1 * internal->dim_U_2;
  internal->dim_U0 = internal->dim_U0_1 * internal->dim_U0_2;
  internal->dim_w = internal->dim_w_1 * internal->dim_w_2;
  internal->dim_wA = internal->dim_wA_1 * internal->dim_wA_2 * internal->dim_wA_3;
  internal->dim_wA_12 = internal->dim_wA_1 * internal->dim_wA_2;
  internal->dim_wI = internal->dim_wI_1 * internal->dim_wI_2 * internal->dim_wI_3;
  internal->dim_wI_12 = internal->dim_wI_1 * internal->dim_wI_2;
  internal->dim_wS = internal->dim_wS_1 * internal->dim_wS_2 * internal->dim_wS_3;
  internal->dim_wS_12 = internal->dim_wS_1 * internal->dim_wS_2;
  internal->dim_wT = internal->dim_wT_1 * internal->dim_wT_2 * internal->dim_wT_3;
  internal->dim_wT_12 = internal->dim_wT_1 * internal->dim_wT_2;
  internal->dim_wU = internal->dim_wU_1 * internal->dim_wU_2 * internal->dim_wU_3;
  internal->dim_wU_12 = internal->dim_wU_1 * internal->dim_wU_2;
  internal->vea = (double*) user_get_array(user, false, internal->vea, "vea", NA_REAL, NA_REAL, 1, internal->dim_vea);
  internal->ved = (double*) user_get_array(user, false, internal->ved, "ved", NA_REAL, NA_REAL, 1, internal->dim_ved);
  internal->ves = (double*) user_get_array(user, false, internal->ves, "ves", NA_REAL, NA_REAL, 1, internal->dim_ves);
  internal->A0 = (double*) user_get_array(user, false, internal->A0, "A0", NA_REAL, NA_REAL, 2, internal->dim_A0_1, internal->dim_A0_2);
  R_Free(internal->initial_A);
  internal->initial_A = (double*) R_Calloc(internal->dim_A, double);
  R_Free(internal->initial_cum_diag_a);
  internal->initial_cum_diag_a = (double*) R_Calloc(internal->dim_cum_diag_a, double);
  R_Free(internal->initial_cum_diag_s);
  internal->initial_cum_diag_s = (double*) R_Calloc(internal->dim_cum_diag_s, double);
  R_Free(internal->initial_cum_incid);
  internal->initial_cum_incid = (double*) R_Calloc(internal->dim_cum_incid, double);
  R_Free(internal->initial_cum_pye_trial_pov);
  internal->initial_cum_pye_trial_pov = (double*) R_Calloc(internal->dim_cum_pye_trial_pov, double);
  R_Free(internal->initial_cum_pye_true);
  internal->initial_cum_pye_true = (double*) R_Calloc(internal->dim_cum_pye_true, double);
  R_Free(internal->initial_cum_screened);
  internal->initial_cum_screened = (double*) R_Calloc(internal->dim_cum_screened, double);
  R_Free(internal->initial_cum_treated);
  internal->initial_cum_treated = (double*) R_Calloc(internal->dim_cum_treated, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_T);
  internal->initial_T = (double*) R_Calloc(internal->dim_T, double);
  R_Free(internal->initial_U);
  internal->initial_U = (double*) R_Calloc(internal->dim_U, double);
  R_Free(internal->N);
  internal->N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->n_A_ext);
  internal->n_A_ext = (double*) R_Calloc(internal->dim_n_A_ext, double);
  R_Free(internal->n_AT);
  internal->n_AT = (double*) R_Calloc(internal->dim_n_AT, double);
  R_Free(internal->n_AU);
  internal->n_AU = (double*) R_Calloc(internal->dim_n_AU, double);
  R_Free(internal->n_AUT);
  internal->n_AUT = (double*) R_Calloc(internal->dim_n_AUT, double);
  R_Free(internal->n_Aw);
  internal->n_Aw = (double*) R_Calloc(internal->dim_n_Aw, double);
  R_Free(internal->n_diag_rec);
  internal->n_diag_rec = (double*) R_Calloc(internal->dim_n_diag_rec, double);
  R_Free(internal->n_I_ext);
  internal->n_I_ext = (double*) R_Calloc(internal->dim_n_I_ext, double);
  R_Free(internal->n_IA);
  internal->n_IA = (double*) R_Calloc(internal->dim_n_IA, double);
  R_Free(internal->n_IAS);
  internal->n_IAS = (double*) R_Calloc(internal->dim_n_IAS, double);
  R_Free(internal->n_IS);
  internal->n_IS = (double*) R_Calloc(internal->dim_n_IS, double);
  R_Free(internal->n_Iw);
  internal->n_Iw = (double*) R_Calloc(internal->dim_n_Iw, double);
  R_Free(internal->n_S_ext);
  internal->n_S_ext = (double*) R_Calloc(internal->dim_n_S_ext, double);
  R_Free(internal->n_ST);
  internal->n_ST = (double*) R_Calloc(internal->dim_n_ST, double);
  R_Free(internal->n_Sw);
  internal->n_Sw = (double*) R_Calloc(internal->dim_n_Sw, double);
  R_Free(internal->n_T_ext);
  internal->n_T_ext = (double*) R_Calloc(internal->dim_n_T_ext, double);
  R_Free(internal->n_TU);
  internal->n_TU = (double*) R_Calloc(internal->dim_n_TU, double);
  R_Free(internal->n_Tw);
  internal->n_Tw = (double*) R_Calloc(internal->dim_n_Tw, double);
  R_Free(internal->n_U_ext);
  internal->n_U_ext = (double*) R_Calloc(internal->dim_n_U_ext, double);
  R_Free(internal->n_UI);
  internal->n_UI = (double*) R_Calloc(internal->dim_n_UI, double);
  R_Free(internal->n_Uw);
  internal->n_Uw = (double*) R_Calloc(internal->dim_n_Uw, double);
  R_Free(internal->p_A_ext);
  internal->p_A_ext = (double*) R_Calloc(internal->dim_p_A_ext, double);
  R_Free(internal->p_I_ext);
  internal->p_I_ext = (double*) R_Calloc(internal->dim_p_I_ext, double);
  R_Free(internal->p_S_ext);
  internal->p_S_ext = (double*) R_Calloc(internal->dim_p_S_ext, double);
  R_Free(internal->p_T_ext);
  internal->p_T_ext = (double*) R_Calloc(internal->dim_p_T_ext, double);
  R_Free(internal->p_U_ext);
  internal->p_U_ext = (double*) R_Calloc(internal->dim_p_U_ext, double);
  R_Free(internal->pye_trial);
  internal->pye_trial = (double*) R_Calloc(internal->dim_pye_trial, double);
  R_Free(internal->r_AT);
  internal->r_AT = (double*) R_Calloc(internal->dim_r_AT, double);
  R_Free(internal->r_AU);
  internal->r_AU = (double*) R_Calloc(internal->dim_r_AU, double);
  R_Free(internal->Rel_A);
  internal->Rel_A = (double*) R_Calloc(internal->dim_Rel_A, double);
  R_Free(internal->Rel_I);
  internal->Rel_I = (double*) R_Calloc(internal->dim_Rel_I, double);
  R_Free(internal->Rel_S);
  internal->Rel_S = (double*) R_Calloc(internal->dim_Rel_S, double);
  R_Free(internal->Rel_T);
  internal->Rel_T = (double*) R_Calloc(internal->dim_Rel_T, double);
  R_Free(internal->Rel_U);
  internal->Rel_U = (double*) R_Calloc(internal->dim_Rel_U, double);
  R_Free(internal->screened);
  internal->screened = (double*) R_Calloc(internal->dim_screened, double);
  R_Free(internal->wA);
  internal->wA = (double*) R_Calloc(internal->dim_wA, double);
  R_Free(internal->wI);
  internal->wI = (double*) R_Calloc(internal->dim_wI, double);
  R_Free(internal->wS);
  internal->wS = (double*) R_Calloc(internal->dim_wS, double);
  R_Free(internal->wT);
  internal->wT = (double*) R_Calloc(internal->dim_wT, double);
  R_Free(internal->wU);
  internal->wU = (double*) R_Calloc(internal->dim_wU, double);
  internal->diag_rec_a = (double*) user_get_array(user, false, internal->diag_rec_a, "diag_rec_a", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_a_1, internal->dim_diag_rec_a_2, internal->dim_diag_rec_a_3);
  internal->diag_rec_s = (double*) user_get_array(user, false, internal->diag_rec_s, "diag_rec_s", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_s_1, internal->dim_diag_rec_s_2, internal->dim_diag_rec_s_3);
  internal->I0 = (double*) user_get_array(user, false, internal->I0, "I0", NA_REAL, NA_REAL, 2, internal->dim_I0_1, internal->dim_I0_2);
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      internal->initial_cum_diag_a[i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      internal->initial_cum_diag_s[i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      internal->initial_cum_incid[i - 1 + internal->dim_cum_incid_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_trial_pov_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_trial_pov_2; ++j) {
      internal->initial_cum_pye_trial_pov[i - 1 + internal->dim_cum_pye_trial_pov_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_true_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_true_2; ++j) {
      internal->initial_cum_pye_true[i - 1 + internal->dim_cum_pye_true_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      internal->initial_cum_screened[i - 1 + internal->dim_cum_screened_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      internal->initial_cum_treated[i - 1 + internal->dim_cum_treated_1 * (j - 1)] = 0;
    }
  }
  internal->offset_variable_A = internal->dim_I + internal->dim_U + 1;
  internal->offset_variable_cum_diag_a = internal->dim_A + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_diag_s = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_incid = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_pye_trial_pov = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_pye_true = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_pye_trial_pov + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_screened = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_cum_treated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1;
  internal->offset_variable_I = internal->dim_U + 1;
  internal->offset_variable_S = internal->dim_A + internal->dim_I + internal->dim_U + 1;
  internal->offset_variable_T = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_U + 1;
  internal->S0 = (double*) user_get_array(user, false, internal->S0, "S0", NA_REAL, NA_REAL, 2, internal->dim_S0_1, internal->dim_S0_2);
  internal->T0 = (double*) user_get_array(user, false, internal->T0, "T0", NA_REAL, NA_REAL, 2, internal->dim_T0_1, internal->dim_T0_2);
  internal->U0 = (double*) user_get_array(user, false, internal->U0, "U0", NA_REAL, NA_REAL, 2, internal->dim_U0_1, internal->dim_U0_2);
  internal->w = (double*) user_get_array(user, false, internal->w, "w", NA_REAL, NA_REAL, 2, internal->dim_w_1, internal->dim_w_2);
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      internal->initial_A[i - 1 + internal->dim_A_1 * (j - 1)] = internal->A0[internal->dim_A0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      internal->initial_I[i - 1 + internal->dim_I_1 * (j - 1)] = internal->I0[internal->dim_I0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1)] = internal->S0[internal->dim_S0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      internal->initial_T[i - 1 + internal->dim_T_1 * (j - 1)] = internal->T0[internal->dim_T0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      internal->initial_U[i - 1 + internal->dim_U_1 * (j - 1)] = internal->U0[internal->dim_U0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_p_I_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_p_I_ext_2; ++j) {
      internal->p_I_ext[i - 1 + internal->dim_p_I_ext_1 * (j - 1)] = 1 - exp(-((internal->sigma - internal->D[j - 1])) * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_p_S_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_p_S_ext_2; ++j) {
      internal->p_S_ext[i - 1 + internal->dim_p_S_ext_1 * (j - 1)] = 1 - exp(-((internal->mu - internal->D[j - 1])) * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_p_T_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_p_T_ext_2; ++j) {
      internal->p_T_ext[i - 1 + internal->dim_p_T_ext_1 * (j - 1)] = 1 - exp(-((internal->rho - internal->D[j - 1])) * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_p_U_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_p_U_ext_2; ++j) {
      internal->p_U_ext[i - 1 + internal->dim_p_U_ext_1 * (j - 1)] = 1 - exp(-((internal->lambda * (1 - internal->vea[j - 1]) - internal->D[j - 1])) * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_r_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_r_AT_2; ++j) {
      internal->r_AT[i - 1 + internal->dim_r_AT_1 * (j - 1)] = internal->eta;
    }
  }
  for (int i = 1; i <= internal->dim_r_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_r_AU_2; ++j) {
      internal->r_AU[i - 1 + internal->dim_r_AU_1 * (j - 1)] = (internal->mu == 0 ? internal->nu : ((internal->nu * internal->mu) / (double) (internal->ved[j - 1] * internal->nu + (1 - internal->ved[j - 1]) * internal->mu)));
    }
  }
  for (int i = 1; i <= internal->dim_Rel_I_1; ++i) {
    for (int j = 1; j <= internal->dim_Rel_I_2; ++j) {
      internal->Rel_I[i - 1 + internal->dim_Rel_I_1 * (j - 1)] = (internal->sigma - internal->D[j - 1] == 0 ? 0 : internal->sigma / (double) (internal->sigma - internal->D[j - 1]));
    }
  }
  for (int i = 1; i <= internal->dim_Rel_S_1; ++i) {
    for (int j = 1; j <= internal->dim_Rel_S_2; ++j) {
      internal->Rel_S[i - 1 + internal->dim_Rel_S_1 * (j - 1)] = (internal->mu - internal->D[j - 1] == 0 ? 0 : internal->mu / (double) (internal->mu - internal->D[j - 1]));
    }
  }
  for (int i = 1; i <= internal->dim_Rel_T_1; ++i) {
    for (int j = 1; j <= internal->dim_Rel_T_2; ++j) {
      internal->Rel_T[i - 1 + internal->dim_Rel_T_1 * (j - 1)] = (internal->rho - internal->D[j - 1] == 0 ? 0 : internal->rho / (double) (internal->rho - internal->D[j - 1]));
    }
  }
  for (int i = 1; i <= internal->dim_Rel_U_1; ++i) {
    for (int j = 1; j <= internal->dim_Rel_U_2; ++j) {
      internal->Rel_U[i - 1 + internal->dim_Rel_U_1 * (j - 1)] = ((internal->lambda * (1 - internal->vea[j - 1]) - internal->D[j - 1]) == 0 ? 0 : internal->lambda * (1 - internal->vea[j - 1]) / (double) (internal->lambda * (1 - internal->vea[j - 1]) - internal->D[j - 1]));
    }
  }
  for (int i = 1; i <= internal->dim_p_A_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_p_A_ext_2; ++j) {
      internal->p_A_ext[i - 1 + internal->dim_p_A_ext_1 * (j - 1)] = 1 - exp(-((internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] + internal->r_AU[internal->dim_r_AU_1 * (j - 1) + i - 1] - internal->D[j - 1])) * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_Rel_A_1; ++i) {
    for (int j = 1; j <= internal->dim_Rel_A_2; ++j) {
      internal->Rel_A[i - 1 + internal->dim_Rel_A_1 * (j - 1)] = (internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] + internal->r_AU[internal->dim_r_AU_1 * (j - 1) + i - 1] - internal->D[j - 1] == 0 ? 0 : (internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] + internal->r_AU[internal->dim_r_AU_1 * (j - 1) + i - 1]) / (double) (internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] + internal->r_AU[internal->dim_r_AU_1 * (j - 1) + i - 1] - internal->D[j - 1]));
    }
  }
  return R_NilValue;
}
SEXP model_trial_stochastic_set_initial(SEXP internal_p, SEXP step_ptr, SEXP state_ptr) {
  return R_NilValue;
}
SEXP model_trial_stochastic_metadata(SEXP internal_p) {
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 13));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 13));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, R_NilValue);
  SET_VECTOR_ELT(variable_length, 1, allocVector(INTSXP, 2));
  int * dim_U = INTEGER(VECTOR_ELT(variable_length, 1));
  dim_U[0] = internal->dim_U_1;
  dim_U[1] = internal->dim_U_2;
  SET_VECTOR_ELT(variable_length, 2, allocVector(INTSXP, 2));
  int * dim_I = INTEGER(VECTOR_ELT(variable_length, 2));
  dim_I[0] = internal->dim_I_1;
  dim_I[1] = internal->dim_I_2;
  SET_VECTOR_ELT(variable_length, 3, allocVector(INTSXP, 2));
  int * dim_A = INTEGER(VECTOR_ELT(variable_length, 3));
  dim_A[0] = internal->dim_A_1;
  dim_A[1] = internal->dim_A_2;
  SET_VECTOR_ELT(variable_length, 4, allocVector(INTSXP, 2));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 4));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  SET_VECTOR_ELT(variable_length, 5, allocVector(INTSXP, 2));
  int * dim_T = INTEGER(VECTOR_ELT(variable_length, 5));
  dim_T[0] = internal->dim_T_1;
  dim_T[1] = internal->dim_T_2;
  SET_VECTOR_ELT(variable_length, 6, allocVector(INTSXP, 2));
  int * dim_cum_incid = INTEGER(VECTOR_ELT(variable_length, 6));
  dim_cum_incid[0] = internal->dim_cum_incid_1;
  dim_cum_incid[1] = internal->dim_cum_incid_2;
  SET_VECTOR_ELT(variable_length, 7, allocVector(INTSXP, 2));
  int * dim_cum_diag_a = INTEGER(VECTOR_ELT(variable_length, 7));
  dim_cum_diag_a[0] = internal->dim_cum_diag_a_1;
  dim_cum_diag_a[1] = internal->dim_cum_diag_a_2;
  SET_VECTOR_ELT(variable_length, 8, allocVector(INTSXP, 2));
  int * dim_cum_diag_s = INTEGER(VECTOR_ELT(variable_length, 8));
  dim_cum_diag_s[0] = internal->dim_cum_diag_s_1;
  dim_cum_diag_s[1] = internal->dim_cum_diag_s_2;
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 2));
  int * dim_cum_treated = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_cum_treated[0] = internal->dim_cum_treated_1;
  dim_cum_treated[1] = internal->dim_cum_treated_2;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 2));
  int * dim_cum_screened = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_cum_screened[0] = internal->dim_cum_screened_1;
  dim_cum_screened[1] = internal->dim_cum_screened_2;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 2));
  int * dim_cum_pye_trial_pov = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_cum_pye_trial_pov[0] = internal->dim_cum_pye_trial_pov_1;
  dim_cum_pye_trial_pov[1] = internal->dim_cum_pye_trial_pov_2;
  SET_VECTOR_ELT(variable_length, 12, allocVector(INTSXP, 2));
  int * dim_cum_pye_true = INTEGER(VECTOR_ELT(variable_length, 12));
  dim_cum_pye_true[0] = internal->dim_cum_pye_true_1;
  dim_cum_pye_true[1] = internal->dim_cum_pye_true_2;
  SET_STRING_ELT(variable_names, 0, mkChar("time"));
  SET_STRING_ELT(variable_names, 1, mkChar("U"));
  SET_STRING_ELT(variable_names, 2, mkChar("I"));
  SET_STRING_ELT(variable_names, 3, mkChar("A"));
  SET_STRING_ELT(variable_names, 4, mkChar("S"));
  SET_STRING_ELT(variable_names, 5, mkChar("T"));
  SET_STRING_ELT(variable_names, 6, mkChar("cum_incid"));
  SET_STRING_ELT(variable_names, 7, mkChar("cum_diag_a"));
  SET_STRING_ELT(variable_names, 8, mkChar("cum_diag_s"));
  SET_STRING_ELT(variable_names, 9, mkChar("cum_treated"));
  SET_STRING_ELT(variable_names, 10, mkChar("cum_screened"));
  SET_STRING_ELT(variable_names, 11, mkChar("cum_pye_trial_pov"));
  SET_STRING_ELT(variable_names, 12, mkChar("cum_pye_true"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 3));
  SEXP output_names = PROTECT(allocVector(STRSXP, 3));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, allocVector(INTSXP, 2));
  int * dim_N = INTEGER(VECTOR_ELT(output_length, 2));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  SET_STRING_ELT(output_names, 0, mkChar("tot_treated"));
  SET_STRING_ELT(output_names, 1, mkChar("tot_attended"));
  SET_STRING_ELT(output_names, 2, mkChar("N"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(internal->dim_N + 2));
  UNPROTECT(2);
  return ret;
}
SEXP model_trial_stochastic_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_pye_trial_pov + internal->dim_cum_pye_true + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U + 1));
  double * state = REAL(r_state);
  state[0] = internal->initial_time;
  memcpy(state + 1, internal->initial_U, internal->dim_U * sizeof(double));
  memcpy(state + internal->offset_variable_I, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_A, internal->initial_A, internal->dim_A * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_T, internal->initial_T, internal->dim_T * sizeof(double));
  memcpy(state + internal->offset_variable_cum_incid, internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_a, internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_s, internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  memcpy(state + internal->offset_variable_cum_treated, internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_screened, internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  memcpy(state + internal->offset_variable_cum_pye_trial_pov, internal->initial_cum_pye_trial_pov, internal->dim_cum_pye_trial_pov * sizeof(double));
  memcpy(state + internal->offset_variable_cum_pye_true, internal->initial_cum_pye_true, internal->dim_cum_pye_true * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void model_trial_stochastic_rhs(model_trial_stochastic_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double * U = state + 1;
  double * I = state + internal->offset_variable_I;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double * cum_incid = state + internal->offset_variable_cum_incid;
  double * cum_diag_a = state + internal->offset_variable_cum_diag_a;
  double * cum_diag_s = state + internal->offset_variable_cum_diag_s;
  double * cum_treated = state + internal->offset_variable_cum_treated;
  double * cum_screened = state + internal->offset_variable_cum_screened;
  double * cum_pye_trial_pov = state + internal->offset_variable_cum_pye_trial_pov;
  double * cum_pye_true = state + internal->offset_variable_cum_pye_true;
  state_next[0] = (step + 1) * internal->dt;
  for (int i = 1; i <= internal->dim_cum_pye_true_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_true_2; ++j) {
      state_next[internal->offset_variable_cum_pye_true + i - 1 + internal->dim_cum_pye_true_1 * (j - 1)] = cum_pye_true[internal->dim_cum_pye_true_1 * (j - 1) + i - 1] + (U[internal->dim_U_1 * (j - 1) + i - 1] * internal->dt);
    }
  }
  for (int i = 1; i <= internal->dim_pye_trial_1; ++i) {
    for (int j = 1; j <= internal->dim_pye_trial_2; ++j) {
      internal->pye_trial[i - 1 + internal->dim_pye_trial_1 * (j - 1)] = (U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]) * internal->dt;
    }
  }
  for (int i = 1; i <= internal->dim_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_screened_2; ++j) {
      internal->screened[i - 1 + internal->dim_screened_1 * (j - 1)] = Rf_rbinom(round(U[internal->dim_U_1 * (j - 1) + i - 1]), 1 - exp(-(internal->eta) * internal->dt));
    }
  }
  for (int i = 1; i <= internal->dim_n_I_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_n_I_ext_2; ++j) {
      internal->n_I_ext[i - 1 + internal->dim_n_I_ext_1 * (j - 1)] = Rf_rbinom(round(I[internal->dim_I_1 * (j - 1) + i - 1]), internal->p_I_ext[internal->dim_p_I_ext_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_S_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_n_S_ext_2; ++j) {
      internal->n_S_ext[i - 1 + internal->dim_n_S_ext_1 * (j - 1)] = Rf_rbinom(round(S[internal->dim_S_1 * (j - 1) + i - 1]), internal->p_S_ext[internal->dim_p_S_ext_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_T_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_n_T_ext_2; ++j) {
      internal->n_T_ext[i - 1 + internal->dim_n_T_ext_1 * (j - 1)] = Rf_rbinom(round(T[internal->dim_T_1 * (j - 1) + i - 1]), internal->p_T_ext[internal->dim_p_T_ext_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_U_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_n_U_ext_2; ++j) {
      internal->n_U_ext[i - 1 + internal->dim_n_U_ext_1 * (j - 1)] = Rf_rbinom(round(U[internal->dim_U_1 * (j - 1) + i - 1]), internal->p_U_ext[internal->dim_p_U_ext_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_cum_pye_trial_pov_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_pye_trial_pov_2; ++j) {
      state_next[internal->offset_variable_cum_pye_trial_pov + i - 1 + internal->dim_cum_pye_trial_pov_1 * (j - 1)] = cum_pye_trial_pov[internal->dim_cum_pye_trial_pov_1 * (j - 1) + i - 1] + internal->pye_trial[internal->dim_pye_trial_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      state_next[internal->offset_variable_cum_screened + i - 1 + internal->dim_cum_screened_1 * (j - 1)] = cum_screened[internal->dim_cum_screened_1 * (j - 1) + i - 1] + internal->screened[internal->dim_screened_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_A_ext_1; ++i) {
    for (int j = 1; j <= internal->dim_n_A_ext_2; ++j) {
      internal->n_A_ext[i - 1 + internal->dim_n_A_ext_1 * (j - 1)] = Rf_rbinom(round(A[internal->dim_A_1 * (j - 1) + i - 1]), internal->p_A_ext[internal->dim_p_A_ext_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_IAS_1; ++i) {
    for (int j = 1; j <= internal->dim_n_IAS_2; ++j) {
      internal->n_IAS[i - 1 + internal->dim_n_IAS_1 * (j - 1)] = Rf_rbinom(round(internal->n_I_ext[internal->dim_n_I_ext_1 * (j - 1) + i - 1]), internal->Rel_I[internal->dim_Rel_I_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_ST_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ST_2; ++j) {
      internal->n_ST[i - 1 + internal->dim_n_ST_1 * (j - 1)] = Rf_rbinom(round(internal->n_S_ext[internal->dim_n_S_ext_1 * (j - 1) + i - 1]), internal->Rel_S[internal->dim_Rel_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_TU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_TU_2; ++j) {
      internal->n_TU[i - 1 + internal->dim_n_TU_1 * (j - 1)] = Rf_rbinom(round(internal->n_T_ext[internal->dim_n_T_ext_1 * (j - 1) + i - 1]), internal->Rel_T[internal->dim_Rel_T_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_UI_1; ++i) {
    for (int j = 1; j <= internal->dim_n_UI_2; ++j) {
      internal->n_UI[i - 1 + internal->dim_n_UI_1 * (j - 1)] = Rf_rbinom(round(internal->n_U_ext[internal->dim_n_U_ext_1 * (j - 1) + i - 1]), internal->Rel_U[internal->dim_Rel_U_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_AUT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AUT_2; ++j) {
      internal->n_AUT[i - 1 + internal->dim_n_AUT_1 * (j - 1)] = Rf_rbinom(round(internal->n_A_ext[internal->dim_n_A_ext_1 * (j - 1) + i - 1]), internal->Rel_A[internal->dim_Rel_A_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_IA_1; ++i) {
    for (int j = 1; j <= internal->dim_n_IA_2; ++j) {
      internal->n_IA[i - 1 + internal->dim_n_IA_1 * (j - 1)] = Rf_rbinom(round(internal->n_IAS[internal->dim_n_IAS_1 * (j - 1) + i - 1]), 1 - (1 - internal->ves[j - 1]) * internal->psi);
    }
  }
  for (int i = 1; i <= internal->dim_n_Iw_1; ++i) {
    for (int j = 1; j <= internal->dim_n_Iw_2; ++j) {
      internal->n_Iw[i - 1 + internal->dim_n_Iw_1 * (j - 1)] = internal->n_I_ext[internal->dim_n_I_ext_1 * (j - 1) + i - 1] - internal->n_IAS[internal->dim_n_IAS_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_Sw_1; ++i) {
    for (int j = 1; j <= internal->dim_n_Sw_2; ++j) {
      internal->n_Sw[i - 1 + internal->dim_n_Sw_1 * (j - 1)] = internal->n_S_ext[internal->dim_n_S_ext_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_Tw_1; ++i) {
    for (int j = 1; j <= internal->dim_n_Tw_2; ++j) {
      internal->n_Tw[i - 1 + internal->dim_n_Tw_1 * (j - 1)] = internal->n_T_ext[internal->dim_n_T_ext_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_Uw_1; ++i) {
    for (int j = 1; j <= internal->dim_n_Uw_2; ++j) {
      internal->n_Uw[i - 1 + internal->dim_n_Uw_1 * (j - 1)] = internal->n_U_ext[internal->dim_n_U_ext_1 * (j - 1) + i - 1] - internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      state_next[internal->offset_variable_cum_diag_s + i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = cum_diag_s[internal->dim_cum_diag_s_1 * (j - 1) + i - 1] + internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      state_next[internal->offset_variable_cum_incid + i - 1 + internal->dim_cum_incid_1 * (j - 1)] = cum_incid[internal->dim_cum_incid_1 * (j - 1) + i - 1] + internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      state_next[internal->offset_variable_cum_treated + i - 1 + internal->dim_cum_treated_1 * (j - 1)] = cum_treated[internal->dim_cum_treated_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AT_2; ++j) {
      internal->n_AT[i - 1 + internal->dim_n_AT_1 * (j - 1)] = Rf_rbinom(round(internal->n_AUT[internal->dim_n_AUT_1 * (j - 1) + i - 1]), internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] / (double) (internal->r_AT[internal->dim_r_AT_1 * (j - 1) + i - 1] + internal->r_AU[internal->dim_r_AU_1 * (j - 1) + i - 1]));
    }
  }
  for (int i = 1; i <= internal->dim_n_Aw_1; ++i) {
    for (int j = 1; j <= internal->dim_n_Aw_2; ++j) {
      internal->n_Aw[i - 1 + internal->dim_n_Aw_1 * (j - 1)] = internal->n_A_ext[internal->dim_n_A_ext_1 * (j - 1) + i - 1] - internal->n_AUT[internal->dim_n_AUT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_IS_1; ++i) {
    for (int j = 1; j <= internal->dim_n_IS_2; ++j) {
      internal->n_IS[i - 1 + internal->dim_n_IS_1 * (j - 1)] = internal->n_IAS[internal->dim_n_IAS_1 * (j - 1) + i - 1] - internal->n_IA[internal->dim_n_IA_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_wI_1; ++i) {
    for (int j = 1; j <= internal->dim_wI_2; ++j) {
      for (int k = 1; k <= internal->dim_wI_3; ++k) {
        internal->wI[i - 1 + internal->dim_wI_1 * (j - 1) + internal->dim_wI_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * internal->n_Iw[internal->dim_n_Iw_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wS_1; ++i) {
    for (int j = 1; j <= internal->dim_wS_2; ++j) {
      for (int k = 1; k <= internal->dim_wS_3; ++k) {
        internal->wS[i - 1 + internal->dim_wS_1 * (j - 1) + internal->dim_wS_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * internal->n_Sw[internal->dim_n_Sw_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wT_1; ++i) {
    for (int j = 1; j <= internal->dim_wT_2; ++j) {
      for (int k = 1; k <= internal->dim_wT_3; ++k) {
        internal->wT[i - 1 + internal->dim_wT_1 * (j - 1) + internal->dim_wT_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * internal->n_Tw[internal->dim_n_Tw_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wU_1; ++i) {
    for (int j = 1; j <= internal->dim_wU_2; ++j) {
      for (int k = 1; k <= internal->dim_wU_3; ++k) {
        internal->wU[i - 1 + internal->dim_wU_1 * (j - 1) + internal->dim_wU_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * internal->n_Uw[internal->dim_n_Uw_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AU_2; ++j) {
      internal->n_AU[i - 1 + internal->dim_n_AU_1 * (j - 1)] = internal->n_AUT[internal->dim_n_AUT_1 * (j - 1) + i - 1] - internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_diag_rec_1; ++i) {
    for (int j = 1; j <= internal->dim_n_diag_rec_2; ++j) {
      for (int k = 1; k <= internal->dim_n_diag_rec_3; ++k) {
        internal->n_diag_rec[i - 1 + internal->dim_n_diag_rec_1 * (j - 1) + internal->dim_n_diag_rec_12 * (k - 1)] = (internal->diag_rec_s[internal->dim_diag_rec_s_12 * (k - 1) + internal->dim_diag_rec_s_1 * (j - 1) + i - 1] * internal->n_ST[internal->dim_n_ST_1 * (k - 1) + i - 1]) + (internal->diag_rec_a[internal->dim_diag_rec_a_12 * (k - 1) + internal->dim_diag_rec_a_1 * (j - 1) + i - 1] * internal->n_AT[internal->dim_n_AT_1 * (k - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      state_next[internal->offset_variable_cum_diag_a + i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = cum_diag_a[internal->dim_cum_diag_a_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      state_next[internal->offset_variable_I + i - 1 + internal->dim_I_1 * (j - 1)] = I[internal->dim_I_1 * (j - 1) + i - 1] + internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - internal->n_IAS[internal->dim_n_IAS_1 * (j - 1) + i - 1] + odin_sum3(internal->wI, i - 1, i, j - 1, j, 0, internal->dim_wI_3, internal->dim_wI_1, internal->dim_wI_12);
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1)] = S[internal->dim_S_1 * (j - 1) + i - 1] + internal->n_IS[internal->dim_n_IS_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + odin_sum3(internal->wS, i - 1, i, j - 1, j, 0, internal->dim_wS_3, internal->dim_wS_1, internal->dim_wS_12);
    }
  }
  for (int i = 1; i <= internal->dim_wA_1; ++i) {
    for (int j = 1; j <= internal->dim_wA_2; ++j) {
      for (int k = 1; k <= internal->dim_wA_3; ++k) {
        internal->wA[i - 1 + internal->dim_wA_1 * (j - 1) + internal->dim_wA_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * internal->n_Aw[internal->dim_n_Aw_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      state_next[internal->offset_variable_A + i - 1 + internal->dim_A_1 * (j - 1)] = A[internal->dim_A_1 * (j - 1) + i - 1] + internal->n_IA[internal->dim_n_IA_1 * (j - 1) + i - 1] - internal->n_AUT[internal->dim_n_AUT_1 * (j - 1) + i - 1] + odin_sum3(internal->wA, i - 1, i, j - 1, j, 0, internal->dim_wA_3, internal->dim_wA_1, internal->dim_wA_12);
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      state_next[internal->offset_variable_T + i - 1 + internal->dim_T_1 * (j - 1)] = T[internal->dim_T_1 * (j - 1) + i - 1] + internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wT, i - 1, i, j - 1, j, 0, internal->dim_wT_3, internal->dim_wT_1, internal->dim_wT_12) - odin_sum3(internal->n_diag_rec, i - 1, i, j - 1, j, 0, internal->dim_n_diag_rec_3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_12);
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      state_next[1 + i - 1 + internal->dim_U_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] - internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] + internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wU, i - 1, i, j - 1, j, 0, internal->dim_wU_3, internal->dim_wU_1, internal->dim_wU_12);
    }
  }
  output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
  output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  memcpy(output + 2, internal->N, internal->dim_N * sizeof(double));
}
void model_trial_stochastic_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  model_trial_stochastic_rhs((model_trial_stochastic_internal*)internal, step, state, state_next, output);
}
SEXP model_trial_stochastic_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  model_trial_stochastic_internal *internal = model_trial_stochastic_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, internal->dim_N + 2));
  setAttrib(state_next, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  GetRNGstate();
  model_trial_stochastic_rhs(internal, scalar_int(step, "step"), REAL(state), REAL(state_next), output);
  PutRNGstate();
  UNPROTECT(1);
  return state_next;
}
model_withouthistory_internal* model_withouthistory_get_internal(SEXP internal_p, int closed_error) {
  model_withouthistory_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (model_withouthistory_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void model_withouthistory_finalise(SEXP internal_p) {
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_beta);
    cinterpolate_free(internal->interpolate_eta_h);
    cinterpolate_free(internal->interpolate_eta_l);
    cinterpolate_free(internal->interpolate_vax_switch);
    internal->interpolate_beta = NULL;
    internal->interpolate_eta_h = NULL;
    internal->interpolate_eta_l = NULL;
    internal->interpolate_vax_switch = NULL;
    R_Free(internal->A0);
    R_Free(internal->beta_t);
    R_Free(internal->C);
    R_Free(internal->entrants);
    R_Free(internal->eta);
    R_Free(internal->eta_h_t);
    R_Free(internal->eta_l_t);
    R_Free(internal->foi_LH);
    R_Free(internal->I0);
    R_Free(internal->initial_A);
    R_Free(internal->initial_cum_diag_a);
    R_Free(internal->initial_cum_diag_s);
    R_Free(internal->initial_cum_incid);
    R_Free(internal->initial_cum_offered);
    R_Free(internal->initial_cum_offered_vbe);
    R_Free(internal->initial_cum_screened);
    R_Free(internal->initial_cum_treated);
    R_Free(internal->initial_cum_vaccinated);
    R_Free(internal->initial_cum_vbe);
    R_Free(internal->initial_I);
    R_Free(internal->initial_S);
    R_Free(internal->initial_T);
    R_Free(internal->initial_U);
    R_Free(internal->lambda);
    R_Free(internal->N);
    R_Free(internal->n_AT);
    R_Free(internal->n_AU);
    R_Free(internal->n_obe);
    R_Free(internal->n_ood);
    R_Free(internal->n_oos);
    R_Free(internal->n_ST);
    R_Free(internal->n_TU);
    R_Free(internal->n_UI);
    R_Free(internal->n_vbe);
    R_Free(internal->n_vod);
    R_Free(internal->n_vos);
    R_Free(internal->Np);
    R_Free(internal->p);
    R_Free(internal->prop_C);
    R_Free(internal->q);
    R_Free(internal->S0);
    R_Free(internal->screened);
    R_Free(internal->T0);
    R_Free(internal->tt);
    R_Free(internal->u);
    R_Free(internal->U0);
    R_Free(internal->vax_t);
    R_Free(internal->vax_y);
    R_Free(internal->vbe);
    R_Free(internal->vea);
    R_Free(internal->ved);
    R_Free(internal->vei);
    R_Free(internal->ves);
    R_Free(internal->vod);
    R_Free(internal->vos);
    R_Free(internal->w);
    R_Free(internal->wA);
    R_Free(internal->wI);
    R_Free(internal->willing);
    R_Free(internal->wS);
    R_Free(internal->wT);
    R_Free(internal->wU);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP model_withouthistory_create(SEXP user) {
  model_withouthistory_internal *internal = (model_withouthistory_internal*) R_Calloc(1, model_withouthistory_internal);
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->C = NULL;
  internal->entrants = NULL;
  internal->eta = NULL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->foi_LH = NULL;
  internal->I0 = NULL;
  internal->initial_A = NULL;
  internal->initial_cum_diag_a = NULL;
  internal->initial_cum_diag_s = NULL;
  internal->initial_cum_incid = NULL;
  internal->initial_cum_offered = NULL;
  internal->initial_cum_offered_vbe = NULL;
  internal->initial_cum_screened = NULL;
  internal->initial_cum_treated = NULL;
  internal->initial_cum_vaccinated = NULL;
  internal->initial_cum_vbe = NULL;
  internal->initial_I = NULL;
  internal->initial_S = NULL;
  internal->initial_T = NULL;
  internal->initial_U = NULL;
  internal->lambda = NULL;
  internal->N = NULL;
  internal->n_AT = NULL;
  internal->n_AU = NULL;
  internal->n_obe = NULL;
  internal->n_ood = NULL;
  internal->n_oos = NULL;
  internal->n_ST = NULL;
  internal->n_TU = NULL;
  internal->n_UI = NULL;
  internal->n_vbe = NULL;
  internal->n_vod = NULL;
  internal->n_vos = NULL;
  internal->Np = NULL;
  internal->p = NULL;
  internal->prop_C = NULL;
  internal->q = NULL;
  internal->S0 = NULL;
  internal->screened = NULL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u = NULL;
  internal->U0 = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->wA = NULL;
  internal->wI = NULL;
  internal->willing = NULL;
  internal->wS = NULL;
  internal->wT = NULL;
  internal->wU = NULL;
  internal->n_group = 2;
  internal->dim_eta = internal->n_group;
  internal->dim_foi_LH = internal->n_group;
  internal->dim_lambda = internal->n_group;
  internal->dim_Np = internal->n_group;
  internal->dim_p = internal->n_group;
  internal->dim_prop_C = internal->n_group;
  internal->dim_q = internal->n_group;
  R_Free(internal->eta);
  internal->eta = (double*) R_Calloc(internal->dim_eta, double);
  R_Free(internal->foi_LH);
  internal->foi_LH = (double*) R_Calloc(internal->dim_foi_LH, double);
  R_Free(internal->lambda);
  internal->lambda = (double*) R_Calloc(internal->dim_lambda, double);
  R_Free(internal->Np);
  internal->Np = (double*) R_Calloc(internal->dim_Np, double);
  R_Free(internal->prop_C);
  internal->prop_C = (double*) R_Calloc(internal->dim_prop_C, double);
  internal->offset_output_lambda = internal->dim_eta + 3;
  internal->offset_output_N = internal->dim_eta + internal->dim_lambda + 3;
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->enr = NA_REAL;
  internal->epsilon = NA_REAL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->exr = NA_REAL;
  internal->I0 = NULL;
  internal->mu = NA_REAL;
  internal->nu = NA_REAL;
  internal->p = NULL;
  internal->psi = NA_REAL;
  internal->q = NULL;
  internal->rho = NA_REAL;
  internal->S0 = NULL;
  internal->sigma = NA_REAL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u = NULL;
  internal->u_vbe = NA_REAL;
  internal->U0 = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->willing = NULL;
  internal->n_vax = 1;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, model_withouthistory_finalise);
  UNPROTECT(1);
  return ptr;
}
static model_withouthistory_internal *model_withouthistory_internal_ds;
void model_withouthistory_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  model_withouthistory_internal_ds = model_withouthistory_get_internal(get_desolve_gparms(), 1);
}
SEXP model_withouthistory_contents(SEXP internal_p) {
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 271));
  SEXP A0 = PROTECT(allocVector(REALSXP, internal->dim_A0));
  memcpy(REAL(A0), internal->A0, internal->dim_A0 * sizeof(double));
  odin_set_dim(A0, 2, internal->dim_A0_1, internal->dim_A0_2);
  SET_VECTOR_ELT(contents, 0, A0);
  SEXP beta_t = PROTECT(allocVector(REALSXP, internal->dim_beta_t));
  memcpy(REAL(beta_t), internal->beta_t, internal->dim_beta_t * sizeof(double));
  SET_VECTOR_ELT(contents, 1, beta_t);
  SEXP C = PROTECT(allocVector(REALSXP, internal->dim_C));
  memcpy(REAL(C), internal->C, internal->dim_C * sizeof(double));
  odin_set_dim(C, 2, internal->dim_C_1, internal->dim_C_2);
  SET_VECTOR_ELT(contents, 2, C);
  SET_VECTOR_ELT(contents, 3, ScalarInteger(internal->dim_A));
  SET_VECTOR_ELT(contents, 4, ScalarInteger(internal->dim_A_1));
  SET_VECTOR_ELT(contents, 5, ScalarInteger(internal->dim_A_2));
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_A0));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_A0_1));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_A0_2));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_beta_t));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_C));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_C_1));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_C_2));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_cum_diag_a));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_cum_diag_a_1));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_cum_diag_a_2));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_cum_diag_s));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_cum_diag_s_1));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_cum_diag_s_2));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_cum_incid));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_cum_incid_1));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_cum_incid_2));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_cum_offered));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_cum_offered_1));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_cum_offered_2));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_cum_offered_vbe_1));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_cum_offered_vbe_2));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_cum_screened));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_cum_screened_1));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_cum_screened_2));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_cum_treated));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_cum_treated_1));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_cum_treated_2));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_cum_vaccinated));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_cum_vaccinated_1));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_cum_vaccinated_2));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_cum_vbe));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_cum_vbe_1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_cum_vbe_2));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_entrants));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_entrants_1));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_entrants_2));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_eta_h_t));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_eta_l_t));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_foi_LH));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_I_1));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_I_2));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_I0));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_I0_1));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_I0_2));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_lambda));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_n_AT));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_n_AT_1));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_n_AT_2));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_n_AU));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_n_AU_1));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_n_AU_2));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_n_obe));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_n_obe_1));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_n_obe_12));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_n_obe_2));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_n_obe_3));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_n_ood));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_n_ood_1));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_n_ood_12));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_n_ood_2));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_n_ood_3));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_n_oos));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_n_oos_1));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_n_oos_12));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_n_oos_2));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_n_oos_3));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_n_ST));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_n_ST_1));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_n_ST_2));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_n_TU));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_n_TU_1));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_n_TU_2));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_n_UI));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_n_UI_1));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_n_UI_2));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_n_vbe));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_n_vbe_1));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_n_vbe_12));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_n_vbe_2));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_n_vbe_3));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_n_vod));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_n_vod_1));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_n_vod_12));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_n_vod_2));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_n_vod_3));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_n_vos));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_n_vos_1));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_n_vos_12));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_n_vos_2));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_n_vos_3));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_Np));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_p));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_prop_C));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_q));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_S0));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_S0_1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_S0_2));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_screened));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_screened_1));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_screened_2));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_T));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_T_1));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_T_2));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_T0));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_T0_1));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_T0_2));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_tt));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_u));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_U));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_u_1));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_U_1));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_u_12));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_u_2));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_U_2));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_u_3));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_U0));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_U0_1));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_U0_2));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_vax_t));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_vax_y));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_vbe));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_vbe_1));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_vbe_12));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_vbe_2));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_vbe_3));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_vea));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_ved));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_vei));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_ves));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_vod));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_vod_1));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_vod_12));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_vod_2));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_vod_3));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_vos));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_vos_1));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_vos_12));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_vos_2));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_vos_3));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_w));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_w_1));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_w_2));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_wA));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_wA_1));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_wA_12));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_wA_2));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_wA_3));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_wI));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_wI_1));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_wI_12));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_wI_2));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_wI_3));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_willing));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_wS));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_wS_1));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_wS_12));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_wS_2));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_wS_3));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_wT));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_wT_1));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_wT_12));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_wT_2));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_wT_3));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_wU));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_wU_1));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_wU_12));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_wU_2));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_wU_3));
  SET_VECTOR_ELT(contents, 183, ScalarReal(internal->enr));
  SEXP entrants = PROTECT(allocVector(REALSXP, internal->dim_entrants));
  memcpy(REAL(entrants), internal->entrants, internal->dim_entrants * sizeof(double));
  odin_set_dim(entrants, 2, internal->dim_entrants_1, internal->dim_entrants_2);
  SET_VECTOR_ELT(contents, 184, entrants);
  SET_VECTOR_ELT(contents, 185, ScalarReal(internal->epsilon));
  SEXP eta = PROTECT(allocVector(REALSXP, internal->dim_eta));
  memcpy(REAL(eta), internal->eta, internal->dim_eta * sizeof(double));
  SET_VECTOR_ELT(contents, 186, eta);
  SEXP eta_h_t = PROTECT(allocVector(REALSXP, internal->dim_eta_h_t));
  memcpy(REAL(eta_h_t), internal->eta_h_t, internal->dim_eta_h_t * sizeof(double));
  SET_VECTOR_ELT(contents, 187, eta_h_t);
  SEXP eta_l_t = PROTECT(allocVector(REALSXP, internal->dim_eta_l_t));
  memcpy(REAL(eta_l_t), internal->eta_l_t, internal->dim_eta_l_t * sizeof(double));
  SET_VECTOR_ELT(contents, 188, eta_l_t);
  SET_VECTOR_ELT(contents, 189, ScalarReal(internal->exr));
  SEXP foi_LH = PROTECT(allocVector(REALSXP, internal->dim_foi_LH));
  memcpy(REAL(foi_LH), internal->foi_LH, internal->dim_foi_LH * sizeof(double));
  SET_VECTOR_ELT(contents, 190, foi_LH);
  SEXP I0 = PROTECT(allocVector(REALSXP, internal->dim_I0));
  memcpy(REAL(I0), internal->I0, internal->dim_I0 * sizeof(double));
  odin_set_dim(I0, 2, internal->dim_I0_1, internal->dim_I0_2);
  SET_VECTOR_ELT(contents, 191, I0);
  SEXP initial_A = PROTECT(allocVector(REALSXP, internal->dim_A));
  memcpy(REAL(initial_A), internal->initial_A, internal->dim_A * sizeof(double));
  odin_set_dim(initial_A, 2, internal->dim_A_1, internal->dim_A_2);
  SET_VECTOR_ELT(contents, 192, initial_A);
  SEXP initial_cum_diag_a = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_a));
  memcpy(REAL(initial_cum_diag_a), internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  odin_set_dim(initial_cum_diag_a, 2, internal->dim_cum_diag_a_1, internal->dim_cum_diag_a_2);
  SET_VECTOR_ELT(contents, 193, initial_cum_diag_a);
  SEXP initial_cum_diag_s = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_s));
  memcpy(REAL(initial_cum_diag_s), internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  odin_set_dim(initial_cum_diag_s, 2, internal->dim_cum_diag_s_1, internal->dim_cum_diag_s_2);
  SET_VECTOR_ELT(contents, 194, initial_cum_diag_s);
  SEXP initial_cum_incid = PROTECT(allocVector(REALSXP, internal->dim_cum_incid));
  memcpy(REAL(initial_cum_incid), internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  odin_set_dim(initial_cum_incid, 2, internal->dim_cum_incid_1, internal->dim_cum_incid_2);
  SET_VECTOR_ELT(contents, 195, initial_cum_incid);
  SEXP initial_cum_offered = PROTECT(allocVector(REALSXP, internal->dim_cum_offered));
  memcpy(REAL(initial_cum_offered), internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  odin_set_dim(initial_cum_offered, 2, internal->dim_cum_offered_1, internal->dim_cum_offered_2);
  SET_VECTOR_ELT(contents, 196, initial_cum_offered);
  SEXP initial_cum_offered_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_offered_vbe));
  memcpy(REAL(initial_cum_offered_vbe), internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  odin_set_dim(initial_cum_offered_vbe, 2, internal->dim_cum_offered_vbe_1, internal->dim_cum_offered_vbe_2);
  SET_VECTOR_ELT(contents, 197, initial_cum_offered_vbe);
  SEXP initial_cum_screened = PROTECT(allocVector(REALSXP, internal->dim_cum_screened));
  memcpy(REAL(initial_cum_screened), internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  odin_set_dim(initial_cum_screened, 2, internal->dim_cum_screened_1, internal->dim_cum_screened_2);
  SET_VECTOR_ELT(contents, 198, initial_cum_screened);
  SEXP initial_cum_treated = PROTECT(allocVector(REALSXP, internal->dim_cum_treated));
  memcpy(REAL(initial_cum_treated), internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  odin_set_dim(initial_cum_treated, 2, internal->dim_cum_treated_1, internal->dim_cum_treated_2);
  SET_VECTOR_ELT(contents, 199, initial_cum_treated);
  SEXP initial_cum_vaccinated = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated));
  memcpy(REAL(initial_cum_vaccinated), internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  odin_set_dim(initial_cum_vaccinated, 2, internal->dim_cum_vaccinated_1, internal->dim_cum_vaccinated_2);
  SET_VECTOR_ELT(contents, 200, initial_cum_vaccinated);
  SEXP initial_cum_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_vbe));
  memcpy(REAL(initial_cum_vbe), internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  odin_set_dim(initial_cum_vbe, 2, internal->dim_cum_vbe_1, internal->dim_cum_vbe_2);
  SET_VECTOR_ELT(contents, 201, initial_cum_vbe);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  odin_set_dim(initial_I, 2, internal->dim_I_1, internal->dim_I_2);
  SET_VECTOR_ELT(contents, 202, initial_I);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 2, internal->dim_S_1, internal->dim_S_2);
  SET_VECTOR_ELT(contents, 203, initial_S);
  SEXP initial_T = PROTECT(allocVector(REALSXP, internal->dim_T));
  memcpy(REAL(initial_T), internal->initial_T, internal->dim_T * sizeof(double));
  odin_set_dim(initial_T, 2, internal->dim_T_1, internal->dim_T_2);
  SET_VECTOR_ELT(contents, 204, initial_T);
  SEXP initial_U = PROTECT(allocVector(REALSXP, internal->dim_U));
  memcpy(REAL(initial_U), internal->initial_U, internal->dim_U * sizeof(double));
  odin_set_dim(initial_U, 2, internal->dim_U_1, internal->dim_U_2);
  SET_VECTOR_ELT(contents, 205, initial_U);
  SEXP lambda = PROTECT(allocVector(REALSXP, internal->dim_lambda));
  memcpy(REAL(lambda), internal->lambda, internal->dim_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 210, lambda);
  SET_VECTOR_ELT(contents, 211, ScalarReal(internal->mu));
  SEXP N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(N), internal->N, internal->dim_N * sizeof(double));
  odin_set_dim(N, 2, internal->dim_N_1, internal->dim_N_2);
  SET_VECTOR_ELT(contents, 212, N);
  SEXP n_AT = PROTECT(allocVector(REALSXP, internal->dim_n_AT));
  memcpy(REAL(n_AT), internal->n_AT, internal->dim_n_AT * sizeof(double));
  odin_set_dim(n_AT, 2, internal->dim_n_AT_1, internal->dim_n_AT_2);
  SET_VECTOR_ELT(contents, 213, n_AT);
  SEXP n_AU = PROTECT(allocVector(REALSXP, internal->dim_n_AU));
  memcpy(REAL(n_AU), internal->n_AU, internal->dim_n_AU * sizeof(double));
  odin_set_dim(n_AU, 2, internal->dim_n_AU_1, internal->dim_n_AU_2);
  SET_VECTOR_ELT(contents, 214, n_AU);
  SET_VECTOR_ELT(contents, 215, ScalarInteger(internal->n_group));
  SEXP n_obe = PROTECT(allocVector(REALSXP, internal->dim_n_obe));
  memcpy(REAL(n_obe), internal->n_obe, internal->dim_n_obe * sizeof(double));
  odin_set_dim(n_obe, 3, internal->dim_n_obe_1, internal->dim_n_obe_2, internal->dim_n_obe_3);
  SET_VECTOR_ELT(contents, 216, n_obe);
  SEXP n_ood = PROTECT(allocVector(REALSXP, internal->dim_n_ood));
  memcpy(REAL(n_ood), internal->n_ood, internal->dim_n_ood * sizeof(double));
  odin_set_dim(n_ood, 3, internal->dim_n_ood_1, internal->dim_n_ood_2, internal->dim_n_ood_3);
  SET_VECTOR_ELT(contents, 217, n_ood);
  SEXP n_oos = PROTECT(allocVector(REALSXP, internal->dim_n_oos));
  memcpy(REAL(n_oos), internal->n_oos, internal->dim_n_oos * sizeof(double));
  odin_set_dim(n_oos, 3, internal->dim_n_oos_1, internal->dim_n_oos_2, internal->dim_n_oos_3);
  SET_VECTOR_ELT(contents, 218, n_oos);
  SEXP n_ST = PROTECT(allocVector(REALSXP, internal->dim_n_ST));
  memcpy(REAL(n_ST), internal->n_ST, internal->dim_n_ST * sizeof(double));
  odin_set_dim(n_ST, 2, internal->dim_n_ST_1, internal->dim_n_ST_2);
  SET_VECTOR_ELT(contents, 219, n_ST);
  SEXP n_TU = PROTECT(allocVector(REALSXP, internal->dim_n_TU));
  memcpy(REAL(n_TU), internal->n_TU, internal->dim_n_TU * sizeof(double));
  odin_set_dim(n_TU, 2, internal->dim_n_TU_1, internal->dim_n_TU_2);
  SET_VECTOR_ELT(contents, 220, n_TU);
  SEXP n_UI = PROTECT(allocVector(REALSXP, internal->dim_n_UI));
  memcpy(REAL(n_UI), internal->n_UI, internal->dim_n_UI * sizeof(double));
  odin_set_dim(n_UI, 2, internal->dim_n_UI_1, internal->dim_n_UI_2);
  SET_VECTOR_ELT(contents, 221, n_UI);
  SET_VECTOR_ELT(contents, 222, ScalarInteger(internal->n_vax));
  SEXP n_vbe = PROTECT(allocVector(REALSXP, internal->dim_n_vbe));
  memcpy(REAL(n_vbe), internal->n_vbe, internal->dim_n_vbe * sizeof(double));
  odin_set_dim(n_vbe, 3, internal->dim_n_vbe_1, internal->dim_n_vbe_2, internal->dim_n_vbe_3);
  SET_VECTOR_ELT(contents, 223, n_vbe);
  SEXP n_vod = PROTECT(allocVector(REALSXP, internal->dim_n_vod));
  memcpy(REAL(n_vod), internal->n_vod, internal->dim_n_vod * sizeof(double));
  odin_set_dim(n_vod, 3, internal->dim_n_vod_1, internal->dim_n_vod_2, internal->dim_n_vod_3);
  SET_VECTOR_ELT(contents, 224, n_vod);
  SEXP n_vos = PROTECT(allocVector(REALSXP, internal->dim_n_vos));
  memcpy(REAL(n_vos), internal->n_vos, internal->dim_n_vos * sizeof(double));
  odin_set_dim(n_vos, 3, internal->dim_n_vos_1, internal->dim_n_vos_2, internal->dim_n_vos_3);
  SET_VECTOR_ELT(contents, 225, n_vos);
  SEXP Np = PROTECT(allocVector(REALSXP, internal->dim_Np));
  memcpy(REAL(Np), internal->Np, internal->dim_Np * sizeof(double));
  SET_VECTOR_ELT(contents, 226, Np);
  SET_VECTOR_ELT(contents, 227, ScalarReal(internal->nu));
  SET_VECTOR_ELT(contents, 228, ScalarInteger(internal->offset_output_lambda));
  SET_VECTOR_ELT(contents, 229, ScalarInteger(internal->offset_output_N));
  SET_VECTOR_ELT(contents, 230, ScalarInteger(internal->offset_variable_A));
  SET_VECTOR_ELT(contents, 231, ScalarInteger(internal->offset_variable_cum_diag_a));
  SET_VECTOR_ELT(contents, 232, ScalarInteger(internal->offset_variable_cum_diag_s));
  SET_VECTOR_ELT(contents, 233, ScalarInteger(internal->offset_variable_cum_incid));
  SET_VECTOR_ELT(contents, 234, ScalarInteger(internal->offset_variable_cum_offered));
  SET_VECTOR_ELT(contents, 235, ScalarInteger(internal->offset_variable_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 236, ScalarInteger(internal->offset_variable_cum_screened));
  SET_VECTOR_ELT(contents, 237, ScalarInteger(internal->offset_variable_cum_treated));
  SET_VECTOR_ELT(contents, 238, ScalarInteger(internal->offset_variable_cum_vaccinated));
  SET_VECTOR_ELT(contents, 239, ScalarInteger(internal->offset_variable_cum_vbe));
  SET_VECTOR_ELT(contents, 240, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 241, ScalarInteger(internal->offset_variable_T));
  SEXP p = PROTECT(allocVector(REALSXP, internal->dim_p));
  memcpy(REAL(p), internal->p, internal->dim_p * sizeof(double));
  SET_VECTOR_ELT(contents, 242, p);
  SEXP prop_C = PROTECT(allocVector(REALSXP, internal->dim_prop_C));
  memcpy(REAL(prop_C), internal->prop_C, internal->dim_prop_C * sizeof(double));
  SET_VECTOR_ELT(contents, 243, prop_C);
  SET_VECTOR_ELT(contents, 244, ScalarReal(internal->psi));
  SEXP q = PROTECT(allocVector(REALSXP, internal->dim_q));
  memcpy(REAL(q), internal->q, internal->dim_q * sizeof(double));
  SET_VECTOR_ELT(contents, 245, q);
  SET_VECTOR_ELT(contents, 246, ScalarReal(internal->rho));
  SEXP S0 = PROTECT(allocVector(REALSXP, internal->dim_S0));
  memcpy(REAL(S0), internal->S0, internal->dim_S0 * sizeof(double));
  odin_set_dim(S0, 2, internal->dim_S0_1, internal->dim_S0_2);
  SET_VECTOR_ELT(contents, 247, S0);
  SEXP screened = PROTECT(allocVector(REALSXP, internal->dim_screened));
  memcpy(REAL(screened), internal->screened, internal->dim_screened * sizeof(double));
  odin_set_dim(screened, 2, internal->dim_screened_1, internal->dim_screened_2);
  SET_VECTOR_ELT(contents, 248, screened);
  SET_VECTOR_ELT(contents, 249, ScalarReal(internal->sigma));
  SEXP T0 = PROTECT(allocVector(REALSXP, internal->dim_T0));
  memcpy(REAL(T0), internal->T0, internal->dim_T0 * sizeof(double));
  odin_set_dim(T0, 2, internal->dim_T0_1, internal->dim_T0_2);
  SET_VECTOR_ELT(contents, 250, T0);
  SEXP tt = PROTECT(allocVector(REALSXP, internal->dim_tt));
  memcpy(REAL(tt), internal->tt, internal->dim_tt * sizeof(double));
  SET_VECTOR_ELT(contents, 251, tt);
  SEXP u = PROTECT(allocVector(REALSXP, internal->dim_u));
  memcpy(REAL(u), internal->u, internal->dim_u * sizeof(double));
  odin_set_dim(u, 3, internal->dim_u_1, internal->dim_u_2, internal->dim_u_3);
  SET_VECTOR_ELT(contents, 252, u);
  SET_VECTOR_ELT(contents, 253, ScalarReal(internal->u_vbe));
  SEXP U0 = PROTECT(allocVector(REALSXP, internal->dim_U0));
  memcpy(REAL(U0), internal->U0, internal->dim_U0 * sizeof(double));
  odin_set_dim(U0, 2, internal->dim_U0_1, internal->dim_U0_2);
  SET_VECTOR_ELT(contents, 254, U0);
  SEXP vax_t = PROTECT(allocVector(REALSXP, internal->dim_vax_t));
  memcpy(REAL(vax_t), internal->vax_t, internal->dim_vax_t * sizeof(double));
  SET_VECTOR_ELT(contents, 255, vax_t);
  SEXP vax_y = PROTECT(allocVector(REALSXP, internal->dim_vax_y));
  memcpy(REAL(vax_y), internal->vax_y, internal->dim_vax_y * sizeof(double));
  SET_VECTOR_ELT(contents, 256, vax_y);
  SEXP vbe = PROTECT(allocVector(REALSXP, internal->dim_vbe));
  memcpy(REAL(vbe), internal->vbe, internal->dim_vbe * sizeof(double));
  odin_set_dim(vbe, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  SET_VECTOR_ELT(contents, 257, vbe);
  SEXP vea = PROTECT(allocVector(REALSXP, internal->dim_vea));
  memcpy(REAL(vea), internal->vea, internal->dim_vea * sizeof(double));
  SET_VECTOR_ELT(contents, 258, vea);
  SEXP ved = PROTECT(allocVector(REALSXP, internal->dim_ved));
  memcpy(REAL(ved), internal->ved, internal->dim_ved * sizeof(double));
  SET_VECTOR_ELT(contents, 259, ved);
  SEXP vei = PROTECT(allocVector(REALSXP, internal->dim_vei));
  memcpy(REAL(vei), internal->vei, internal->dim_vei * sizeof(double));
  SET_VECTOR_ELT(contents, 260, vei);
  SEXP ves = PROTECT(allocVector(REALSXP, internal->dim_ves));
  memcpy(REAL(ves), internal->ves, internal->dim_ves * sizeof(double));
  SET_VECTOR_ELT(contents, 261, ves);
  SEXP vod = PROTECT(allocVector(REALSXP, internal->dim_vod));
  memcpy(REAL(vod), internal->vod, internal->dim_vod * sizeof(double));
  odin_set_dim(vod, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  SET_VECTOR_ELT(contents, 262, vod);
  SEXP vos = PROTECT(allocVector(REALSXP, internal->dim_vos));
  memcpy(REAL(vos), internal->vos, internal->dim_vos * sizeof(double));
  odin_set_dim(vos, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  SET_VECTOR_ELT(contents, 263, vos);
  SEXP w = PROTECT(allocVector(REALSXP, internal->dim_w));
  memcpy(REAL(w), internal->w, internal->dim_w * sizeof(double));
  odin_set_dim(w, 2, internal->dim_w_1, internal->dim_w_2);
  SET_VECTOR_ELT(contents, 264, w);
  SEXP wA = PROTECT(allocVector(REALSXP, internal->dim_wA));
  memcpy(REAL(wA), internal->wA, internal->dim_wA * sizeof(double));
  odin_set_dim(wA, 3, internal->dim_wA_1, internal->dim_wA_2, internal->dim_wA_3);
  SET_VECTOR_ELT(contents, 265, wA);
  SEXP wI = PROTECT(allocVector(REALSXP, internal->dim_wI));
  memcpy(REAL(wI), internal->wI, internal->dim_wI * sizeof(double));
  odin_set_dim(wI, 3, internal->dim_wI_1, internal->dim_wI_2, internal->dim_wI_3);
  SET_VECTOR_ELT(contents, 266, wI);
  SEXP willing = PROTECT(allocVector(REALSXP, internal->dim_willing));
  memcpy(REAL(willing), internal->willing, internal->dim_willing * sizeof(double));
  SET_VECTOR_ELT(contents, 267, willing);
  SEXP wS = PROTECT(allocVector(REALSXP, internal->dim_wS));
  memcpy(REAL(wS), internal->wS, internal->dim_wS * sizeof(double));
  odin_set_dim(wS, 3, internal->dim_wS_1, internal->dim_wS_2, internal->dim_wS_3);
  SET_VECTOR_ELT(contents, 268, wS);
  SEXP wT = PROTECT(allocVector(REALSXP, internal->dim_wT));
  memcpy(REAL(wT), internal->wT, internal->dim_wT * sizeof(double));
  odin_set_dim(wT, 3, internal->dim_wT_1, internal->dim_wT_2, internal->dim_wT_3);
  SET_VECTOR_ELT(contents, 269, wT);
  SEXP wU = PROTECT(allocVector(REALSXP, internal->dim_wU));
  memcpy(REAL(wU), internal->wU, internal->dim_wU * sizeof(double));
  odin_set_dim(wU, 3, internal->dim_wU_1, internal->dim_wU_2, internal->dim_wU_3);
  SET_VECTOR_ELT(contents, 270, wU);
  SEXP nms = PROTECT(allocVector(STRSXP, 271));
  SET_STRING_ELT(nms, 0, mkChar("A0"));
  SET_STRING_ELT(nms, 1, mkChar("beta_t"));
  SET_STRING_ELT(nms, 2, mkChar("C"));
  SET_STRING_ELT(nms, 3, mkChar("dim_A"));
  SET_STRING_ELT(nms, 4, mkChar("dim_A_1"));
  SET_STRING_ELT(nms, 5, mkChar("dim_A_2"));
  SET_STRING_ELT(nms, 6, mkChar("dim_A0"));
  SET_STRING_ELT(nms, 7, mkChar("dim_A0_1"));
  SET_STRING_ELT(nms, 8, mkChar("dim_A0_2"));
  SET_STRING_ELT(nms, 9, mkChar("dim_beta_t"));
  SET_STRING_ELT(nms, 10, mkChar("dim_C"));
  SET_STRING_ELT(nms, 11, mkChar("dim_C_1"));
  SET_STRING_ELT(nms, 12, mkChar("dim_C_2"));
  SET_STRING_ELT(nms, 13, mkChar("dim_cum_diag_a"));
  SET_STRING_ELT(nms, 14, mkChar("dim_cum_diag_a_1"));
  SET_STRING_ELT(nms, 15, mkChar("dim_cum_diag_a_2"));
  SET_STRING_ELT(nms, 16, mkChar("dim_cum_diag_s"));
  SET_STRING_ELT(nms, 17, mkChar("dim_cum_diag_s_1"));
  SET_STRING_ELT(nms, 18, mkChar("dim_cum_diag_s_2"));
  SET_STRING_ELT(nms, 19, mkChar("dim_cum_incid"));
  SET_STRING_ELT(nms, 20, mkChar("dim_cum_incid_1"));
  SET_STRING_ELT(nms, 21, mkChar("dim_cum_incid_2"));
  SET_STRING_ELT(nms, 22, mkChar("dim_cum_offered"));
  SET_STRING_ELT(nms, 23, mkChar("dim_cum_offered_1"));
  SET_STRING_ELT(nms, 24, mkChar("dim_cum_offered_2"));
  SET_STRING_ELT(nms, 25, mkChar("dim_cum_offered_vbe"));
  SET_STRING_ELT(nms, 26, mkChar("dim_cum_offered_vbe_1"));
  SET_STRING_ELT(nms, 27, mkChar("dim_cum_offered_vbe_2"));
  SET_STRING_ELT(nms, 28, mkChar("dim_cum_screened"));
  SET_STRING_ELT(nms, 29, mkChar("dim_cum_screened_1"));
  SET_STRING_ELT(nms, 30, mkChar("dim_cum_screened_2"));
  SET_STRING_ELT(nms, 31, mkChar("dim_cum_treated"));
  SET_STRING_ELT(nms, 32, mkChar("dim_cum_treated_1"));
  SET_STRING_ELT(nms, 33, mkChar("dim_cum_treated_2"));
  SET_STRING_ELT(nms, 34, mkChar("dim_cum_vaccinated"));
  SET_STRING_ELT(nms, 35, mkChar("dim_cum_vaccinated_1"));
  SET_STRING_ELT(nms, 36, mkChar("dim_cum_vaccinated_2"));
  SET_STRING_ELT(nms, 37, mkChar("dim_cum_vbe"));
  SET_STRING_ELT(nms, 38, mkChar("dim_cum_vbe_1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_cum_vbe_2"));
  SET_STRING_ELT(nms, 40, mkChar("dim_entrants"));
  SET_STRING_ELT(nms, 41, mkChar("dim_entrants_1"));
  SET_STRING_ELT(nms, 42, mkChar("dim_entrants_2"));
  SET_STRING_ELT(nms, 43, mkChar("dim_eta"));
  SET_STRING_ELT(nms, 44, mkChar("dim_eta_h_t"));
  SET_STRING_ELT(nms, 45, mkChar("dim_eta_l_t"));
  SET_STRING_ELT(nms, 46, mkChar("dim_foi_LH"));
  SET_STRING_ELT(nms, 47, mkChar("dim_I"));
  SET_STRING_ELT(nms, 48, mkChar("dim_I_1"));
  SET_STRING_ELT(nms, 49, mkChar("dim_I_2"));
  SET_STRING_ELT(nms, 50, mkChar("dim_I0"));
  SET_STRING_ELT(nms, 51, mkChar("dim_I0_1"));
  SET_STRING_ELT(nms, 52, mkChar("dim_I0_2"));
  SET_STRING_ELT(nms, 53, mkChar("dim_lambda"));
  SET_STRING_ELT(nms, 54, mkChar("dim_N"));
  SET_STRING_ELT(nms, 55, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 56, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 57, mkChar("dim_n_AT"));
  SET_STRING_ELT(nms, 58, mkChar("dim_n_AT_1"));
  SET_STRING_ELT(nms, 59, mkChar("dim_n_AT_2"));
  SET_STRING_ELT(nms, 60, mkChar("dim_n_AU"));
  SET_STRING_ELT(nms, 61, mkChar("dim_n_AU_1"));
  SET_STRING_ELT(nms, 62, mkChar("dim_n_AU_2"));
  SET_STRING_ELT(nms, 63, mkChar("dim_n_obe"));
  SET_STRING_ELT(nms, 64, mkChar("dim_n_obe_1"));
  SET_STRING_ELT(nms, 65, mkChar("dim_n_obe_12"));
  SET_STRING_ELT(nms, 66, mkChar("dim_n_obe_2"));
  SET_STRING_ELT(nms, 67, mkChar("dim_n_obe_3"));
  SET_STRING_ELT(nms, 68, mkChar("dim_n_ood"));
  SET_STRING_ELT(nms, 69, mkChar("dim_n_ood_1"));
  SET_STRING_ELT(nms, 70, mkChar("dim_n_ood_12"));
  SET_STRING_ELT(nms, 71, mkChar("dim_n_ood_2"));
  SET_STRING_ELT(nms, 72, mkChar("dim_n_ood_3"));
  SET_STRING_ELT(nms, 73, mkChar("dim_n_oos"));
  SET_STRING_ELT(nms, 74, mkChar("dim_n_oos_1"));
  SET_STRING_ELT(nms, 75, mkChar("dim_n_oos_12"));
  SET_STRING_ELT(nms, 76, mkChar("dim_n_oos_2"));
  SET_STRING_ELT(nms, 77, mkChar("dim_n_oos_3"));
  SET_STRING_ELT(nms, 78, mkChar("dim_n_ST"));
  SET_STRING_ELT(nms, 79, mkChar("dim_n_ST_1"));
  SET_STRING_ELT(nms, 80, mkChar("dim_n_ST_2"));
  SET_STRING_ELT(nms, 81, mkChar("dim_n_TU"));
  SET_STRING_ELT(nms, 82, mkChar("dim_n_TU_1"));
  SET_STRING_ELT(nms, 83, mkChar("dim_n_TU_2"));
  SET_STRING_ELT(nms, 84, mkChar("dim_n_UI"));
  SET_STRING_ELT(nms, 85, mkChar("dim_n_UI_1"));
  SET_STRING_ELT(nms, 86, mkChar("dim_n_UI_2"));
  SET_STRING_ELT(nms, 87, mkChar("dim_n_vbe"));
  SET_STRING_ELT(nms, 88, mkChar("dim_n_vbe_1"));
  SET_STRING_ELT(nms, 89, mkChar("dim_n_vbe_12"));
  SET_STRING_ELT(nms, 90, mkChar("dim_n_vbe_2"));
  SET_STRING_ELT(nms, 91, mkChar("dim_n_vbe_3"));
  SET_STRING_ELT(nms, 92, mkChar("dim_n_vod"));
  SET_STRING_ELT(nms, 93, mkChar("dim_n_vod_1"));
  SET_STRING_ELT(nms, 94, mkChar("dim_n_vod_12"));
  SET_STRING_ELT(nms, 95, mkChar("dim_n_vod_2"));
  SET_STRING_ELT(nms, 96, mkChar("dim_n_vod_3"));
  SET_STRING_ELT(nms, 97, mkChar("dim_n_vos"));
  SET_STRING_ELT(nms, 98, mkChar("dim_n_vos_1"));
  SET_STRING_ELT(nms, 99, mkChar("dim_n_vos_12"));
  SET_STRING_ELT(nms, 100, mkChar("dim_n_vos_2"));
  SET_STRING_ELT(nms, 101, mkChar("dim_n_vos_3"));
  SET_STRING_ELT(nms, 102, mkChar("dim_Np"));
  SET_STRING_ELT(nms, 103, mkChar("dim_p"));
  SET_STRING_ELT(nms, 104, mkChar("dim_prop_C"));
  SET_STRING_ELT(nms, 105, mkChar("dim_q"));
  SET_STRING_ELT(nms, 106, mkChar("dim_S"));
  SET_STRING_ELT(nms, 107, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 108, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 109, mkChar("dim_S0"));
  SET_STRING_ELT(nms, 110, mkChar("dim_S0_1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_S0_2"));
  SET_STRING_ELT(nms, 112, mkChar("dim_screened"));
  SET_STRING_ELT(nms, 113, mkChar("dim_screened_1"));
  SET_STRING_ELT(nms, 114, mkChar("dim_screened_2"));
  SET_STRING_ELT(nms, 115, mkChar("dim_T"));
  SET_STRING_ELT(nms, 116, mkChar("dim_T_1"));
  SET_STRING_ELT(nms, 117, mkChar("dim_T_2"));
  SET_STRING_ELT(nms, 118, mkChar("dim_T0"));
  SET_STRING_ELT(nms, 119, mkChar("dim_T0_1"));
  SET_STRING_ELT(nms, 120, mkChar("dim_T0_2"));
  SET_STRING_ELT(nms, 121, mkChar("dim_tt"));
  SET_STRING_ELT(nms, 122, mkChar("dim_u"));
  SET_STRING_ELT(nms, 123, mkChar("dim_U"));
  SET_STRING_ELT(nms, 124, mkChar("dim_u_1"));
  SET_STRING_ELT(nms, 125, mkChar("dim_U_1"));
  SET_STRING_ELT(nms, 126, mkChar("dim_u_12"));
  SET_STRING_ELT(nms, 127, mkChar("dim_u_2"));
  SET_STRING_ELT(nms, 128, mkChar("dim_U_2"));
  SET_STRING_ELT(nms, 129, mkChar("dim_u_3"));
  SET_STRING_ELT(nms, 130, mkChar("dim_U0"));
  SET_STRING_ELT(nms, 131, mkChar("dim_U0_1"));
  SET_STRING_ELT(nms, 132, mkChar("dim_U0_2"));
  SET_STRING_ELT(nms, 133, mkChar("dim_vax_t"));
  SET_STRING_ELT(nms, 134, mkChar("dim_vax_y"));
  SET_STRING_ELT(nms, 135, mkChar("dim_vbe"));
  SET_STRING_ELT(nms, 136, mkChar("dim_vbe_1"));
  SET_STRING_ELT(nms, 137, mkChar("dim_vbe_12"));
  SET_STRING_ELT(nms, 138, mkChar("dim_vbe_2"));
  SET_STRING_ELT(nms, 139, mkChar("dim_vbe_3"));
  SET_STRING_ELT(nms, 140, mkChar("dim_vea"));
  SET_STRING_ELT(nms, 141, mkChar("dim_ved"));
  SET_STRING_ELT(nms, 142, mkChar("dim_vei"));
  SET_STRING_ELT(nms, 143, mkChar("dim_ves"));
  SET_STRING_ELT(nms, 144, mkChar("dim_vod"));
  SET_STRING_ELT(nms, 145, mkChar("dim_vod_1"));
  SET_STRING_ELT(nms, 146, mkChar("dim_vod_12"));
  SET_STRING_ELT(nms, 147, mkChar("dim_vod_2"));
  SET_STRING_ELT(nms, 148, mkChar("dim_vod_3"));
  SET_STRING_ELT(nms, 149, mkChar("dim_vos"));
  SET_STRING_ELT(nms, 150, mkChar("dim_vos_1"));
  SET_STRING_ELT(nms, 151, mkChar("dim_vos_12"));
  SET_STRING_ELT(nms, 152, mkChar("dim_vos_2"));
  SET_STRING_ELT(nms, 153, mkChar("dim_vos_3"));
  SET_STRING_ELT(nms, 154, mkChar("dim_w"));
  SET_STRING_ELT(nms, 155, mkChar("dim_w_1"));
  SET_STRING_ELT(nms, 156, mkChar("dim_w_2"));
  SET_STRING_ELT(nms, 157, mkChar("dim_wA"));
  SET_STRING_ELT(nms, 158, mkChar("dim_wA_1"));
  SET_STRING_ELT(nms, 159, mkChar("dim_wA_12"));
  SET_STRING_ELT(nms, 160, mkChar("dim_wA_2"));
  SET_STRING_ELT(nms, 161, mkChar("dim_wA_3"));
  SET_STRING_ELT(nms, 162, mkChar("dim_wI"));
  SET_STRING_ELT(nms, 163, mkChar("dim_wI_1"));
  SET_STRING_ELT(nms, 164, mkChar("dim_wI_12"));
  SET_STRING_ELT(nms, 165, mkChar("dim_wI_2"));
  SET_STRING_ELT(nms, 166, mkChar("dim_wI_3"));
  SET_STRING_ELT(nms, 167, mkChar("dim_willing"));
  SET_STRING_ELT(nms, 168, mkChar("dim_wS"));
  SET_STRING_ELT(nms, 169, mkChar("dim_wS_1"));
  SET_STRING_ELT(nms, 170, mkChar("dim_wS_12"));
  SET_STRING_ELT(nms, 171, mkChar("dim_wS_2"));
  SET_STRING_ELT(nms, 172, mkChar("dim_wS_3"));
  SET_STRING_ELT(nms, 173, mkChar("dim_wT"));
  SET_STRING_ELT(nms, 174, mkChar("dim_wT_1"));
  SET_STRING_ELT(nms, 175, mkChar("dim_wT_12"));
  SET_STRING_ELT(nms, 176, mkChar("dim_wT_2"));
  SET_STRING_ELT(nms, 177, mkChar("dim_wT_3"));
  SET_STRING_ELT(nms, 178, mkChar("dim_wU"));
  SET_STRING_ELT(nms, 179, mkChar("dim_wU_1"));
  SET_STRING_ELT(nms, 180, mkChar("dim_wU_12"));
  SET_STRING_ELT(nms, 181, mkChar("dim_wU_2"));
  SET_STRING_ELT(nms, 182, mkChar("dim_wU_3"));
  SET_STRING_ELT(nms, 183, mkChar("enr"));
  SET_STRING_ELT(nms, 184, mkChar("entrants"));
  SET_STRING_ELT(nms, 185, mkChar("epsilon"));
  SET_STRING_ELT(nms, 186, mkChar("eta"));
  SET_STRING_ELT(nms, 187, mkChar("eta_h_t"));
  SET_STRING_ELT(nms, 188, mkChar("eta_l_t"));
  SET_STRING_ELT(nms, 189, mkChar("exr"));
  SET_STRING_ELT(nms, 190, mkChar("foi_LH"));
  SET_STRING_ELT(nms, 191, mkChar("I0"));
  SET_STRING_ELT(nms, 192, mkChar("initial_A"));
  SET_STRING_ELT(nms, 193, mkChar("initial_cum_diag_a"));
  SET_STRING_ELT(nms, 194, mkChar("initial_cum_diag_s"));
  SET_STRING_ELT(nms, 195, mkChar("initial_cum_incid"));
  SET_STRING_ELT(nms, 196, mkChar("initial_cum_offered"));
  SET_STRING_ELT(nms, 197, mkChar("initial_cum_offered_vbe"));
  SET_STRING_ELT(nms, 198, mkChar("initial_cum_screened"));
  SET_STRING_ELT(nms, 199, mkChar("initial_cum_treated"));
  SET_STRING_ELT(nms, 200, mkChar("initial_cum_vaccinated"));
  SET_STRING_ELT(nms, 201, mkChar("initial_cum_vbe"));
  SET_STRING_ELT(nms, 202, mkChar("initial_I"));
  SET_STRING_ELT(nms, 203, mkChar("initial_S"));
  SET_STRING_ELT(nms, 204, mkChar("initial_T"));
  SET_STRING_ELT(nms, 205, mkChar("initial_U"));
  SET_STRING_ELT(nms, 206, mkChar("interpolate_beta"));
  SET_STRING_ELT(nms, 207, mkChar("interpolate_eta_h"));
  SET_STRING_ELT(nms, 208, mkChar("interpolate_eta_l"));
  SET_STRING_ELT(nms, 209, mkChar("interpolate_vax_switch"));
  SET_STRING_ELT(nms, 210, mkChar("lambda"));
  SET_STRING_ELT(nms, 211, mkChar("mu"));
  SET_STRING_ELT(nms, 212, mkChar("N"));
  SET_STRING_ELT(nms, 213, mkChar("n_AT"));
  SET_STRING_ELT(nms, 214, mkChar("n_AU"));
  SET_STRING_ELT(nms, 215, mkChar("n_group"));
  SET_STRING_ELT(nms, 216, mkChar("n_obe"));
  SET_STRING_ELT(nms, 217, mkChar("n_ood"));
  SET_STRING_ELT(nms, 218, mkChar("n_oos"));
  SET_STRING_ELT(nms, 219, mkChar("n_ST"));
  SET_STRING_ELT(nms, 220, mkChar("n_TU"));
  SET_STRING_ELT(nms, 221, mkChar("n_UI"));
  SET_STRING_ELT(nms, 222, mkChar("n_vax"));
  SET_STRING_ELT(nms, 223, mkChar("n_vbe"));
  SET_STRING_ELT(nms, 224, mkChar("n_vod"));
  SET_STRING_ELT(nms, 225, mkChar("n_vos"));
  SET_STRING_ELT(nms, 226, mkChar("Np"));
  SET_STRING_ELT(nms, 227, mkChar("nu"));
  SET_STRING_ELT(nms, 228, mkChar("offset_output_lambda"));
  SET_STRING_ELT(nms, 229, mkChar("offset_output_N"));
  SET_STRING_ELT(nms, 230, mkChar("offset_variable_A"));
  SET_STRING_ELT(nms, 231, mkChar("offset_variable_cum_diag_a"));
  SET_STRING_ELT(nms, 232, mkChar("offset_variable_cum_diag_s"));
  SET_STRING_ELT(nms, 233, mkChar("offset_variable_cum_incid"));
  SET_STRING_ELT(nms, 234, mkChar("offset_variable_cum_offered"));
  SET_STRING_ELT(nms, 235, mkChar("offset_variable_cum_offered_vbe"));
  SET_STRING_ELT(nms, 236, mkChar("offset_variable_cum_screened"));
  SET_STRING_ELT(nms, 237, mkChar("offset_variable_cum_treated"));
  SET_STRING_ELT(nms, 238, mkChar("offset_variable_cum_vaccinated"));
  SET_STRING_ELT(nms, 239, mkChar("offset_variable_cum_vbe"));
  SET_STRING_ELT(nms, 240, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 241, mkChar("offset_variable_T"));
  SET_STRING_ELT(nms, 242, mkChar("p"));
  SET_STRING_ELT(nms, 243, mkChar("prop_C"));
  SET_STRING_ELT(nms, 244, mkChar("psi"));
  SET_STRING_ELT(nms, 245, mkChar("q"));
  SET_STRING_ELT(nms, 246, mkChar("rho"));
  SET_STRING_ELT(nms, 247, mkChar("S0"));
  SET_STRING_ELT(nms, 248, mkChar("screened"));
  SET_STRING_ELT(nms, 249, mkChar("sigma"));
  SET_STRING_ELT(nms, 250, mkChar("T0"));
  SET_STRING_ELT(nms, 251, mkChar("tt"));
  SET_STRING_ELT(nms, 252, mkChar("u"));
  SET_STRING_ELT(nms, 253, mkChar("u_vbe"));
  SET_STRING_ELT(nms, 254, mkChar("U0"));
  SET_STRING_ELT(nms, 255, mkChar("vax_t"));
  SET_STRING_ELT(nms, 256, mkChar("vax_y"));
  SET_STRING_ELT(nms, 257, mkChar("vbe"));
  SET_STRING_ELT(nms, 258, mkChar("vea"));
  SET_STRING_ELT(nms, 259, mkChar("ved"));
  SET_STRING_ELT(nms, 260, mkChar("vei"));
  SET_STRING_ELT(nms, 261, mkChar("ves"));
  SET_STRING_ELT(nms, 262, mkChar("vod"));
  SET_STRING_ELT(nms, 263, mkChar("vos"));
  SET_STRING_ELT(nms, 264, mkChar("w"));
  SET_STRING_ELT(nms, 265, mkChar("wA"));
  SET_STRING_ELT(nms, 266, mkChar("wI"));
  SET_STRING_ELT(nms, 267, mkChar("willing"));
  SET_STRING_ELT(nms, 268, mkChar("wS"));
  SET_STRING_ELT(nms, 269, mkChar("wT"));
  SET_STRING_ELT(nms, 270, mkChar("wU"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(64);
  return contents;
}
SEXP model_withouthistory_set_user(SEXP internal_p, SEXP user) {
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 1);
  internal->enr = user_get_scalar_double(user, "enr", internal->enr, NA_REAL, NA_REAL);
  internal->epsilon = user_get_scalar_double(user, "epsilon", internal->epsilon, NA_REAL, NA_REAL);
  internal->exr = user_get_scalar_double(user, "exr", internal->exr, NA_REAL, NA_REAL);
  internal->mu = user_get_scalar_double(user, "mu", internal->mu, NA_REAL, NA_REAL);
  internal->n_vax = user_get_scalar_int(user, "n_vax", internal->n_vax, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->psi = user_get_scalar_double(user, "psi", internal->psi, NA_REAL, NA_REAL);
  internal->rho = user_get_scalar_double(user, "rho", internal->rho, NA_REAL, NA_REAL);
  internal->sigma = user_get_scalar_double(user, "sigma", internal->sigma, NA_REAL, NA_REAL);
  internal->tt = (double*) user_get_array_dim(user, false, internal->tt, "tt", 1, NA_REAL, NA_REAL, &internal->dim_tt);
  internal->u_vbe = user_get_scalar_double(user, "u_vbe", internal->u_vbe, NA_REAL, NA_REAL);
  internal->vax_t = (double*) user_get_array_dim(user, false, internal->vax_t, "vax_t", 1, NA_REAL, NA_REAL, &internal->dim_vax_t);
  internal->vax_y = (double*) user_get_array_dim(user, false, internal->vax_y, "vax_y", 1, NA_REAL, NA_REAL, &internal->dim_vax_y);
  internal->dim_A_1 = internal->n_group;
  internal->dim_A_2 = internal->n_vax;
  internal->dim_A0_1 = internal->n_group;
  internal->dim_A0_2 = internal->n_vax;
  internal->dim_C_1 = internal->n_group;
  internal->dim_C_2 = internal->n_vax;
  internal->dim_cum_diag_a_1 = internal->n_group;
  internal->dim_cum_diag_a_2 = internal->n_vax;
  internal->dim_cum_diag_s_1 = internal->n_group;
  internal->dim_cum_diag_s_2 = internal->n_vax;
  internal->dim_cum_incid_1 = internal->n_group;
  internal->dim_cum_incid_2 = internal->n_vax;
  internal->dim_cum_offered_1 = internal->n_group;
  internal->dim_cum_offered_2 = internal->n_vax;
  internal->dim_cum_offered_vbe_1 = internal->n_group;
  internal->dim_cum_offered_vbe_2 = internal->n_vax;
  internal->dim_cum_screened_1 = internal->n_group;
  internal->dim_cum_screened_2 = internal->n_vax;
  internal->dim_cum_treated_1 = internal->n_group;
  internal->dim_cum_treated_2 = internal->n_vax;
  internal->dim_cum_vaccinated_1 = internal->n_group;
  internal->dim_cum_vaccinated_2 = internal->n_vax;
  internal->dim_cum_vbe_1 = internal->n_group;
  internal->dim_cum_vbe_2 = internal->n_vax;
  internal->dim_entrants_1 = internal->n_group;
  internal->dim_entrants_2 = internal->n_vax;
  internal->dim_I_1 = internal->n_group;
  internal->dim_I_2 = internal->n_vax;
  internal->dim_I0_1 = internal->n_group;
  internal->dim_I0_2 = internal->n_vax;
  internal->dim_N_1 = internal->n_group;
  internal->dim_N_2 = internal->n_vax;
  internal->dim_n_AT_1 = internal->n_group;
  internal->dim_n_AT_2 = internal->n_vax;
  internal->dim_n_AU_1 = internal->n_group;
  internal->dim_n_AU_2 = internal->n_vax;
  internal->dim_n_obe_1 = internal->n_group;
  internal->dim_n_obe_2 = internal->n_vax;
  internal->dim_n_obe_3 = internal->n_vax;
  internal->dim_n_ood_1 = internal->n_group;
  internal->dim_n_ood_2 = internal->n_vax;
  internal->dim_n_ood_3 = internal->n_vax;
  internal->dim_n_oos_1 = internal->n_group;
  internal->dim_n_oos_2 = internal->n_vax;
  internal->dim_n_oos_3 = internal->n_vax;
  internal->dim_n_ST_1 = internal->n_group;
  internal->dim_n_ST_2 = internal->n_vax;
  internal->dim_n_TU_1 = internal->n_group;
  internal->dim_n_TU_2 = internal->n_vax;
  internal->dim_n_UI_1 = internal->n_group;
  internal->dim_n_UI_2 = internal->n_vax;
  internal->dim_n_vbe_1 = internal->n_group;
  internal->dim_n_vbe_2 = internal->n_vax;
  internal->dim_n_vbe_3 = internal->n_vax;
  internal->dim_n_vod_1 = internal->n_group;
  internal->dim_n_vod_2 = internal->n_vax;
  internal->dim_n_vod_3 = internal->n_vax;
  internal->dim_n_vos_1 = internal->n_group;
  internal->dim_n_vos_2 = internal->n_vax;
  internal->dim_n_vos_3 = internal->n_vax;
  internal->dim_S_1 = internal->n_group;
  internal->dim_S_2 = internal->n_vax;
  internal->dim_S0_1 = internal->n_group;
  internal->dim_S0_2 = internal->n_vax;
  internal->dim_screened_1 = internal->n_group;
  internal->dim_screened_2 = internal->n_vax;
  internal->dim_T_1 = internal->n_group;
  internal->dim_T_2 = internal->n_vax;
  internal->dim_T0_1 = internal->n_group;
  internal->dim_T0_2 = internal->n_vax;
  internal->dim_u_1 = internal->n_group;
  internal->dim_U_1 = internal->n_group;
  internal->dim_u_2 = internal->n_vax;
  internal->dim_U_2 = internal->n_vax;
  internal->dim_u_3 = internal->n_vax;
  internal->dim_U0_1 = internal->n_group;
  internal->dim_U0_2 = internal->n_vax;
  internal->dim_vbe_1 = internal->n_group;
  internal->dim_vbe_2 = internal->n_vax;
  internal->dim_vbe_3 = internal->n_vax;
  internal->dim_vea = internal->n_vax;
  internal->dim_ved = internal->n_vax;
  internal->dim_vei = internal->n_vax;
  internal->dim_ves = internal->n_vax;
  internal->dim_vod_1 = internal->n_group;
  internal->dim_vod_2 = internal->n_vax;
  internal->dim_vod_3 = internal->n_vax;
  internal->dim_vos_1 = internal->n_group;
  internal->dim_vos_2 = internal->n_vax;
  internal->dim_vos_3 = internal->n_vax;
  internal->dim_w_1 = internal->n_vax;
  internal->dim_w_2 = internal->n_vax;
  internal->dim_wA_1 = internal->n_group;
  internal->dim_wA_2 = internal->n_vax;
  internal->dim_wA_3 = internal->n_vax;
  internal->dim_wI_1 = internal->n_group;
  internal->dim_wI_2 = internal->n_vax;
  internal->dim_wI_3 = internal->n_vax;
  internal->dim_willing = internal->n_vax;
  internal->dim_wS_1 = internal->n_group;
  internal->dim_wS_2 = internal->n_vax;
  internal->dim_wS_3 = internal->n_vax;
  internal->dim_wT_1 = internal->n_group;
  internal->dim_wT_2 = internal->n_vax;
  internal->dim_wT_3 = internal->n_vax;
  internal->dim_wU_1 = internal->n_group;
  internal->dim_wU_2 = internal->n_vax;
  internal->dim_wU_3 = internal->n_vax;
  interpolate_check_y(internal->dim_vax_t, internal->dim_vax_y, 0, "vax_y", "vax_switch");
  cinterpolate_free(internal->interpolate_vax_switch);
  internal->interpolate_vax_switch = cinterpolate_alloc("constant", internal->dim_vax_t, 1, internal->vax_t, internal->vax_y, true, false);
  internal->dim_A = internal->dim_A_1 * internal->dim_A_2;
  internal->dim_A0 = internal->dim_A0_1 * internal->dim_A0_2;
  internal->dim_beta_t = internal->dim_tt;
  internal->dim_C = internal->dim_C_1 * internal->dim_C_2;
  internal->dim_cum_diag_a = internal->dim_cum_diag_a_1 * internal->dim_cum_diag_a_2;
  internal->dim_cum_diag_s = internal->dim_cum_diag_s_1 * internal->dim_cum_diag_s_2;
  internal->dim_cum_incid = internal->dim_cum_incid_1 * internal->dim_cum_incid_2;
  internal->dim_cum_offered = internal->dim_cum_offered_1 * internal->dim_cum_offered_2;
  internal->dim_cum_offered_vbe = internal->dim_cum_offered_vbe_1 * internal->dim_cum_offered_vbe_2;
  internal->dim_cum_screened = internal->dim_cum_screened_1 * internal->dim_cum_screened_2;
  internal->dim_cum_treated = internal->dim_cum_treated_1 * internal->dim_cum_treated_2;
  internal->dim_cum_vaccinated = internal->dim_cum_vaccinated_1 * internal->dim_cum_vaccinated_2;
  internal->dim_cum_vbe = internal->dim_cum_vbe_1 * internal->dim_cum_vbe_2;
  internal->dim_entrants = internal->dim_entrants_1 * internal->dim_entrants_2;
  internal->dim_eta_h_t = internal->dim_tt;
  internal->dim_eta_l_t = internal->dim_tt;
  internal->dim_I = internal->dim_I_1 * internal->dim_I_2;
  internal->dim_I0 = internal->dim_I0_1 * internal->dim_I0_2;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_n_AT = internal->dim_n_AT_1 * internal->dim_n_AT_2;
  internal->dim_n_AU = internal->dim_n_AU_1 * internal->dim_n_AU_2;
  internal->dim_n_obe = internal->dim_n_obe_1 * internal->dim_n_obe_2 * internal->dim_n_obe_3;
  internal->dim_n_obe_12 = internal->dim_n_obe_1 * internal->dim_n_obe_2;
  internal->dim_n_ood = internal->dim_n_ood_1 * internal->dim_n_ood_2 * internal->dim_n_ood_3;
  internal->dim_n_ood_12 = internal->dim_n_ood_1 * internal->dim_n_ood_2;
  internal->dim_n_oos = internal->dim_n_oos_1 * internal->dim_n_oos_2 * internal->dim_n_oos_3;
  internal->dim_n_oos_12 = internal->dim_n_oos_1 * internal->dim_n_oos_2;
  internal->dim_n_ST = internal->dim_n_ST_1 * internal->dim_n_ST_2;
  internal->dim_n_TU = internal->dim_n_TU_1 * internal->dim_n_TU_2;
  internal->dim_n_UI = internal->dim_n_UI_1 * internal->dim_n_UI_2;
  internal->dim_n_vbe = internal->dim_n_vbe_1 * internal->dim_n_vbe_2 * internal->dim_n_vbe_3;
  internal->dim_n_vbe_12 = internal->dim_n_vbe_1 * internal->dim_n_vbe_2;
  internal->dim_n_vod = internal->dim_n_vod_1 * internal->dim_n_vod_2 * internal->dim_n_vod_3;
  internal->dim_n_vod_12 = internal->dim_n_vod_1 * internal->dim_n_vod_2;
  internal->dim_n_vos = internal->dim_n_vos_1 * internal->dim_n_vos_2 * internal->dim_n_vos_3;
  internal->dim_n_vos_12 = internal->dim_n_vos_1 * internal->dim_n_vos_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_S0 = internal->dim_S0_1 * internal->dim_S0_2;
  internal->dim_screened = internal->dim_screened_1 * internal->dim_screened_2;
  internal->dim_T = internal->dim_T_1 * internal->dim_T_2;
  internal->dim_T0 = internal->dim_T0_1 * internal->dim_T0_2;
  internal->dim_u = internal->dim_u_1 * internal->dim_u_2 * internal->dim_u_3;
  internal->dim_U = internal->dim_U_1 * internal->dim_U_2;
  internal->dim_u_12 = internal->dim_u_1 * internal->dim_u_2;
  internal->dim_U0 = internal->dim_U0_1 * internal->dim_U0_2;
  internal->dim_vbe = internal->dim_vbe_1 * internal->dim_vbe_2 * internal->dim_vbe_3;
  internal->dim_vbe_12 = internal->dim_vbe_1 * internal->dim_vbe_2;
  internal->dim_vod = internal->dim_vod_1 * internal->dim_vod_2 * internal->dim_vod_3;
  internal->dim_vod_12 = internal->dim_vod_1 * internal->dim_vod_2;
  internal->dim_vos = internal->dim_vos_1 * internal->dim_vos_2 * internal->dim_vos_3;
  internal->dim_vos_12 = internal->dim_vos_1 * internal->dim_vos_2;
  internal->dim_w = internal->dim_w_1 * internal->dim_w_2;
  internal->dim_wA = internal->dim_wA_1 * internal->dim_wA_2 * internal->dim_wA_3;
  internal->dim_wA_12 = internal->dim_wA_1 * internal->dim_wA_2;
  internal->dim_wI = internal->dim_wI_1 * internal->dim_wI_2 * internal->dim_wI_3;
  internal->dim_wI_12 = internal->dim_wI_1 * internal->dim_wI_2;
  internal->dim_wS = internal->dim_wS_1 * internal->dim_wS_2 * internal->dim_wS_3;
  internal->dim_wS_12 = internal->dim_wS_1 * internal->dim_wS_2;
  internal->dim_wT = internal->dim_wT_1 * internal->dim_wT_2 * internal->dim_wT_3;
  internal->dim_wT_12 = internal->dim_wT_1 * internal->dim_wT_2;
  internal->dim_wU = internal->dim_wU_1 * internal->dim_wU_2 * internal->dim_wU_3;
  internal->dim_wU_12 = internal->dim_wU_1 * internal->dim_wU_2;
  internal->p = (double*) user_get_array(user, false, internal->p, "p", NA_REAL, NA_REAL, 1, internal->dim_p);
  internal->q = (double*) user_get_array(user, false, internal->q, "q", NA_REAL, NA_REAL, 1, internal->dim_q);
  internal->vea = (double*) user_get_array(user, false, internal->vea, "vea", NA_REAL, NA_REAL, 1, internal->dim_vea);
  internal->ved = (double*) user_get_array(user, false, internal->ved, "ved", NA_REAL, NA_REAL, 1, internal->dim_ved);
  internal->vei = (double*) user_get_array(user, false, internal->vei, "vei", NA_REAL, NA_REAL, 1, internal->dim_vei);
  internal->ves = (double*) user_get_array(user, false, internal->ves, "ves", NA_REAL, NA_REAL, 1, internal->dim_ves);
  internal->willing = (double*) user_get_array(user, false, internal->willing, "willing", NA_REAL, NA_REAL, 1, internal->dim_willing);
  internal->A0 = (double*) user_get_array(user, false, internal->A0, "A0", NA_REAL, NA_REAL, 2, internal->dim_A0_1, internal->dim_A0_2);
  R_Free(internal->C);
  internal->C = (double*) R_Calloc(internal->dim_C, double);
  R_Free(internal->entrants);
  internal->entrants = (double*) R_Calloc(internal->dim_entrants, double);
  R_Free(internal->initial_A);
  internal->initial_A = (double*) R_Calloc(internal->dim_A, double);
  R_Free(internal->initial_cum_diag_a);
  internal->initial_cum_diag_a = (double*) R_Calloc(internal->dim_cum_diag_a, double);
  R_Free(internal->initial_cum_diag_s);
  internal->initial_cum_diag_s = (double*) R_Calloc(internal->dim_cum_diag_s, double);
  R_Free(internal->initial_cum_incid);
  internal->initial_cum_incid = (double*) R_Calloc(internal->dim_cum_incid, double);
  R_Free(internal->initial_cum_offered);
  internal->initial_cum_offered = (double*) R_Calloc(internal->dim_cum_offered, double);
  R_Free(internal->initial_cum_offered_vbe);
  internal->initial_cum_offered_vbe = (double*) R_Calloc(internal->dim_cum_offered_vbe, double);
  R_Free(internal->initial_cum_screened);
  internal->initial_cum_screened = (double*) R_Calloc(internal->dim_cum_screened, double);
  R_Free(internal->initial_cum_treated);
  internal->initial_cum_treated = (double*) R_Calloc(internal->dim_cum_treated, double);
  R_Free(internal->initial_cum_vaccinated);
  internal->initial_cum_vaccinated = (double*) R_Calloc(internal->dim_cum_vaccinated, double);
  R_Free(internal->initial_cum_vbe);
  internal->initial_cum_vbe = (double*) R_Calloc(internal->dim_cum_vbe, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_T);
  internal->initial_T = (double*) R_Calloc(internal->dim_T, double);
  R_Free(internal->initial_U);
  internal->initial_U = (double*) R_Calloc(internal->dim_U, double);
  R_Free(internal->N);
  internal->N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->n_AT);
  internal->n_AT = (double*) R_Calloc(internal->dim_n_AT, double);
  R_Free(internal->n_AU);
  internal->n_AU = (double*) R_Calloc(internal->dim_n_AU, double);
  R_Free(internal->n_obe);
  internal->n_obe = (double*) R_Calloc(internal->dim_n_obe, double);
  R_Free(internal->n_ood);
  internal->n_ood = (double*) R_Calloc(internal->dim_n_ood, double);
  R_Free(internal->n_oos);
  internal->n_oos = (double*) R_Calloc(internal->dim_n_oos, double);
  R_Free(internal->n_ST);
  internal->n_ST = (double*) R_Calloc(internal->dim_n_ST, double);
  R_Free(internal->n_TU);
  internal->n_TU = (double*) R_Calloc(internal->dim_n_TU, double);
  R_Free(internal->n_UI);
  internal->n_UI = (double*) R_Calloc(internal->dim_n_UI, double);
  R_Free(internal->n_vbe);
  internal->n_vbe = (double*) R_Calloc(internal->dim_n_vbe, double);
  R_Free(internal->n_vod);
  internal->n_vod = (double*) R_Calloc(internal->dim_n_vod, double);
  R_Free(internal->n_vos);
  internal->n_vos = (double*) R_Calloc(internal->dim_n_vos, double);
  R_Free(internal->screened);
  internal->screened = (double*) R_Calloc(internal->dim_screened, double);
  R_Free(internal->wA);
  internal->wA = (double*) R_Calloc(internal->dim_wA, double);
  R_Free(internal->wI);
  internal->wI = (double*) R_Calloc(internal->dim_wI, double);
  R_Free(internal->wS);
  internal->wS = (double*) R_Calloc(internal->dim_wS, double);
  R_Free(internal->wT);
  internal->wT = (double*) R_Calloc(internal->dim_wT, double);
  R_Free(internal->wU);
  internal->wU = (double*) R_Calloc(internal->dim_wU, double);
  internal->beta_t = (double*) user_get_array(user, false, internal->beta_t, "beta_t", NA_REAL, NA_REAL, 1, internal->dim_beta_t);
  internal->eta_h_t = (double*) user_get_array(user, false, internal->eta_h_t, "eta_h_t", NA_REAL, NA_REAL, 1, internal->dim_eta_h_t);
  internal->eta_l_t = (double*) user_get_array(user, false, internal->eta_l_t, "eta_l_t", NA_REAL, NA_REAL, 1, internal->dim_eta_l_t);
  internal->I0 = (double*) user_get_array(user, false, internal->I0, "I0", NA_REAL, NA_REAL, 2, internal->dim_I0_1, internal->dim_I0_2);
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      internal->initial_cum_diag_a[i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      internal->initial_cum_diag_s[i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      internal->initial_cum_incid[i - 1 + internal->dim_cum_incid_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      internal->initial_cum_offered[i - 1 + internal->dim_cum_offered_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      internal->initial_cum_offered_vbe[i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      internal->initial_cum_screened[i - 1 + internal->dim_cum_screened_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      internal->initial_cum_treated[i - 1 + internal->dim_cum_treated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      internal->initial_cum_vaccinated[i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      internal->initial_cum_vbe[i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = 0;
    }
  }
  internal->offset_variable_A = internal->dim_I + internal->dim_U;
  internal->offset_variable_cum_diag_a = internal->dim_A + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_diag_s = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_incid = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_screened = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_treated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_S = internal->dim_A + internal->dim_I + internal->dim_U;
  internal->offset_variable_T = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_U;
  internal->S0 = (double*) user_get_array(user, false, internal->S0, "S0", NA_REAL, NA_REAL, 2, internal->dim_S0_1, internal->dim_S0_2);
  internal->T0 = (double*) user_get_array(user, false, internal->T0, "T0", NA_REAL, NA_REAL, 2, internal->dim_T0_1, internal->dim_T0_2);
  internal->u = (double*) user_get_array(user, false, internal->u, "u", NA_REAL, NA_REAL, 3, internal->dim_u_1, internal->dim_u_2, internal->dim_u_3);
  internal->U0 = (double*) user_get_array(user, false, internal->U0, "U0", NA_REAL, NA_REAL, 2, internal->dim_U0_1, internal->dim_U0_2);
  internal->vbe = (double*) user_get_array(user, false, internal->vbe, "vbe", NA_REAL, NA_REAL, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  internal->vod = (double*) user_get_array(user, false, internal->vod, "vod", NA_REAL, NA_REAL, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  internal->vos = (double*) user_get_array(user, false, internal->vos, "vos", NA_REAL, NA_REAL, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  internal->w = (double*) user_get_array(user, false, internal->w, "w", NA_REAL, NA_REAL, 2, internal->dim_w_1, internal->dim_w_2);
  for (int i = 1; i <= internal->dim_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_entrants_2; ++j) {
      internal->entrants[i - 1 + internal->dim_entrants_1 * (j - 1)] = internal->enr * internal->q[i - 1] * internal->willing[j - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      internal->initial_A[i - 1 + internal->dim_A_1 * (j - 1)] = internal->A0[internal->dim_A0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      internal->initial_I[i - 1 + internal->dim_I_1 * (j - 1)] = internal->I0[internal->dim_I0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1)] = internal->S0[internal->dim_S0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      internal->initial_T[i - 1 + internal->dim_T_1 * (j - 1)] = internal->T0[internal->dim_T0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      internal->initial_U[i - 1 + internal->dim_U_1 * (j - 1)] = internal->U0[internal->dim_U0_1 * (j - 1) + i - 1];
    }
  }
  interpolate_check_y(internal->dim_tt, internal->dim_beta_t, 0, "beta_t", "beta");
  cinterpolate_free(internal->interpolate_beta);
  internal->interpolate_beta = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->beta_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_h_t, 0, "eta_h_t", "eta_h");
  cinterpolate_free(internal->interpolate_eta_h);
  internal->interpolate_eta_h = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_h_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_l_t, 0, "eta_l_t", "eta_l");
  cinterpolate_free(internal->interpolate_eta_l);
  internal->interpolate_eta_l = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_l_t, true, false);
  for (int i = 1; i <= internal->dim_n_obe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_obe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_obe_3; ++k) {
        internal->n_obe[i - 1 + internal->dim_n_obe_1 * (j - 1) + internal->dim_n_obe_12 * (k - 1)] = internal->vbe[internal->dim_vbe_12 * (k - 1) + internal->dim_vbe_1 * (j - 1) + i - 1] * internal->entrants[internal->dim_entrants_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vbe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vbe_3; ++k) {
        internal->n_vbe[i - 1 + internal->dim_n_vbe_1 * (j - 1) + internal->dim_n_vbe_12 * (k - 1)] = internal->n_obe[internal->dim_n_obe_12 * (k - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1] * internal->u_vbe;
      }
    }
  }
  return R_NilValue;
}
SEXP model_withouthistory_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_withouthistory_use_dde_ptr) {
  return R_NilValue;
}
SEXP model_withouthistory_metadata(SEXP internal_p) {
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 14));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 14));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, allocVector(INTSXP, 2));
  int * dim_U = INTEGER(VECTOR_ELT(variable_length, 0));
  dim_U[0] = internal->dim_U_1;
  dim_U[1] = internal->dim_U_2;
  SET_VECTOR_ELT(variable_length, 1, allocVector(INTSXP, 2));
  int * dim_I = INTEGER(VECTOR_ELT(variable_length, 1));
  dim_I[0] = internal->dim_I_1;
  dim_I[1] = internal->dim_I_2;
  SET_VECTOR_ELT(variable_length, 2, allocVector(INTSXP, 2));
  int * dim_A = INTEGER(VECTOR_ELT(variable_length, 2));
  dim_A[0] = internal->dim_A_1;
  dim_A[1] = internal->dim_A_2;
  SET_VECTOR_ELT(variable_length, 3, allocVector(INTSXP, 2));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 3));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  SET_VECTOR_ELT(variable_length, 4, allocVector(INTSXP, 2));
  int * dim_T = INTEGER(VECTOR_ELT(variable_length, 4));
  dim_T[0] = internal->dim_T_1;
  dim_T[1] = internal->dim_T_2;
  SET_VECTOR_ELT(variable_length, 5, allocVector(INTSXP, 2));
  int * dim_cum_incid = INTEGER(VECTOR_ELT(variable_length, 5));
  dim_cum_incid[0] = internal->dim_cum_incid_1;
  dim_cum_incid[1] = internal->dim_cum_incid_2;
  SET_VECTOR_ELT(variable_length, 6, allocVector(INTSXP, 2));
  int * dim_cum_diag_a = INTEGER(VECTOR_ELT(variable_length, 6));
  dim_cum_diag_a[0] = internal->dim_cum_diag_a_1;
  dim_cum_diag_a[1] = internal->dim_cum_diag_a_2;
  SET_VECTOR_ELT(variable_length, 7, allocVector(INTSXP, 2));
  int * dim_cum_diag_s = INTEGER(VECTOR_ELT(variable_length, 7));
  dim_cum_diag_s[0] = internal->dim_cum_diag_s_1;
  dim_cum_diag_s[1] = internal->dim_cum_diag_s_2;
  SET_VECTOR_ELT(variable_length, 8, allocVector(INTSXP, 2));
  int * dim_cum_treated = INTEGER(VECTOR_ELT(variable_length, 8));
  dim_cum_treated[0] = internal->dim_cum_treated_1;
  dim_cum_treated[1] = internal->dim_cum_treated_2;
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 2));
  int * dim_cum_screened = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_cum_screened[0] = internal->dim_cum_screened_1;
  dim_cum_screened[1] = internal->dim_cum_screened_2;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 2));
  int * dim_cum_offered = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_cum_offered[0] = internal->dim_cum_offered_1;
  dim_cum_offered[1] = internal->dim_cum_offered_2;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_cum_vaccinated[0] = internal->dim_cum_vaccinated_1;
  dim_cum_vaccinated[1] = internal->dim_cum_vaccinated_2;
  SET_VECTOR_ELT(variable_length, 12, allocVector(INTSXP, 2));
  int * dim_cum_vbe = INTEGER(VECTOR_ELT(variable_length, 12));
  dim_cum_vbe[0] = internal->dim_cum_vbe_1;
  dim_cum_vbe[1] = internal->dim_cum_vbe_2;
  SET_VECTOR_ELT(variable_length, 13, allocVector(INTSXP, 2));
  int * dim_cum_offered_vbe = INTEGER(VECTOR_ELT(variable_length, 13));
  dim_cum_offered_vbe[0] = internal->dim_cum_offered_vbe_1;
  dim_cum_offered_vbe[1] = internal->dim_cum_offered_vbe_2;
  SET_STRING_ELT(variable_names, 0, mkChar("U"));
  SET_STRING_ELT(variable_names, 1, mkChar("I"));
  SET_STRING_ELT(variable_names, 2, mkChar("A"));
  SET_STRING_ELT(variable_names, 3, mkChar("S"));
  SET_STRING_ELT(variable_names, 4, mkChar("T"));
  SET_STRING_ELT(variable_names, 5, mkChar("cum_incid"));
  SET_STRING_ELT(variable_names, 6, mkChar("cum_diag_a"));
  SET_STRING_ELT(variable_names, 7, mkChar("cum_diag_s"));
  SET_STRING_ELT(variable_names, 8, mkChar("cum_treated"));
  SET_STRING_ELT(variable_names, 9, mkChar("cum_screened"));
  SET_STRING_ELT(variable_names, 10, mkChar("cum_offered"));
  SET_STRING_ELT(variable_names, 11, mkChar("cum_vaccinated"));
  SET_STRING_ELT(variable_names, 12, mkChar("cum_vbe"));
  SET_STRING_ELT(variable_names, 13, mkChar("cum_offered_vbe"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 6));
  SEXP output_names = PROTECT(allocVector(STRSXP, 6));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, R_NilValue);
  SET_VECTOR_ELT(output_length, 3, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(output_length, 4, ScalarInteger(internal->dim_lambda));
  SET_VECTOR_ELT(output_length, 5, allocVector(INTSXP, 2));
  int * dim_N = INTEGER(VECTOR_ELT(output_length, 5));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  SET_STRING_ELT(output_names, 0, mkChar("tot_treated"));
  SET_STRING_ELT(output_names, 1, mkChar("tot_attended"));
  SET_STRING_ELT(output_names, 2, mkChar("beta"));
  SET_STRING_ELT(output_names, 3, mkChar("eta"));
  SET_STRING_ELT(output_names, 4, mkChar("lambda"));
  SET_STRING_ELT(output_names, 5, mkChar("N"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(internal->dim_eta + internal->dim_lambda + internal->dim_N + 3));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(fmax(internal->tt[0], internal->vax_t[0])));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(internal->tt[internal->dim_tt - 1]));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP model_withouthistory_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_vbe + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_U, internal->dim_U * sizeof(double));
  memcpy(state + internal->dim_U, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_A, internal->initial_A, internal->dim_A * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_T, internal->initial_T, internal->dim_T * sizeof(double));
  memcpy(state + internal->offset_variable_cum_incid, internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_a, internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_s, internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  memcpy(state + internal->offset_variable_cum_treated, internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_screened, internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered, internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated, internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vbe, internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered_vbe, internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void model_withouthistory_rhs(model_withouthistory_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double vax_switch = 0.0;
  cinterpolate_eval(t, internal->interpolate_vax_switch, &vax_switch);
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AU_2; ++j) {
      internal->n_AU[i - 1 + internal->dim_n_AU_1 * (j - 1)] = (internal->mu == 0 ? internal->nu * A[internal->dim_A_1 * (j - 1) + i - 1] : internal->nu * internal->mu / (double) (internal->ved[j - 1] * internal->nu + (1 - internal->ved[j - 1]) * internal->mu) * A[internal->dim_A_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_n_ST_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ST_2; ++j) {
      internal->n_ST[i - 1 + internal->dim_n_ST_1 * (j - 1)] = internal->mu * S[internal->dim_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_TU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_TU_2; ++j) {
      internal->n_TU[i - 1 + internal->dim_n_TU_1 * (j - 1)] = internal->rho * T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_wA_1; ++i) {
    for (int j = 1; j <= internal->dim_wA_2; ++j) {
      for (int k = 1; k <= internal->dim_wA_3; ++k) {
        internal->wA[i - 1 + internal->dim_wA_1 * (j - 1) + internal->dim_wA_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wI_1; ++i) {
    for (int j = 1; j <= internal->dim_wI_2; ++j) {
      for (int k = 1; k <= internal->dim_wI_3; ++k) {
        internal->wI[i - 1 + internal->dim_wI_1 * (j - 1) + internal->dim_wI_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wS_1; ++i) {
    for (int j = 1; j <= internal->dim_wS_2; ++j) {
      for (int k = 1; k <= internal->dim_wS_3; ++k) {
        internal->wS[i - 1 + internal->dim_wS_1 * (j - 1) + internal->dim_wS_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wT_1; ++i) {
    for (int j = 1; j <= internal->dim_wT_2; ++j) {
      for (int k = 1; k <= internal->dim_wT_3; ++k) {
        internal->wT[i - 1 + internal->dim_wT_1 * (j - 1) + internal->dim_wT_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wU_1; ++i) {
    for (int j = 1; j <= internal->dim_wU_2; ++j) {
      for (int k = 1; k <= internal->dim_wU_3; ++k) {
        internal->wU[i - 1 + internal->dim_wU_1 * (j - 1) + internal->dim_wU_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_s + i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      dstatedt[internal->offset_variable_cum_treated + i - 1 + internal->dim_cum_treated_1 * (j - 1)] = internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      dstatedt[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1)] = (1 - internal->ves[j - 1]) * internal->psi * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] - internal->exr * S[internal->dim_S_1 * (j - 1) + i - 1] + odin_sum3(internal->wS, i - 1, i, j - 1, j, 0, internal->dim_wS_3, internal->dim_wS_1, internal->dim_wS_12);
    }
  }
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_n_ood_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ood_2; ++j) {
      for (int k = 1; k <= internal->dim_n_ood_3; ++k) {
        internal->n_ood[i - 1 + internal->dim_n_ood_1 * (j - 1) + internal->dim_n_ood_12 * (k - 1)] = internal->vod[internal->dim_vod_12 * (k - 1) + internal->dim_vod_1 * (j - 1) + i - 1] * internal->n_TU[internal->dim_n_TU_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered_vbe + i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1];
    }
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  for (int i = 1; i <= internal->dim_n_vod_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vod_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vod_3; ++k) {
        internal->n_vod[i - 1 + internal->dim_n_vod_1 * (j - 1) + internal->dim_n_vod_12 * (k - 1)] = internal->n_ood[internal->dim_n_ood_12 * (k - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] * internal->u[internal->dim_u_12 * (k - 1) + internal->dim_u_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_vbe + i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_lambda; ++i) {
    internal->lambda[i - 1] = internal->p[i - 1] * beta * (internal->epsilon * internal->prop_C[i - 1] + (1 - internal->epsilon) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
  }
  for (int i = 1; i <= internal->dim_n_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AT_2; ++j) {
      internal->n_AT[i - 1 + internal->dim_n_AT_1 * (j - 1)] = internal->eta[i - 1] * A[internal->dim_A_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_screened_2; ++j) {
      internal->screened[i - 1 + internal->dim_screened_1 * (j - 1)] = internal->eta[i - 1] * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      dstatedt[internal->offset_variable_A + i - 1 + internal->dim_A_1 * (j - 1)] = (1 - (1 - internal->ves[j - 1]) * internal->psi) * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] - internal->exr * A[internal->dim_A_1 * (j - 1) + i - 1] + odin_sum3(internal->wA, i - 1, i, j - 1, j, 0, internal->dim_wA_3, internal->dim_wA_1, internal->dim_wA_12);
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_a + i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      dstatedt[internal->offset_variable_cum_screened + i - 1 + internal->dim_cum_screened_1 * (j - 1)] = internal->screened[internal->dim_screened_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      dstatedt[internal->offset_variable_T + i - 1 + internal->dim_T_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->exr * T[internal->dim_T_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wT, i - 1, i, j - 1, j, 0, internal->dim_wT_3, internal->dim_wT_1, internal->dim_wT_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_oos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_oos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_oos_3; ++k) {
        internal->n_oos[i - 1 + internal->dim_n_oos_1 * (j - 1) + internal->dim_n_oos_12 * (k - 1)] = internal->vos[internal->dim_vos_12 * (k - 1) + internal->dim_vos_1 * (j - 1) + i - 1] * internal->screened[internal->dim_screened_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_UI_1; ++i) {
    for (int j = 1; j <= internal->dim_n_UI_2; ++j) {
      internal->n_UI[i - 1 + internal->dim_n_UI_1 * (j - 1)] = internal->lambda[i - 1] * (1 - internal->vea[j - 1]) * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      dstatedt[internal->offset_variable_cum_incid + i - 1 + internal->dim_cum_incid_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered + i - 1 + internal->dim_cum_offered_1 * (j - 1)] = internal->n_oos[internal->dim_n_oos_12 * (j - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] + internal->n_ood[internal->dim_n_ood_12 * (j - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] + internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      dstatedt[internal->dim_U + i - 1 + internal->dim_I_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - (internal->sigma + internal->exr) * I[internal->dim_I_1 * (j - 1) + i - 1] + odin_sum3(internal->wI, i - 1, i, j - 1, j, 0, internal->dim_wI_3, internal->dim_wI_1, internal->dim_wI_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_vos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vos_3; ++k) {
        internal->n_vos[i - 1 + internal->dim_n_vos_1 * (j - 1) + internal->dim_n_vos_12 * (k - 1)] = internal->n_oos[internal->dim_n_oos_12 * (k - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] * internal->u[internal->dim_u_12 * (k - 1) + internal->dim_u_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated + i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = internal->n_vos[internal->dim_n_vos_12 * (j - 1) + internal->dim_n_vos_1 * (j - 1) + i - 1] + internal->n_vod[internal->dim_n_vod_12 * (j - 1) + internal->dim_n_vod_1 * (j - 1) + i - 1] + internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      dstatedt[0 + i - 1 + internal->dim_U_1 * (j - 1)] = internal->entrants[internal->dim_entrants_1 * (j - 1) + i - 1] - internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - internal->exr * U[internal->dim_U_1 * (j - 1) + i - 1] + internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wU, i - 1, i, j - 1, j, 0, internal->dim_wU_3, internal->dim_wU_1, internal->dim_wU_12) - odin_sum3(internal->n_vbe, i - 1, i, j - 1, j, 0, internal->dim_n_vbe_3, internal->dim_n_vbe_1, internal->dim_n_vbe_12) - odin_sum3(internal->n_vod, i - 1, i, j - 1, j, 0, internal->dim_n_vod_3, internal->dim_n_vod_1, internal->dim_n_vod_12) - odin_sum3(internal->n_vos, i - 1, i, j - 1, j, 0, internal->dim_n_vos_3, internal->dim_n_vos_1, internal->dim_n_vos_12);
    }
  }
  if (output) {
    double * cum_treated = state + internal->offset_variable_cum_treated;
    double * cum_screened = state + internal->offset_variable_cum_screened;
    output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
    output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
    memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
    output[2] = beta;
    memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
    memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
  }
}
void model_withouthistory_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  model_withouthistory_rhs((model_withouthistory_internal*)internal, t, state, dstatedt, NULL);
}
void model_withouthistory_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  model_withouthistory_rhs(model_withouthistory_internal_ds, *t, state, dstatedt, output);
}
void model_withouthistory_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p) {
  model_withouthistory_internal *internal = (model_withouthistory_internal*) internal_p;
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double * cum_treated = state + internal->offset_variable_cum_treated;
  double * cum_screened = state + internal->offset_variable_cum_screened;
  output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
  output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  output[2] = beta;
  for (int i = 1; i <= internal->dim_lambda; ++i) {
    internal->lambda[i - 1] = internal->p[i - 1] * beta * (internal->epsilon * internal->prop_C[i - 1] + (1 - internal->epsilon) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
  }
  memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
  memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
}
SEXP model_withouthistory_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  model_withouthistory_internal *internal = model_withouthistory_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, internal->dim_eta + internal->dim_lambda + internal->dim_N + 3));
  setAttrib(dstatedt, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  model_withouthistory_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
model_withoutPN_internal* model_withoutPN_get_internal(SEXP internal_p, int closed_error) {
  model_withoutPN_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (model_withoutPN_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void model_withoutPN_finalise(SEXP internal_p) {
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 0);
  if (internal_p) {
    cinterpolate_free(internal->interpolate_beta);
    cinterpolate_free(internal->interpolate_eta_h);
    cinterpolate_free(internal->interpolate_eta_l);
    cinterpolate_free(internal->interpolate_vax_switch);
    internal->interpolate_beta = NULL;
    internal->interpolate_eta_h = NULL;
    internal->interpolate_eta_l = NULL;
    internal->interpolate_vax_switch = NULL;
    R_Free(internal->A0);
    R_Free(internal->beta_t);
    R_Free(internal->C);
    R_Free(internal->diag_rec);
    R_Free(internal->entrants);
    R_Free(internal->eta);
    R_Free(internal->eta_h_t);
    R_Free(internal->eta_l_t);
    R_Free(internal->foi_LH);
    R_Free(internal->I0);
    R_Free(internal->initial_A);
    R_Free(internal->initial_cum_diag_a);
    R_Free(internal->initial_cum_diag_s);
    R_Free(internal->initial_cum_entrants);
    R_Free(internal->initial_cum_incid);
    R_Free(internal->initial_cum_offered);
    R_Free(internal->initial_cum_offered_vbe);
    R_Free(internal->initial_cum_screened);
    R_Free(internal->initial_cum_treated);
    R_Free(internal->initial_cum_vaccinated);
    R_Free(internal->initial_cum_vaccinated_screen);
    R_Free(internal->initial_cum_vbe);
    R_Free(internal->initial_I);
    R_Free(internal->initial_S);
    R_Free(internal->initial_T);
    R_Free(internal->initial_U);
    R_Free(internal->lambda);
    R_Free(internal->N);
    R_Free(internal->n_AT);
    R_Free(internal->n_AU);
    R_Free(internal->n_diag_rec);
    R_Free(internal->n_obe);
    R_Free(internal->n_ood);
    R_Free(internal->n_oos);
    R_Free(internal->n_ST);
    R_Free(internal->n_TU);
    R_Free(internal->n_UI);
    R_Free(internal->n_vbe);
    R_Free(internal->n_vod);
    R_Free(internal->n_vos);
    R_Free(internal->Np);
    R_Free(internal->p);
    R_Free(internal->prop_C);
    R_Free(internal->q);
    R_Free(internal->S0);
    R_Free(internal->screened);
    R_Free(internal->T0);
    R_Free(internal->tt);
    R_Free(internal->u_d);
    R_Free(internal->u_s);
    R_Free(internal->U0);
    R_Free(internal->vax_t);
    R_Free(internal->vax_y);
    R_Free(internal->vbe);
    R_Free(internal->vea);
    R_Free(internal->ved);
    R_Free(internal->vei);
    R_Free(internal->ves);
    R_Free(internal->vod);
    R_Free(internal->vos);
    R_Free(internal->w);
    R_Free(internal->wA);
    R_Free(internal->wd);
    R_Free(internal->wdA);
    R_Free(internal->wdI);
    R_Free(internal->wdS);
    R_Free(internal->wdT);
    R_Free(internal->wdU);
    R_Free(internal->wI);
    R_Free(internal->willing);
    R_Free(internal->wS);
    R_Free(internal->wT);
    R_Free(internal->wU);
    R_Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP model_withoutPN_create(SEXP user) {
  model_withoutPN_internal *internal = (model_withoutPN_internal*) R_Calloc(1, model_withoutPN_internal);
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->C = NULL;
  internal->diag_rec = NULL;
  internal->entrants = NULL;
  internal->eta = NULL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->foi_LH = NULL;
  internal->I0 = NULL;
  internal->initial_A = NULL;
  internal->initial_cum_diag_a = NULL;
  internal->initial_cum_diag_s = NULL;
  internal->initial_cum_entrants = NULL;
  internal->initial_cum_incid = NULL;
  internal->initial_cum_offered = NULL;
  internal->initial_cum_offered_vbe = NULL;
  internal->initial_cum_screened = NULL;
  internal->initial_cum_treated = NULL;
  internal->initial_cum_vaccinated = NULL;
  internal->initial_cum_vaccinated_screen = NULL;
  internal->initial_cum_vbe = NULL;
  internal->initial_I = NULL;
  internal->initial_S = NULL;
  internal->initial_T = NULL;
  internal->initial_U = NULL;
  internal->lambda = NULL;
  internal->N = NULL;
  internal->n_AT = NULL;
  internal->n_AU = NULL;
  internal->n_diag_rec = NULL;
  internal->n_obe = NULL;
  internal->n_ood = NULL;
  internal->n_oos = NULL;
  internal->n_ST = NULL;
  internal->n_TU = NULL;
  internal->n_UI = NULL;
  internal->n_vbe = NULL;
  internal->n_vod = NULL;
  internal->n_vos = NULL;
  internal->Np = NULL;
  internal->p = NULL;
  internal->prop_C = NULL;
  internal->q = NULL;
  internal->S0 = NULL;
  internal->screened = NULL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u_d = NULL;
  internal->u_s = NULL;
  internal->U0 = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->wA = NULL;
  internal->wd = NULL;
  internal->wdA = NULL;
  internal->wdI = NULL;
  internal->wdS = NULL;
  internal->wdT = NULL;
  internal->wdU = NULL;
  internal->wI = NULL;
  internal->willing = NULL;
  internal->wS = NULL;
  internal->wT = NULL;
  internal->wU = NULL;
  internal->n_group = 2;
  internal->dim_eta = internal->n_group;
  internal->dim_foi_LH = internal->n_group;
  internal->dim_lambda = internal->n_group;
  internal->dim_Np = internal->n_group;
  internal->dim_p = internal->n_group;
  internal->dim_prop_C = internal->n_group;
  internal->dim_q = internal->n_group;
  R_Free(internal->eta);
  internal->eta = (double*) R_Calloc(internal->dim_eta, double);
  R_Free(internal->foi_LH);
  internal->foi_LH = (double*) R_Calloc(internal->dim_foi_LH, double);
  R_Free(internal->lambda);
  internal->lambda = (double*) R_Calloc(internal->dim_lambda, double);
  R_Free(internal->Np);
  internal->Np = (double*) R_Calloc(internal->dim_Np, double);
  R_Free(internal->prop_C);
  internal->prop_C = (double*) R_Calloc(internal->dim_prop_C, double);
  internal->offset_output_lambda = internal->dim_eta + 3;
  internal->offset_output_N = internal->dim_eta + internal->dim_lambda + 3;
  internal->A0 = NULL;
  internal->beta_t = NULL;
  internal->diag_rec = NULL;
  internal->enr = NA_REAL;
  internal->epsilon = NA_REAL;
  internal->eta_h_t = NULL;
  internal->eta_l_t = NULL;
  internal->exr = NA_REAL;
  internal->I0 = NULL;
  internal->mu = NA_REAL;
  internal->nu = NA_REAL;
  internal->p = NULL;
  internal->psi = NA_REAL;
  internal->q = NULL;
  internal->rho = NA_REAL;
  internal->S0 = NULL;
  internal->sigma = NA_REAL;
  internal->T0 = NULL;
  internal->tt = NULL;
  internal->u_d = NULL;
  internal->u_s = NULL;
  internal->u_vbe = NA_REAL;
  internal->U0 = NULL;
  internal->vax_t = NULL;
  internal->vax_y = NULL;
  internal->vbe = NULL;
  internal->vea = NULL;
  internal->ved = NULL;
  internal->vei = NULL;
  internal->ves = NULL;
  internal->vod = NULL;
  internal->vos = NULL;
  internal->w = NULL;
  internal->wd = NULL;
  internal->willing = NULL;
  internal->n_vax = 1;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, model_withoutPN_finalise);
  UNPROTECT(1);
  return ptr;
}
static model_withoutPN_internal *model_withoutPN_internal_ds;
void model_withoutPN_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  model_withoutPN_internal_ds = model_withoutPN_get_internal(get_desolve_gparms(), 1);
}
SEXP model_withoutPN_contents(SEXP internal_p) {
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 333));
  SEXP A0 = PROTECT(allocVector(REALSXP, internal->dim_A0));
  memcpy(REAL(A0), internal->A0, internal->dim_A0 * sizeof(double));
  odin_set_dim(A0, 2, internal->dim_A0_1, internal->dim_A0_2);
  SET_VECTOR_ELT(contents, 0, A0);
  SEXP beta_t = PROTECT(allocVector(REALSXP, internal->dim_beta_t));
  memcpy(REAL(beta_t), internal->beta_t, internal->dim_beta_t * sizeof(double));
  SET_VECTOR_ELT(contents, 1, beta_t);
  SEXP C = PROTECT(allocVector(REALSXP, internal->dim_C));
  memcpy(REAL(C), internal->C, internal->dim_C * sizeof(double));
  odin_set_dim(C, 2, internal->dim_C_1, internal->dim_C_2);
  SET_VECTOR_ELT(contents, 2, C);
  SEXP diag_rec = PROTECT(allocVector(REALSXP, internal->dim_diag_rec));
  memcpy(REAL(diag_rec), internal->diag_rec, internal->dim_diag_rec * sizeof(double));
  odin_set_dim(diag_rec, 3, internal->dim_diag_rec_1, internal->dim_diag_rec_2, internal->dim_diag_rec_3);
  SET_VECTOR_ELT(contents, 3, diag_rec);
  SET_VECTOR_ELT(contents, 4, ScalarInteger(internal->dim_A));
  SET_VECTOR_ELT(contents, 5, ScalarInteger(internal->dim_A_1));
  SET_VECTOR_ELT(contents, 6, ScalarInteger(internal->dim_A_2));
  SET_VECTOR_ELT(contents, 7, ScalarInteger(internal->dim_A0));
  SET_VECTOR_ELT(contents, 8, ScalarInteger(internal->dim_A0_1));
  SET_VECTOR_ELT(contents, 9, ScalarInteger(internal->dim_A0_2));
  SET_VECTOR_ELT(contents, 10, ScalarInteger(internal->dim_beta_t));
  SET_VECTOR_ELT(contents, 11, ScalarInteger(internal->dim_C));
  SET_VECTOR_ELT(contents, 12, ScalarInteger(internal->dim_C_1));
  SET_VECTOR_ELT(contents, 13, ScalarInteger(internal->dim_C_2));
  SET_VECTOR_ELT(contents, 14, ScalarInteger(internal->dim_cum_diag_a));
  SET_VECTOR_ELT(contents, 15, ScalarInteger(internal->dim_cum_diag_a_1));
  SET_VECTOR_ELT(contents, 16, ScalarInteger(internal->dim_cum_diag_a_2));
  SET_VECTOR_ELT(contents, 17, ScalarInteger(internal->dim_cum_diag_s));
  SET_VECTOR_ELT(contents, 18, ScalarInteger(internal->dim_cum_diag_s_1));
  SET_VECTOR_ELT(contents, 19, ScalarInteger(internal->dim_cum_diag_s_2));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_cum_entrants));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_cum_entrants_1));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_cum_entrants_2));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_cum_incid));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_cum_incid_1));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_cum_incid_2));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_cum_offered));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_cum_offered_1));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_cum_offered_2));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_cum_offered_vbe_1));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_cum_offered_vbe_2));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_cum_screened));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_cum_screened_1));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_cum_screened_2));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_cum_treated));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_cum_treated_1));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_cum_treated_2));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_cum_vaccinated));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_cum_vaccinated_1));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_cum_vaccinated_2));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_cum_vaccinated_screen));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_cum_vaccinated_screen_1));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_cum_vaccinated_screen_2));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_cum_vbe));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_cum_vbe_1));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_cum_vbe_2));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_diag_rec));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_diag_rec_1));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_diag_rec_12));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_diag_rec_2));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_diag_rec_3));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_entrants));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_entrants_1));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_entrants_2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_eta_h_t));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_eta_l_t));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_foi_LH));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_I));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_I_1));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_I_2));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_I0));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_I0_1));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_I0_2));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_lambda));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_N));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_N_1));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_N_2));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_n_AT));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_n_AT_1));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_n_AT_2));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_n_AU));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_n_AU_1));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_n_AU_2));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_n_diag_rec));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_n_diag_rec_1));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_n_diag_rec_12));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_n_diag_rec_2));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_n_diag_rec_3));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_n_obe));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_n_obe_1));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_n_obe_12));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_n_obe_2));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_n_obe_3));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_n_ood));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_n_ood_1));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_n_ood_12));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_n_ood_2));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_n_ood_3));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_n_oos));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_n_oos_1));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_n_oos_12));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_n_oos_2));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_n_oos_3));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_n_ST));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_n_ST_1));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_n_ST_2));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_n_TU));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_n_TU_1));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_n_TU_2));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_n_UI));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_n_UI_1));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_n_UI_2));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_n_vbe));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_n_vbe_1));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_n_vbe_12));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_n_vbe_2));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_n_vbe_3));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_n_vod));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_n_vod_1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_n_vod_12));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_n_vod_2));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_n_vod_3));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_n_vos));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_n_vos_1));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_n_vos_12));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_n_vos_2));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_n_vos_3));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_Np));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_p));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_prop_C));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_q));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_S0));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_S0_1));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_S0_2));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_screened));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_screened_1));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_screened_2));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_T));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_T_1));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_T_2));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_T0));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_T0_1));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_T0_2));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_tt));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_U));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_U_1));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_U_2));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_u_d));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_u_d_1));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_u_d_12));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_u_d_2));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_u_d_3));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_u_s));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_u_s_1));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_u_s_12));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_u_s_2));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_u_s_3));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_U0));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_U0_1));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_U0_2));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_vax_t));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_vax_y));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_vbe));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_vbe_1));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_vbe_12));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_vbe_2));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_vbe_3));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_vea));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_ved));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_vei));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_ves));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_vod));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_vod_1));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_vod_12));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_vod_2));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_vod_3));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_vos));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_vos_1));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_vos_12));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_vos_2));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_vos_3));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_w));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_w_1));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_w_2));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_wA));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_wA_1));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_wA_12));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_wA_2));
  SET_VECTOR_ELT(contents, 183, ScalarInteger(internal->dim_wA_3));
  SET_VECTOR_ELT(contents, 184, ScalarInteger(internal->dim_wd));
  SET_VECTOR_ELT(contents, 185, ScalarInteger(internal->dim_wd_1));
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->dim_wd_2));
  SET_VECTOR_ELT(contents, 187, ScalarInteger(internal->dim_wdA));
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->dim_wdA_1));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->dim_wdA_12));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->dim_wdA_2));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->dim_wdA_3));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->dim_wdI));
  SET_VECTOR_ELT(contents, 193, ScalarInteger(internal->dim_wdI_1));
  SET_VECTOR_ELT(contents, 194, ScalarInteger(internal->dim_wdI_12));
  SET_VECTOR_ELT(contents, 195, ScalarInteger(internal->dim_wdI_2));
  SET_VECTOR_ELT(contents, 196, ScalarInteger(internal->dim_wdI_3));
  SET_VECTOR_ELT(contents, 197, ScalarInteger(internal->dim_wdS));
  SET_VECTOR_ELT(contents, 198, ScalarInteger(internal->dim_wdS_1));
  SET_VECTOR_ELT(contents, 199, ScalarInteger(internal->dim_wdS_12));
  SET_VECTOR_ELT(contents, 200, ScalarInteger(internal->dim_wdS_2));
  SET_VECTOR_ELT(contents, 201, ScalarInteger(internal->dim_wdS_3));
  SET_VECTOR_ELT(contents, 202, ScalarInteger(internal->dim_wdT));
  SET_VECTOR_ELT(contents, 203, ScalarInteger(internal->dim_wdT_1));
  SET_VECTOR_ELT(contents, 204, ScalarInteger(internal->dim_wdT_12));
  SET_VECTOR_ELT(contents, 205, ScalarInteger(internal->dim_wdT_2));
  SET_VECTOR_ELT(contents, 206, ScalarInteger(internal->dim_wdT_3));
  SET_VECTOR_ELT(contents, 207, ScalarInteger(internal->dim_wdU));
  SET_VECTOR_ELT(contents, 208, ScalarInteger(internal->dim_wdU_1));
  SET_VECTOR_ELT(contents, 209, ScalarInteger(internal->dim_wdU_12));
  SET_VECTOR_ELT(contents, 210, ScalarInteger(internal->dim_wdU_2));
  SET_VECTOR_ELT(contents, 211, ScalarInteger(internal->dim_wdU_3));
  SET_VECTOR_ELT(contents, 212, ScalarInteger(internal->dim_wI));
  SET_VECTOR_ELT(contents, 213, ScalarInteger(internal->dim_wI_1));
  SET_VECTOR_ELT(contents, 214, ScalarInteger(internal->dim_wI_12));
  SET_VECTOR_ELT(contents, 215, ScalarInteger(internal->dim_wI_2));
  SET_VECTOR_ELT(contents, 216, ScalarInteger(internal->dim_wI_3));
  SET_VECTOR_ELT(contents, 217, ScalarInteger(internal->dim_willing));
  SET_VECTOR_ELT(contents, 218, ScalarInteger(internal->dim_wS));
  SET_VECTOR_ELT(contents, 219, ScalarInteger(internal->dim_wS_1));
  SET_VECTOR_ELT(contents, 220, ScalarInteger(internal->dim_wS_12));
  SET_VECTOR_ELT(contents, 221, ScalarInteger(internal->dim_wS_2));
  SET_VECTOR_ELT(contents, 222, ScalarInteger(internal->dim_wS_3));
  SET_VECTOR_ELT(contents, 223, ScalarInteger(internal->dim_wT));
  SET_VECTOR_ELT(contents, 224, ScalarInteger(internal->dim_wT_1));
  SET_VECTOR_ELT(contents, 225, ScalarInteger(internal->dim_wT_12));
  SET_VECTOR_ELT(contents, 226, ScalarInteger(internal->dim_wT_2));
  SET_VECTOR_ELT(contents, 227, ScalarInteger(internal->dim_wT_3));
  SET_VECTOR_ELT(contents, 228, ScalarInteger(internal->dim_wU));
  SET_VECTOR_ELT(contents, 229, ScalarInteger(internal->dim_wU_1));
  SET_VECTOR_ELT(contents, 230, ScalarInteger(internal->dim_wU_12));
  SET_VECTOR_ELT(contents, 231, ScalarInteger(internal->dim_wU_2));
  SET_VECTOR_ELT(contents, 232, ScalarInteger(internal->dim_wU_3));
  SET_VECTOR_ELT(contents, 233, ScalarReal(internal->enr));
  SEXP entrants = PROTECT(allocVector(REALSXP, internal->dim_entrants));
  memcpy(REAL(entrants), internal->entrants, internal->dim_entrants * sizeof(double));
  odin_set_dim(entrants, 2, internal->dim_entrants_1, internal->dim_entrants_2);
  SET_VECTOR_ELT(contents, 234, entrants);
  SET_VECTOR_ELT(contents, 235, ScalarReal(internal->epsilon));
  SEXP eta = PROTECT(allocVector(REALSXP, internal->dim_eta));
  memcpy(REAL(eta), internal->eta, internal->dim_eta * sizeof(double));
  SET_VECTOR_ELT(contents, 236, eta);
  SEXP eta_h_t = PROTECT(allocVector(REALSXP, internal->dim_eta_h_t));
  memcpy(REAL(eta_h_t), internal->eta_h_t, internal->dim_eta_h_t * sizeof(double));
  SET_VECTOR_ELT(contents, 237, eta_h_t);
  SEXP eta_l_t = PROTECT(allocVector(REALSXP, internal->dim_eta_l_t));
  memcpy(REAL(eta_l_t), internal->eta_l_t, internal->dim_eta_l_t * sizeof(double));
  SET_VECTOR_ELT(contents, 238, eta_l_t);
  SET_VECTOR_ELT(contents, 239, ScalarReal(internal->exr));
  SEXP foi_LH = PROTECT(allocVector(REALSXP, internal->dim_foi_LH));
  memcpy(REAL(foi_LH), internal->foi_LH, internal->dim_foi_LH * sizeof(double));
  SET_VECTOR_ELT(contents, 240, foi_LH);
  SEXP I0 = PROTECT(allocVector(REALSXP, internal->dim_I0));
  memcpy(REAL(I0), internal->I0, internal->dim_I0 * sizeof(double));
  odin_set_dim(I0, 2, internal->dim_I0_1, internal->dim_I0_2);
  SET_VECTOR_ELT(contents, 241, I0);
  SEXP initial_A = PROTECT(allocVector(REALSXP, internal->dim_A));
  memcpy(REAL(initial_A), internal->initial_A, internal->dim_A * sizeof(double));
  odin_set_dim(initial_A, 2, internal->dim_A_1, internal->dim_A_2);
  SET_VECTOR_ELT(contents, 242, initial_A);
  SEXP initial_cum_diag_a = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_a));
  memcpy(REAL(initial_cum_diag_a), internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  odin_set_dim(initial_cum_diag_a, 2, internal->dim_cum_diag_a_1, internal->dim_cum_diag_a_2);
  SET_VECTOR_ELT(contents, 243, initial_cum_diag_a);
  SEXP initial_cum_diag_s = PROTECT(allocVector(REALSXP, internal->dim_cum_diag_s));
  memcpy(REAL(initial_cum_diag_s), internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  odin_set_dim(initial_cum_diag_s, 2, internal->dim_cum_diag_s_1, internal->dim_cum_diag_s_2);
  SET_VECTOR_ELT(contents, 244, initial_cum_diag_s);
  SEXP initial_cum_entrants = PROTECT(allocVector(REALSXP, internal->dim_cum_entrants));
  memcpy(REAL(initial_cum_entrants), internal->initial_cum_entrants, internal->dim_cum_entrants * sizeof(double));
  odin_set_dim(initial_cum_entrants, 2, internal->dim_cum_entrants_1, internal->dim_cum_entrants_2);
  SET_VECTOR_ELT(contents, 245, initial_cum_entrants);
  SEXP initial_cum_incid = PROTECT(allocVector(REALSXP, internal->dim_cum_incid));
  memcpy(REAL(initial_cum_incid), internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  odin_set_dim(initial_cum_incid, 2, internal->dim_cum_incid_1, internal->dim_cum_incid_2);
  SET_VECTOR_ELT(contents, 246, initial_cum_incid);
  SEXP initial_cum_offered = PROTECT(allocVector(REALSXP, internal->dim_cum_offered));
  memcpy(REAL(initial_cum_offered), internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  odin_set_dim(initial_cum_offered, 2, internal->dim_cum_offered_1, internal->dim_cum_offered_2);
  SET_VECTOR_ELT(contents, 247, initial_cum_offered);
  SEXP initial_cum_offered_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_offered_vbe));
  memcpy(REAL(initial_cum_offered_vbe), internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  odin_set_dim(initial_cum_offered_vbe, 2, internal->dim_cum_offered_vbe_1, internal->dim_cum_offered_vbe_2);
  SET_VECTOR_ELT(contents, 248, initial_cum_offered_vbe);
  SEXP initial_cum_screened = PROTECT(allocVector(REALSXP, internal->dim_cum_screened));
  memcpy(REAL(initial_cum_screened), internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  odin_set_dim(initial_cum_screened, 2, internal->dim_cum_screened_1, internal->dim_cum_screened_2);
  SET_VECTOR_ELT(contents, 249, initial_cum_screened);
  SEXP initial_cum_treated = PROTECT(allocVector(REALSXP, internal->dim_cum_treated));
  memcpy(REAL(initial_cum_treated), internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  odin_set_dim(initial_cum_treated, 2, internal->dim_cum_treated_1, internal->dim_cum_treated_2);
  SET_VECTOR_ELT(contents, 250, initial_cum_treated);
  SEXP initial_cum_vaccinated = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated));
  memcpy(REAL(initial_cum_vaccinated), internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  odin_set_dim(initial_cum_vaccinated, 2, internal->dim_cum_vaccinated_1, internal->dim_cum_vaccinated_2);
  SET_VECTOR_ELT(contents, 251, initial_cum_vaccinated);
  SEXP initial_cum_vaccinated_screen = PROTECT(allocVector(REALSXP, internal->dim_cum_vaccinated_screen));
  memcpy(REAL(initial_cum_vaccinated_screen), internal->initial_cum_vaccinated_screen, internal->dim_cum_vaccinated_screen * sizeof(double));
  odin_set_dim(initial_cum_vaccinated_screen, 2, internal->dim_cum_vaccinated_screen_1, internal->dim_cum_vaccinated_screen_2);
  SET_VECTOR_ELT(contents, 252, initial_cum_vaccinated_screen);
  SEXP initial_cum_vbe = PROTECT(allocVector(REALSXP, internal->dim_cum_vbe));
  memcpy(REAL(initial_cum_vbe), internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  odin_set_dim(initial_cum_vbe, 2, internal->dim_cum_vbe_1, internal->dim_cum_vbe_2);
  SET_VECTOR_ELT(contents, 253, initial_cum_vbe);
  SEXP initial_I = PROTECT(allocVector(REALSXP, internal->dim_I));
  memcpy(REAL(initial_I), internal->initial_I, internal->dim_I * sizeof(double));
  odin_set_dim(initial_I, 2, internal->dim_I_1, internal->dim_I_2);
  SET_VECTOR_ELT(contents, 254, initial_I);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 2, internal->dim_S_1, internal->dim_S_2);
  SET_VECTOR_ELT(contents, 255, initial_S);
  SEXP initial_T = PROTECT(allocVector(REALSXP, internal->dim_T));
  memcpy(REAL(initial_T), internal->initial_T, internal->dim_T * sizeof(double));
  odin_set_dim(initial_T, 2, internal->dim_T_1, internal->dim_T_2);
  SET_VECTOR_ELT(contents, 256, initial_T);
  SEXP initial_U = PROTECT(allocVector(REALSXP, internal->dim_U));
  memcpy(REAL(initial_U), internal->initial_U, internal->dim_U * sizeof(double));
  odin_set_dim(initial_U, 2, internal->dim_U_1, internal->dim_U_2);
  SET_VECTOR_ELT(contents, 257, initial_U);
  SEXP lambda = PROTECT(allocVector(REALSXP, internal->dim_lambda));
  memcpy(REAL(lambda), internal->lambda, internal->dim_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 262, lambda);
  SET_VECTOR_ELT(contents, 263, ScalarReal(internal->mu));
  SEXP N = PROTECT(allocVector(REALSXP, internal->dim_N));
  memcpy(REAL(N), internal->N, internal->dim_N * sizeof(double));
  odin_set_dim(N, 2, internal->dim_N_1, internal->dim_N_2);
  SET_VECTOR_ELT(contents, 264, N);
  SEXP n_AT = PROTECT(allocVector(REALSXP, internal->dim_n_AT));
  memcpy(REAL(n_AT), internal->n_AT, internal->dim_n_AT * sizeof(double));
  odin_set_dim(n_AT, 2, internal->dim_n_AT_1, internal->dim_n_AT_2);
  SET_VECTOR_ELT(contents, 265, n_AT);
  SEXP n_AU = PROTECT(allocVector(REALSXP, internal->dim_n_AU));
  memcpy(REAL(n_AU), internal->n_AU, internal->dim_n_AU * sizeof(double));
  odin_set_dim(n_AU, 2, internal->dim_n_AU_1, internal->dim_n_AU_2);
  SET_VECTOR_ELT(contents, 266, n_AU);
  SEXP n_diag_rec = PROTECT(allocVector(REALSXP, internal->dim_n_diag_rec));
  memcpy(REAL(n_diag_rec), internal->n_diag_rec, internal->dim_n_diag_rec * sizeof(double));
  odin_set_dim(n_diag_rec, 3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_2, internal->dim_n_diag_rec_3);
  SET_VECTOR_ELT(contents, 267, n_diag_rec);
  SET_VECTOR_ELT(contents, 268, ScalarInteger(internal->n_group));
  SEXP n_obe = PROTECT(allocVector(REALSXP, internal->dim_n_obe));
  memcpy(REAL(n_obe), internal->n_obe, internal->dim_n_obe * sizeof(double));
  odin_set_dim(n_obe, 3, internal->dim_n_obe_1, internal->dim_n_obe_2, internal->dim_n_obe_3);
  SET_VECTOR_ELT(contents, 269, n_obe);
  SEXP n_ood = PROTECT(allocVector(REALSXP, internal->dim_n_ood));
  memcpy(REAL(n_ood), internal->n_ood, internal->dim_n_ood * sizeof(double));
  odin_set_dim(n_ood, 3, internal->dim_n_ood_1, internal->dim_n_ood_2, internal->dim_n_ood_3);
  SET_VECTOR_ELT(contents, 270, n_ood);
  SEXP n_oos = PROTECT(allocVector(REALSXP, internal->dim_n_oos));
  memcpy(REAL(n_oos), internal->n_oos, internal->dim_n_oos * sizeof(double));
  odin_set_dim(n_oos, 3, internal->dim_n_oos_1, internal->dim_n_oos_2, internal->dim_n_oos_3);
  SET_VECTOR_ELT(contents, 271, n_oos);
  SEXP n_ST = PROTECT(allocVector(REALSXP, internal->dim_n_ST));
  memcpy(REAL(n_ST), internal->n_ST, internal->dim_n_ST * sizeof(double));
  odin_set_dim(n_ST, 2, internal->dim_n_ST_1, internal->dim_n_ST_2);
  SET_VECTOR_ELT(contents, 272, n_ST);
  SEXP n_TU = PROTECT(allocVector(REALSXP, internal->dim_n_TU));
  memcpy(REAL(n_TU), internal->n_TU, internal->dim_n_TU * sizeof(double));
  odin_set_dim(n_TU, 2, internal->dim_n_TU_1, internal->dim_n_TU_2);
  SET_VECTOR_ELT(contents, 273, n_TU);
  SEXP n_UI = PROTECT(allocVector(REALSXP, internal->dim_n_UI));
  memcpy(REAL(n_UI), internal->n_UI, internal->dim_n_UI * sizeof(double));
  odin_set_dim(n_UI, 2, internal->dim_n_UI_1, internal->dim_n_UI_2);
  SET_VECTOR_ELT(contents, 274, n_UI);
  SET_VECTOR_ELT(contents, 275, ScalarInteger(internal->n_vax));
  SEXP n_vbe = PROTECT(allocVector(REALSXP, internal->dim_n_vbe));
  memcpy(REAL(n_vbe), internal->n_vbe, internal->dim_n_vbe * sizeof(double));
  odin_set_dim(n_vbe, 3, internal->dim_n_vbe_1, internal->dim_n_vbe_2, internal->dim_n_vbe_3);
  SET_VECTOR_ELT(contents, 276, n_vbe);
  SEXP n_vod = PROTECT(allocVector(REALSXP, internal->dim_n_vod));
  memcpy(REAL(n_vod), internal->n_vod, internal->dim_n_vod * sizeof(double));
  odin_set_dim(n_vod, 3, internal->dim_n_vod_1, internal->dim_n_vod_2, internal->dim_n_vod_3);
  SET_VECTOR_ELT(contents, 277, n_vod);
  SEXP n_vos = PROTECT(allocVector(REALSXP, internal->dim_n_vos));
  memcpy(REAL(n_vos), internal->n_vos, internal->dim_n_vos * sizeof(double));
  odin_set_dim(n_vos, 3, internal->dim_n_vos_1, internal->dim_n_vos_2, internal->dim_n_vos_3);
  SET_VECTOR_ELT(contents, 278, n_vos);
  SEXP Np = PROTECT(allocVector(REALSXP, internal->dim_Np));
  memcpy(REAL(Np), internal->Np, internal->dim_Np * sizeof(double));
  SET_VECTOR_ELT(contents, 279, Np);
  SET_VECTOR_ELT(contents, 280, ScalarReal(internal->nu));
  SET_VECTOR_ELT(contents, 281, ScalarInteger(internal->offset_output_lambda));
  SET_VECTOR_ELT(contents, 282, ScalarInteger(internal->offset_output_N));
  SET_VECTOR_ELT(contents, 283, ScalarInteger(internal->offset_variable_A));
  SET_VECTOR_ELT(contents, 284, ScalarInteger(internal->offset_variable_cum_diag_a));
  SET_VECTOR_ELT(contents, 285, ScalarInteger(internal->offset_variable_cum_diag_s));
  SET_VECTOR_ELT(contents, 286, ScalarInteger(internal->offset_variable_cum_entrants));
  SET_VECTOR_ELT(contents, 287, ScalarInteger(internal->offset_variable_cum_incid));
  SET_VECTOR_ELT(contents, 288, ScalarInteger(internal->offset_variable_cum_offered));
  SET_VECTOR_ELT(contents, 289, ScalarInteger(internal->offset_variable_cum_offered_vbe));
  SET_VECTOR_ELT(contents, 290, ScalarInteger(internal->offset_variable_cum_screened));
  SET_VECTOR_ELT(contents, 291, ScalarInteger(internal->offset_variable_cum_treated));
  SET_VECTOR_ELT(contents, 292, ScalarInteger(internal->offset_variable_cum_vaccinated));
  SET_VECTOR_ELT(contents, 293, ScalarInteger(internal->offset_variable_cum_vaccinated_screen));
  SET_VECTOR_ELT(contents, 294, ScalarInteger(internal->offset_variable_cum_vbe));
  SET_VECTOR_ELT(contents, 295, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 296, ScalarInteger(internal->offset_variable_T));
  SEXP p = PROTECT(allocVector(REALSXP, internal->dim_p));
  memcpy(REAL(p), internal->p, internal->dim_p * sizeof(double));
  SET_VECTOR_ELT(contents, 297, p);
  SEXP prop_C = PROTECT(allocVector(REALSXP, internal->dim_prop_C));
  memcpy(REAL(prop_C), internal->prop_C, internal->dim_prop_C * sizeof(double));
  SET_VECTOR_ELT(contents, 298, prop_C);
  SET_VECTOR_ELT(contents, 299, ScalarReal(internal->psi));
  SEXP q = PROTECT(allocVector(REALSXP, internal->dim_q));
  memcpy(REAL(q), internal->q, internal->dim_q * sizeof(double));
  SET_VECTOR_ELT(contents, 300, q);
  SET_VECTOR_ELT(contents, 301, ScalarReal(internal->rho));
  SEXP S0 = PROTECT(allocVector(REALSXP, internal->dim_S0));
  memcpy(REAL(S0), internal->S0, internal->dim_S0 * sizeof(double));
  odin_set_dim(S0, 2, internal->dim_S0_1, internal->dim_S0_2);
  SET_VECTOR_ELT(contents, 302, S0);
  SEXP screened = PROTECT(allocVector(REALSXP, internal->dim_screened));
  memcpy(REAL(screened), internal->screened, internal->dim_screened * sizeof(double));
  odin_set_dim(screened, 2, internal->dim_screened_1, internal->dim_screened_2);
  SET_VECTOR_ELT(contents, 303, screened);
  SET_VECTOR_ELT(contents, 304, ScalarReal(internal->sigma));
  SEXP T0 = PROTECT(allocVector(REALSXP, internal->dim_T0));
  memcpy(REAL(T0), internal->T0, internal->dim_T0 * sizeof(double));
  odin_set_dim(T0, 2, internal->dim_T0_1, internal->dim_T0_2);
  SET_VECTOR_ELT(contents, 305, T0);
  SEXP tt = PROTECT(allocVector(REALSXP, internal->dim_tt));
  memcpy(REAL(tt), internal->tt, internal->dim_tt * sizeof(double));
  SET_VECTOR_ELT(contents, 306, tt);
  SEXP u_d = PROTECT(allocVector(REALSXP, internal->dim_u_d));
  memcpy(REAL(u_d), internal->u_d, internal->dim_u_d * sizeof(double));
  odin_set_dim(u_d, 3, internal->dim_u_d_1, internal->dim_u_d_2, internal->dim_u_d_3);
  SET_VECTOR_ELT(contents, 307, u_d);
  SEXP u_s = PROTECT(allocVector(REALSXP, internal->dim_u_s));
  memcpy(REAL(u_s), internal->u_s, internal->dim_u_s * sizeof(double));
  odin_set_dim(u_s, 3, internal->dim_u_s_1, internal->dim_u_s_2, internal->dim_u_s_3);
  SET_VECTOR_ELT(contents, 308, u_s);
  SET_VECTOR_ELT(contents, 309, ScalarReal(internal->u_vbe));
  SEXP U0 = PROTECT(allocVector(REALSXP, internal->dim_U0));
  memcpy(REAL(U0), internal->U0, internal->dim_U0 * sizeof(double));
  odin_set_dim(U0, 2, internal->dim_U0_1, internal->dim_U0_2);
  SET_VECTOR_ELT(contents, 310, U0);
  SEXP vax_t = PROTECT(allocVector(REALSXP, internal->dim_vax_t));
  memcpy(REAL(vax_t), internal->vax_t, internal->dim_vax_t * sizeof(double));
  SET_VECTOR_ELT(contents, 311, vax_t);
  SEXP vax_y = PROTECT(allocVector(REALSXP, internal->dim_vax_y));
  memcpy(REAL(vax_y), internal->vax_y, internal->dim_vax_y * sizeof(double));
  SET_VECTOR_ELT(contents, 312, vax_y);
  SEXP vbe = PROTECT(allocVector(REALSXP, internal->dim_vbe));
  memcpy(REAL(vbe), internal->vbe, internal->dim_vbe * sizeof(double));
  odin_set_dim(vbe, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  SET_VECTOR_ELT(contents, 313, vbe);
  SEXP vea = PROTECT(allocVector(REALSXP, internal->dim_vea));
  memcpy(REAL(vea), internal->vea, internal->dim_vea * sizeof(double));
  SET_VECTOR_ELT(contents, 314, vea);
  SEXP ved = PROTECT(allocVector(REALSXP, internal->dim_ved));
  memcpy(REAL(ved), internal->ved, internal->dim_ved * sizeof(double));
  SET_VECTOR_ELT(contents, 315, ved);
  SEXP vei = PROTECT(allocVector(REALSXP, internal->dim_vei));
  memcpy(REAL(vei), internal->vei, internal->dim_vei * sizeof(double));
  SET_VECTOR_ELT(contents, 316, vei);
  SEXP ves = PROTECT(allocVector(REALSXP, internal->dim_ves));
  memcpy(REAL(ves), internal->ves, internal->dim_ves * sizeof(double));
  SET_VECTOR_ELT(contents, 317, ves);
  SEXP vod = PROTECT(allocVector(REALSXP, internal->dim_vod));
  memcpy(REAL(vod), internal->vod, internal->dim_vod * sizeof(double));
  odin_set_dim(vod, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  SET_VECTOR_ELT(contents, 318, vod);
  SEXP vos = PROTECT(allocVector(REALSXP, internal->dim_vos));
  memcpy(REAL(vos), internal->vos, internal->dim_vos * sizeof(double));
  odin_set_dim(vos, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  SET_VECTOR_ELT(contents, 319, vos);
  SEXP w = PROTECT(allocVector(REALSXP, internal->dim_w));
  memcpy(REAL(w), internal->w, internal->dim_w * sizeof(double));
  odin_set_dim(w, 2, internal->dim_w_1, internal->dim_w_2);
  SET_VECTOR_ELT(contents, 320, w);
  SEXP wA = PROTECT(allocVector(REALSXP, internal->dim_wA));
  memcpy(REAL(wA), internal->wA, internal->dim_wA * sizeof(double));
  odin_set_dim(wA, 3, internal->dim_wA_1, internal->dim_wA_2, internal->dim_wA_3);
  SET_VECTOR_ELT(contents, 321, wA);
  SEXP wd = PROTECT(allocVector(REALSXP, internal->dim_wd));
  memcpy(REAL(wd), internal->wd, internal->dim_wd * sizeof(double));
  odin_set_dim(wd, 2, internal->dim_wd_1, internal->dim_wd_2);
  SET_VECTOR_ELT(contents, 322, wd);
  SEXP wdA = PROTECT(allocVector(REALSXP, internal->dim_wdA));
  memcpy(REAL(wdA), internal->wdA, internal->dim_wdA * sizeof(double));
  odin_set_dim(wdA, 3, internal->dim_wdA_1, internal->dim_wdA_2, internal->dim_wdA_3);
  SET_VECTOR_ELT(contents, 323, wdA);
  SEXP wdI = PROTECT(allocVector(REALSXP, internal->dim_wdI));
  memcpy(REAL(wdI), internal->wdI, internal->dim_wdI * sizeof(double));
  odin_set_dim(wdI, 3, internal->dim_wdI_1, internal->dim_wdI_2, internal->dim_wdI_3);
  SET_VECTOR_ELT(contents, 324, wdI);
  SEXP wdS = PROTECT(allocVector(REALSXP, internal->dim_wdS));
  memcpy(REAL(wdS), internal->wdS, internal->dim_wdS * sizeof(double));
  odin_set_dim(wdS, 3, internal->dim_wdS_1, internal->dim_wdS_2, internal->dim_wdS_3);
  SET_VECTOR_ELT(contents, 325, wdS);
  SEXP wdT = PROTECT(allocVector(REALSXP, internal->dim_wdT));
  memcpy(REAL(wdT), internal->wdT, internal->dim_wdT * sizeof(double));
  odin_set_dim(wdT, 3, internal->dim_wdT_1, internal->dim_wdT_2, internal->dim_wdT_3);
  SET_VECTOR_ELT(contents, 326, wdT);
  SEXP wdU = PROTECT(allocVector(REALSXP, internal->dim_wdU));
  memcpy(REAL(wdU), internal->wdU, internal->dim_wdU * sizeof(double));
  odin_set_dim(wdU, 3, internal->dim_wdU_1, internal->dim_wdU_2, internal->dim_wdU_3);
  SET_VECTOR_ELT(contents, 327, wdU);
  SEXP wI = PROTECT(allocVector(REALSXP, internal->dim_wI));
  memcpy(REAL(wI), internal->wI, internal->dim_wI * sizeof(double));
  odin_set_dim(wI, 3, internal->dim_wI_1, internal->dim_wI_2, internal->dim_wI_3);
  SET_VECTOR_ELT(contents, 328, wI);
  SEXP willing = PROTECT(allocVector(REALSXP, internal->dim_willing));
  memcpy(REAL(willing), internal->willing, internal->dim_willing * sizeof(double));
  SET_VECTOR_ELT(contents, 329, willing);
  SEXP wS = PROTECT(allocVector(REALSXP, internal->dim_wS));
  memcpy(REAL(wS), internal->wS, internal->dim_wS * sizeof(double));
  odin_set_dim(wS, 3, internal->dim_wS_1, internal->dim_wS_2, internal->dim_wS_3);
  SET_VECTOR_ELT(contents, 330, wS);
  SEXP wT = PROTECT(allocVector(REALSXP, internal->dim_wT));
  memcpy(REAL(wT), internal->wT, internal->dim_wT * sizeof(double));
  odin_set_dim(wT, 3, internal->dim_wT_1, internal->dim_wT_2, internal->dim_wT_3);
  SET_VECTOR_ELT(contents, 331, wT);
  SEXP wU = PROTECT(allocVector(REALSXP, internal->dim_wU));
  memcpy(REAL(wU), internal->wU, internal->dim_wU * sizeof(double));
  odin_set_dim(wU, 3, internal->dim_wU_1, internal->dim_wU_2, internal->dim_wU_3);
  SET_VECTOR_ELT(contents, 332, wU);
  SEXP nms = PROTECT(allocVector(STRSXP, 333));
  SET_STRING_ELT(nms, 0, mkChar("A0"));
  SET_STRING_ELT(nms, 1, mkChar("beta_t"));
  SET_STRING_ELT(nms, 2, mkChar("C"));
  SET_STRING_ELT(nms, 3, mkChar("diag_rec"));
  SET_STRING_ELT(nms, 4, mkChar("dim_A"));
  SET_STRING_ELT(nms, 5, mkChar("dim_A_1"));
  SET_STRING_ELT(nms, 6, mkChar("dim_A_2"));
  SET_STRING_ELT(nms, 7, mkChar("dim_A0"));
  SET_STRING_ELT(nms, 8, mkChar("dim_A0_1"));
  SET_STRING_ELT(nms, 9, mkChar("dim_A0_2"));
  SET_STRING_ELT(nms, 10, mkChar("dim_beta_t"));
  SET_STRING_ELT(nms, 11, mkChar("dim_C"));
  SET_STRING_ELT(nms, 12, mkChar("dim_C_1"));
  SET_STRING_ELT(nms, 13, mkChar("dim_C_2"));
  SET_STRING_ELT(nms, 14, mkChar("dim_cum_diag_a"));
  SET_STRING_ELT(nms, 15, mkChar("dim_cum_diag_a_1"));
  SET_STRING_ELT(nms, 16, mkChar("dim_cum_diag_a_2"));
  SET_STRING_ELT(nms, 17, mkChar("dim_cum_diag_s"));
  SET_STRING_ELT(nms, 18, mkChar("dim_cum_diag_s_1"));
  SET_STRING_ELT(nms, 19, mkChar("dim_cum_diag_s_2"));
  SET_STRING_ELT(nms, 20, mkChar("dim_cum_entrants"));
  SET_STRING_ELT(nms, 21, mkChar("dim_cum_entrants_1"));
  SET_STRING_ELT(nms, 22, mkChar("dim_cum_entrants_2"));
  SET_STRING_ELT(nms, 23, mkChar("dim_cum_incid"));
  SET_STRING_ELT(nms, 24, mkChar("dim_cum_incid_1"));
  SET_STRING_ELT(nms, 25, mkChar("dim_cum_incid_2"));
  SET_STRING_ELT(nms, 26, mkChar("dim_cum_offered"));
  SET_STRING_ELT(nms, 27, mkChar("dim_cum_offered_1"));
  SET_STRING_ELT(nms, 28, mkChar("dim_cum_offered_2"));
  SET_STRING_ELT(nms, 29, mkChar("dim_cum_offered_vbe"));
  SET_STRING_ELT(nms, 30, mkChar("dim_cum_offered_vbe_1"));
  SET_STRING_ELT(nms, 31, mkChar("dim_cum_offered_vbe_2"));
  SET_STRING_ELT(nms, 32, mkChar("dim_cum_screened"));
  SET_STRING_ELT(nms, 33, mkChar("dim_cum_screened_1"));
  SET_STRING_ELT(nms, 34, mkChar("dim_cum_screened_2"));
  SET_STRING_ELT(nms, 35, mkChar("dim_cum_treated"));
  SET_STRING_ELT(nms, 36, mkChar("dim_cum_treated_1"));
  SET_STRING_ELT(nms, 37, mkChar("dim_cum_treated_2"));
  SET_STRING_ELT(nms, 38, mkChar("dim_cum_vaccinated"));
  SET_STRING_ELT(nms, 39, mkChar("dim_cum_vaccinated_1"));
  SET_STRING_ELT(nms, 40, mkChar("dim_cum_vaccinated_2"));
  SET_STRING_ELT(nms, 41, mkChar("dim_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 42, mkChar("dim_cum_vaccinated_screen_1"));
  SET_STRING_ELT(nms, 43, mkChar("dim_cum_vaccinated_screen_2"));
  SET_STRING_ELT(nms, 44, mkChar("dim_cum_vbe"));
  SET_STRING_ELT(nms, 45, mkChar("dim_cum_vbe_1"));
  SET_STRING_ELT(nms, 46, mkChar("dim_cum_vbe_2"));
  SET_STRING_ELT(nms, 47, mkChar("dim_diag_rec"));
  SET_STRING_ELT(nms, 48, mkChar("dim_diag_rec_1"));
  SET_STRING_ELT(nms, 49, mkChar("dim_diag_rec_12"));
  SET_STRING_ELT(nms, 50, mkChar("dim_diag_rec_2"));
  SET_STRING_ELT(nms, 51, mkChar("dim_diag_rec_3"));
  SET_STRING_ELT(nms, 52, mkChar("dim_entrants"));
  SET_STRING_ELT(nms, 53, mkChar("dim_entrants_1"));
  SET_STRING_ELT(nms, 54, mkChar("dim_entrants_2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_eta"));
  SET_STRING_ELT(nms, 56, mkChar("dim_eta_h_t"));
  SET_STRING_ELT(nms, 57, mkChar("dim_eta_l_t"));
  SET_STRING_ELT(nms, 58, mkChar("dim_foi_LH"));
  SET_STRING_ELT(nms, 59, mkChar("dim_I"));
  SET_STRING_ELT(nms, 60, mkChar("dim_I_1"));
  SET_STRING_ELT(nms, 61, mkChar("dim_I_2"));
  SET_STRING_ELT(nms, 62, mkChar("dim_I0"));
  SET_STRING_ELT(nms, 63, mkChar("dim_I0_1"));
  SET_STRING_ELT(nms, 64, mkChar("dim_I0_2"));
  SET_STRING_ELT(nms, 65, mkChar("dim_lambda"));
  SET_STRING_ELT(nms, 66, mkChar("dim_N"));
  SET_STRING_ELT(nms, 67, mkChar("dim_N_1"));
  SET_STRING_ELT(nms, 68, mkChar("dim_N_2"));
  SET_STRING_ELT(nms, 69, mkChar("dim_n_AT"));
  SET_STRING_ELT(nms, 70, mkChar("dim_n_AT_1"));
  SET_STRING_ELT(nms, 71, mkChar("dim_n_AT_2"));
  SET_STRING_ELT(nms, 72, mkChar("dim_n_AU"));
  SET_STRING_ELT(nms, 73, mkChar("dim_n_AU_1"));
  SET_STRING_ELT(nms, 74, mkChar("dim_n_AU_2"));
  SET_STRING_ELT(nms, 75, mkChar("dim_n_diag_rec"));
  SET_STRING_ELT(nms, 76, mkChar("dim_n_diag_rec_1"));
  SET_STRING_ELT(nms, 77, mkChar("dim_n_diag_rec_12"));
  SET_STRING_ELT(nms, 78, mkChar("dim_n_diag_rec_2"));
  SET_STRING_ELT(nms, 79, mkChar("dim_n_diag_rec_3"));
  SET_STRING_ELT(nms, 80, mkChar("dim_n_obe"));
  SET_STRING_ELT(nms, 81, mkChar("dim_n_obe_1"));
  SET_STRING_ELT(nms, 82, mkChar("dim_n_obe_12"));
  SET_STRING_ELT(nms, 83, mkChar("dim_n_obe_2"));
  SET_STRING_ELT(nms, 84, mkChar("dim_n_obe_3"));
  SET_STRING_ELT(nms, 85, mkChar("dim_n_ood"));
  SET_STRING_ELT(nms, 86, mkChar("dim_n_ood_1"));
  SET_STRING_ELT(nms, 87, mkChar("dim_n_ood_12"));
  SET_STRING_ELT(nms, 88, mkChar("dim_n_ood_2"));
  SET_STRING_ELT(nms, 89, mkChar("dim_n_ood_3"));
  SET_STRING_ELT(nms, 90, mkChar("dim_n_oos"));
  SET_STRING_ELT(nms, 91, mkChar("dim_n_oos_1"));
  SET_STRING_ELT(nms, 92, mkChar("dim_n_oos_12"));
  SET_STRING_ELT(nms, 93, mkChar("dim_n_oos_2"));
  SET_STRING_ELT(nms, 94, mkChar("dim_n_oos_3"));
  SET_STRING_ELT(nms, 95, mkChar("dim_n_ST"));
  SET_STRING_ELT(nms, 96, mkChar("dim_n_ST_1"));
  SET_STRING_ELT(nms, 97, mkChar("dim_n_ST_2"));
  SET_STRING_ELT(nms, 98, mkChar("dim_n_TU"));
  SET_STRING_ELT(nms, 99, mkChar("dim_n_TU_1"));
  SET_STRING_ELT(nms, 100, mkChar("dim_n_TU_2"));
  SET_STRING_ELT(nms, 101, mkChar("dim_n_UI"));
  SET_STRING_ELT(nms, 102, mkChar("dim_n_UI_1"));
  SET_STRING_ELT(nms, 103, mkChar("dim_n_UI_2"));
  SET_STRING_ELT(nms, 104, mkChar("dim_n_vbe"));
  SET_STRING_ELT(nms, 105, mkChar("dim_n_vbe_1"));
  SET_STRING_ELT(nms, 106, mkChar("dim_n_vbe_12"));
  SET_STRING_ELT(nms, 107, mkChar("dim_n_vbe_2"));
  SET_STRING_ELT(nms, 108, mkChar("dim_n_vbe_3"));
  SET_STRING_ELT(nms, 109, mkChar("dim_n_vod"));
  SET_STRING_ELT(nms, 110, mkChar("dim_n_vod_1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_n_vod_12"));
  SET_STRING_ELT(nms, 112, mkChar("dim_n_vod_2"));
  SET_STRING_ELT(nms, 113, mkChar("dim_n_vod_3"));
  SET_STRING_ELT(nms, 114, mkChar("dim_n_vos"));
  SET_STRING_ELT(nms, 115, mkChar("dim_n_vos_1"));
  SET_STRING_ELT(nms, 116, mkChar("dim_n_vos_12"));
  SET_STRING_ELT(nms, 117, mkChar("dim_n_vos_2"));
  SET_STRING_ELT(nms, 118, mkChar("dim_n_vos_3"));
  SET_STRING_ELT(nms, 119, mkChar("dim_Np"));
  SET_STRING_ELT(nms, 120, mkChar("dim_p"));
  SET_STRING_ELT(nms, 121, mkChar("dim_prop_C"));
  SET_STRING_ELT(nms, 122, mkChar("dim_q"));
  SET_STRING_ELT(nms, 123, mkChar("dim_S"));
  SET_STRING_ELT(nms, 124, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 125, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 126, mkChar("dim_S0"));
  SET_STRING_ELT(nms, 127, mkChar("dim_S0_1"));
  SET_STRING_ELT(nms, 128, mkChar("dim_S0_2"));
  SET_STRING_ELT(nms, 129, mkChar("dim_screened"));
  SET_STRING_ELT(nms, 130, mkChar("dim_screened_1"));
  SET_STRING_ELT(nms, 131, mkChar("dim_screened_2"));
  SET_STRING_ELT(nms, 132, mkChar("dim_T"));
  SET_STRING_ELT(nms, 133, mkChar("dim_T_1"));
  SET_STRING_ELT(nms, 134, mkChar("dim_T_2"));
  SET_STRING_ELT(nms, 135, mkChar("dim_T0"));
  SET_STRING_ELT(nms, 136, mkChar("dim_T0_1"));
  SET_STRING_ELT(nms, 137, mkChar("dim_T0_2"));
  SET_STRING_ELT(nms, 138, mkChar("dim_tt"));
  SET_STRING_ELT(nms, 139, mkChar("dim_U"));
  SET_STRING_ELT(nms, 140, mkChar("dim_U_1"));
  SET_STRING_ELT(nms, 141, mkChar("dim_U_2"));
  SET_STRING_ELT(nms, 142, mkChar("dim_u_d"));
  SET_STRING_ELT(nms, 143, mkChar("dim_u_d_1"));
  SET_STRING_ELT(nms, 144, mkChar("dim_u_d_12"));
  SET_STRING_ELT(nms, 145, mkChar("dim_u_d_2"));
  SET_STRING_ELT(nms, 146, mkChar("dim_u_d_3"));
  SET_STRING_ELT(nms, 147, mkChar("dim_u_s"));
  SET_STRING_ELT(nms, 148, mkChar("dim_u_s_1"));
  SET_STRING_ELT(nms, 149, mkChar("dim_u_s_12"));
  SET_STRING_ELT(nms, 150, mkChar("dim_u_s_2"));
  SET_STRING_ELT(nms, 151, mkChar("dim_u_s_3"));
  SET_STRING_ELT(nms, 152, mkChar("dim_U0"));
  SET_STRING_ELT(nms, 153, mkChar("dim_U0_1"));
  SET_STRING_ELT(nms, 154, mkChar("dim_U0_2"));
  SET_STRING_ELT(nms, 155, mkChar("dim_vax_t"));
  SET_STRING_ELT(nms, 156, mkChar("dim_vax_y"));
  SET_STRING_ELT(nms, 157, mkChar("dim_vbe"));
  SET_STRING_ELT(nms, 158, mkChar("dim_vbe_1"));
  SET_STRING_ELT(nms, 159, mkChar("dim_vbe_12"));
  SET_STRING_ELT(nms, 160, mkChar("dim_vbe_2"));
  SET_STRING_ELT(nms, 161, mkChar("dim_vbe_3"));
  SET_STRING_ELT(nms, 162, mkChar("dim_vea"));
  SET_STRING_ELT(nms, 163, mkChar("dim_ved"));
  SET_STRING_ELT(nms, 164, mkChar("dim_vei"));
  SET_STRING_ELT(nms, 165, mkChar("dim_ves"));
  SET_STRING_ELT(nms, 166, mkChar("dim_vod"));
  SET_STRING_ELT(nms, 167, mkChar("dim_vod_1"));
  SET_STRING_ELT(nms, 168, mkChar("dim_vod_12"));
  SET_STRING_ELT(nms, 169, mkChar("dim_vod_2"));
  SET_STRING_ELT(nms, 170, mkChar("dim_vod_3"));
  SET_STRING_ELT(nms, 171, mkChar("dim_vos"));
  SET_STRING_ELT(nms, 172, mkChar("dim_vos_1"));
  SET_STRING_ELT(nms, 173, mkChar("dim_vos_12"));
  SET_STRING_ELT(nms, 174, mkChar("dim_vos_2"));
  SET_STRING_ELT(nms, 175, mkChar("dim_vos_3"));
  SET_STRING_ELT(nms, 176, mkChar("dim_w"));
  SET_STRING_ELT(nms, 177, mkChar("dim_w_1"));
  SET_STRING_ELT(nms, 178, mkChar("dim_w_2"));
  SET_STRING_ELT(nms, 179, mkChar("dim_wA"));
  SET_STRING_ELT(nms, 180, mkChar("dim_wA_1"));
  SET_STRING_ELT(nms, 181, mkChar("dim_wA_12"));
  SET_STRING_ELT(nms, 182, mkChar("dim_wA_2"));
  SET_STRING_ELT(nms, 183, mkChar("dim_wA_3"));
  SET_STRING_ELT(nms, 184, mkChar("dim_wd"));
  SET_STRING_ELT(nms, 185, mkChar("dim_wd_1"));
  SET_STRING_ELT(nms, 186, mkChar("dim_wd_2"));
  SET_STRING_ELT(nms, 187, mkChar("dim_wdA"));
  SET_STRING_ELT(nms, 188, mkChar("dim_wdA_1"));
  SET_STRING_ELT(nms, 189, mkChar("dim_wdA_12"));
  SET_STRING_ELT(nms, 190, mkChar("dim_wdA_2"));
  SET_STRING_ELT(nms, 191, mkChar("dim_wdA_3"));
  SET_STRING_ELT(nms, 192, mkChar("dim_wdI"));
  SET_STRING_ELT(nms, 193, mkChar("dim_wdI_1"));
  SET_STRING_ELT(nms, 194, mkChar("dim_wdI_12"));
  SET_STRING_ELT(nms, 195, mkChar("dim_wdI_2"));
  SET_STRING_ELT(nms, 196, mkChar("dim_wdI_3"));
  SET_STRING_ELT(nms, 197, mkChar("dim_wdS"));
  SET_STRING_ELT(nms, 198, mkChar("dim_wdS_1"));
  SET_STRING_ELT(nms, 199, mkChar("dim_wdS_12"));
  SET_STRING_ELT(nms, 200, mkChar("dim_wdS_2"));
  SET_STRING_ELT(nms, 201, mkChar("dim_wdS_3"));
  SET_STRING_ELT(nms, 202, mkChar("dim_wdT"));
  SET_STRING_ELT(nms, 203, mkChar("dim_wdT_1"));
  SET_STRING_ELT(nms, 204, mkChar("dim_wdT_12"));
  SET_STRING_ELT(nms, 205, mkChar("dim_wdT_2"));
  SET_STRING_ELT(nms, 206, mkChar("dim_wdT_3"));
  SET_STRING_ELT(nms, 207, mkChar("dim_wdU"));
  SET_STRING_ELT(nms, 208, mkChar("dim_wdU_1"));
  SET_STRING_ELT(nms, 209, mkChar("dim_wdU_12"));
  SET_STRING_ELT(nms, 210, mkChar("dim_wdU_2"));
  SET_STRING_ELT(nms, 211, mkChar("dim_wdU_3"));
  SET_STRING_ELT(nms, 212, mkChar("dim_wI"));
  SET_STRING_ELT(nms, 213, mkChar("dim_wI_1"));
  SET_STRING_ELT(nms, 214, mkChar("dim_wI_12"));
  SET_STRING_ELT(nms, 215, mkChar("dim_wI_2"));
  SET_STRING_ELT(nms, 216, mkChar("dim_wI_3"));
  SET_STRING_ELT(nms, 217, mkChar("dim_willing"));
  SET_STRING_ELT(nms, 218, mkChar("dim_wS"));
  SET_STRING_ELT(nms, 219, mkChar("dim_wS_1"));
  SET_STRING_ELT(nms, 220, mkChar("dim_wS_12"));
  SET_STRING_ELT(nms, 221, mkChar("dim_wS_2"));
  SET_STRING_ELT(nms, 222, mkChar("dim_wS_3"));
  SET_STRING_ELT(nms, 223, mkChar("dim_wT"));
  SET_STRING_ELT(nms, 224, mkChar("dim_wT_1"));
  SET_STRING_ELT(nms, 225, mkChar("dim_wT_12"));
  SET_STRING_ELT(nms, 226, mkChar("dim_wT_2"));
  SET_STRING_ELT(nms, 227, mkChar("dim_wT_3"));
  SET_STRING_ELT(nms, 228, mkChar("dim_wU"));
  SET_STRING_ELT(nms, 229, mkChar("dim_wU_1"));
  SET_STRING_ELT(nms, 230, mkChar("dim_wU_12"));
  SET_STRING_ELT(nms, 231, mkChar("dim_wU_2"));
  SET_STRING_ELT(nms, 232, mkChar("dim_wU_3"));
  SET_STRING_ELT(nms, 233, mkChar("enr"));
  SET_STRING_ELT(nms, 234, mkChar("entrants"));
  SET_STRING_ELT(nms, 235, mkChar("epsilon"));
  SET_STRING_ELT(nms, 236, mkChar("eta"));
  SET_STRING_ELT(nms, 237, mkChar("eta_h_t"));
  SET_STRING_ELT(nms, 238, mkChar("eta_l_t"));
  SET_STRING_ELT(nms, 239, mkChar("exr"));
  SET_STRING_ELT(nms, 240, mkChar("foi_LH"));
  SET_STRING_ELT(nms, 241, mkChar("I0"));
  SET_STRING_ELT(nms, 242, mkChar("initial_A"));
  SET_STRING_ELT(nms, 243, mkChar("initial_cum_diag_a"));
  SET_STRING_ELT(nms, 244, mkChar("initial_cum_diag_s"));
  SET_STRING_ELT(nms, 245, mkChar("initial_cum_entrants"));
  SET_STRING_ELT(nms, 246, mkChar("initial_cum_incid"));
  SET_STRING_ELT(nms, 247, mkChar("initial_cum_offered"));
  SET_STRING_ELT(nms, 248, mkChar("initial_cum_offered_vbe"));
  SET_STRING_ELT(nms, 249, mkChar("initial_cum_screened"));
  SET_STRING_ELT(nms, 250, mkChar("initial_cum_treated"));
  SET_STRING_ELT(nms, 251, mkChar("initial_cum_vaccinated"));
  SET_STRING_ELT(nms, 252, mkChar("initial_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 253, mkChar("initial_cum_vbe"));
  SET_STRING_ELT(nms, 254, mkChar("initial_I"));
  SET_STRING_ELT(nms, 255, mkChar("initial_S"));
  SET_STRING_ELT(nms, 256, mkChar("initial_T"));
  SET_STRING_ELT(nms, 257, mkChar("initial_U"));
  SET_STRING_ELT(nms, 258, mkChar("interpolate_beta"));
  SET_STRING_ELT(nms, 259, mkChar("interpolate_eta_h"));
  SET_STRING_ELT(nms, 260, mkChar("interpolate_eta_l"));
  SET_STRING_ELT(nms, 261, mkChar("interpolate_vax_switch"));
  SET_STRING_ELT(nms, 262, mkChar("lambda"));
  SET_STRING_ELT(nms, 263, mkChar("mu"));
  SET_STRING_ELT(nms, 264, mkChar("N"));
  SET_STRING_ELT(nms, 265, mkChar("n_AT"));
  SET_STRING_ELT(nms, 266, mkChar("n_AU"));
  SET_STRING_ELT(nms, 267, mkChar("n_diag_rec"));
  SET_STRING_ELT(nms, 268, mkChar("n_group"));
  SET_STRING_ELT(nms, 269, mkChar("n_obe"));
  SET_STRING_ELT(nms, 270, mkChar("n_ood"));
  SET_STRING_ELT(nms, 271, mkChar("n_oos"));
  SET_STRING_ELT(nms, 272, mkChar("n_ST"));
  SET_STRING_ELT(nms, 273, mkChar("n_TU"));
  SET_STRING_ELT(nms, 274, mkChar("n_UI"));
  SET_STRING_ELT(nms, 275, mkChar("n_vax"));
  SET_STRING_ELT(nms, 276, mkChar("n_vbe"));
  SET_STRING_ELT(nms, 277, mkChar("n_vod"));
  SET_STRING_ELT(nms, 278, mkChar("n_vos"));
  SET_STRING_ELT(nms, 279, mkChar("Np"));
  SET_STRING_ELT(nms, 280, mkChar("nu"));
  SET_STRING_ELT(nms, 281, mkChar("offset_output_lambda"));
  SET_STRING_ELT(nms, 282, mkChar("offset_output_N"));
  SET_STRING_ELT(nms, 283, mkChar("offset_variable_A"));
  SET_STRING_ELT(nms, 284, mkChar("offset_variable_cum_diag_a"));
  SET_STRING_ELT(nms, 285, mkChar("offset_variable_cum_diag_s"));
  SET_STRING_ELT(nms, 286, mkChar("offset_variable_cum_entrants"));
  SET_STRING_ELT(nms, 287, mkChar("offset_variable_cum_incid"));
  SET_STRING_ELT(nms, 288, mkChar("offset_variable_cum_offered"));
  SET_STRING_ELT(nms, 289, mkChar("offset_variable_cum_offered_vbe"));
  SET_STRING_ELT(nms, 290, mkChar("offset_variable_cum_screened"));
  SET_STRING_ELT(nms, 291, mkChar("offset_variable_cum_treated"));
  SET_STRING_ELT(nms, 292, mkChar("offset_variable_cum_vaccinated"));
  SET_STRING_ELT(nms, 293, mkChar("offset_variable_cum_vaccinated_screen"));
  SET_STRING_ELT(nms, 294, mkChar("offset_variable_cum_vbe"));
  SET_STRING_ELT(nms, 295, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 296, mkChar("offset_variable_T"));
  SET_STRING_ELT(nms, 297, mkChar("p"));
  SET_STRING_ELT(nms, 298, mkChar("prop_C"));
  SET_STRING_ELT(nms, 299, mkChar("psi"));
  SET_STRING_ELT(nms, 300, mkChar("q"));
  SET_STRING_ELT(nms, 301, mkChar("rho"));
  SET_STRING_ELT(nms, 302, mkChar("S0"));
  SET_STRING_ELT(nms, 303, mkChar("screened"));
  SET_STRING_ELT(nms, 304, mkChar("sigma"));
  SET_STRING_ELT(nms, 305, mkChar("T0"));
  SET_STRING_ELT(nms, 306, mkChar("tt"));
  SET_STRING_ELT(nms, 307, mkChar("u_d"));
  SET_STRING_ELT(nms, 308, mkChar("u_s"));
  SET_STRING_ELT(nms, 309, mkChar("u_vbe"));
  SET_STRING_ELT(nms, 310, mkChar("U0"));
  SET_STRING_ELT(nms, 311, mkChar("vax_t"));
  SET_STRING_ELT(nms, 312, mkChar("vax_y"));
  SET_STRING_ELT(nms, 313, mkChar("vbe"));
  SET_STRING_ELT(nms, 314, mkChar("vea"));
  SET_STRING_ELT(nms, 315, mkChar("ved"));
  SET_STRING_ELT(nms, 316, mkChar("vei"));
  SET_STRING_ELT(nms, 317, mkChar("ves"));
  SET_STRING_ELT(nms, 318, mkChar("vod"));
  SET_STRING_ELT(nms, 319, mkChar("vos"));
  SET_STRING_ELT(nms, 320, mkChar("w"));
  SET_STRING_ELT(nms, 321, mkChar("wA"));
  SET_STRING_ELT(nms, 322, mkChar("wd"));
  SET_STRING_ELT(nms, 323, mkChar("wdA"));
  SET_STRING_ELT(nms, 324, mkChar("wdI"));
  SET_STRING_ELT(nms, 325, mkChar("wdS"));
  SET_STRING_ELT(nms, 326, mkChar("wdT"));
  SET_STRING_ELT(nms, 327, mkChar("wdU"));
  SET_STRING_ELT(nms, 328, mkChar("wI"));
  SET_STRING_ELT(nms, 329, mkChar("willing"));
  SET_STRING_ELT(nms, 330, mkChar("wS"));
  SET_STRING_ELT(nms, 331, mkChar("wT"));
  SET_STRING_ELT(nms, 332, mkChar("wU"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(75);
  return contents;
}
SEXP model_withoutPN_set_user(SEXP internal_p, SEXP user) {
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 1);
  internal->enr = user_get_scalar_double(user, "enr", internal->enr, NA_REAL, NA_REAL);
  internal->epsilon = user_get_scalar_double(user, "epsilon", internal->epsilon, NA_REAL, NA_REAL);
  internal->exr = user_get_scalar_double(user, "exr", internal->exr, NA_REAL, NA_REAL);
  internal->mu = user_get_scalar_double(user, "mu", internal->mu, NA_REAL, NA_REAL);
  internal->n_vax = user_get_scalar_int(user, "n_vax", internal->n_vax, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->psi = user_get_scalar_double(user, "psi", internal->psi, NA_REAL, NA_REAL);
  internal->rho = user_get_scalar_double(user, "rho", internal->rho, NA_REAL, NA_REAL);
  internal->sigma = user_get_scalar_double(user, "sigma", internal->sigma, NA_REAL, NA_REAL);
  internal->tt = (double*) user_get_array_dim(user, false, internal->tt, "tt", 1, NA_REAL, NA_REAL, &internal->dim_tt);
  internal->u_vbe = user_get_scalar_double(user, "u_vbe", internal->u_vbe, NA_REAL, NA_REAL);
  internal->vax_t = (double*) user_get_array_dim(user, false, internal->vax_t, "vax_t", 1, NA_REAL, NA_REAL, &internal->dim_vax_t);
  internal->vax_y = (double*) user_get_array_dim(user, false, internal->vax_y, "vax_y", 1, NA_REAL, NA_REAL, &internal->dim_vax_y);
  internal->dim_A_1 = internal->n_group;
  internal->dim_A_2 = internal->n_vax;
  internal->dim_A0_1 = internal->n_group;
  internal->dim_A0_2 = internal->n_vax;
  internal->dim_C_1 = internal->n_group;
  internal->dim_C_2 = internal->n_vax;
  internal->dim_cum_diag_a_1 = internal->n_group;
  internal->dim_cum_diag_a_2 = internal->n_vax;
  internal->dim_cum_diag_s_1 = internal->n_group;
  internal->dim_cum_diag_s_2 = internal->n_vax;
  internal->dim_cum_entrants_1 = internal->n_group;
  internal->dim_cum_entrants_2 = internal->n_vax;
  internal->dim_cum_incid_1 = internal->n_group;
  internal->dim_cum_incid_2 = internal->n_vax;
  internal->dim_cum_offered_1 = internal->n_group;
  internal->dim_cum_offered_2 = internal->n_vax;
  internal->dim_cum_offered_vbe_1 = internal->n_group;
  internal->dim_cum_offered_vbe_2 = internal->n_vax;
  internal->dim_cum_screened_1 = internal->n_group;
  internal->dim_cum_screened_2 = internal->n_vax;
  internal->dim_cum_treated_1 = internal->n_group;
  internal->dim_cum_treated_2 = internal->n_vax;
  internal->dim_cum_vaccinated_1 = internal->n_group;
  internal->dim_cum_vaccinated_2 = internal->n_vax;
  internal->dim_cum_vaccinated_screen_1 = internal->n_group;
  internal->dim_cum_vaccinated_screen_2 = internal->n_vax;
  internal->dim_cum_vbe_1 = internal->n_group;
  internal->dim_cum_vbe_2 = internal->n_vax;
  internal->dim_diag_rec_1 = internal->n_group;
  internal->dim_diag_rec_2 = internal->n_vax;
  internal->dim_diag_rec_3 = internal->n_vax;
  internal->dim_entrants_1 = internal->n_group;
  internal->dim_entrants_2 = internal->n_vax;
  internal->dim_I_1 = internal->n_group;
  internal->dim_I_2 = internal->n_vax;
  internal->dim_I0_1 = internal->n_group;
  internal->dim_I0_2 = internal->n_vax;
  internal->dim_N_1 = internal->n_group;
  internal->dim_N_2 = internal->n_vax;
  internal->dim_n_AT_1 = internal->n_group;
  internal->dim_n_AT_2 = internal->n_vax;
  internal->dim_n_AU_1 = internal->n_group;
  internal->dim_n_AU_2 = internal->n_vax;
  internal->dim_n_diag_rec_1 = internal->n_group;
  internal->dim_n_diag_rec_2 = internal->n_vax;
  internal->dim_n_diag_rec_3 = internal->n_vax;
  internal->dim_n_obe_1 = internal->n_group;
  internal->dim_n_obe_2 = internal->n_vax;
  internal->dim_n_obe_3 = internal->n_vax;
  internal->dim_n_ood_1 = internal->n_group;
  internal->dim_n_ood_2 = internal->n_vax;
  internal->dim_n_ood_3 = internal->n_vax;
  internal->dim_n_oos_1 = internal->n_group;
  internal->dim_n_oos_2 = internal->n_vax;
  internal->dim_n_oos_3 = internal->n_vax;
  internal->dim_n_ST_1 = internal->n_group;
  internal->dim_n_ST_2 = internal->n_vax;
  internal->dim_n_TU_1 = internal->n_group;
  internal->dim_n_TU_2 = internal->n_vax;
  internal->dim_n_UI_1 = internal->n_group;
  internal->dim_n_UI_2 = internal->n_vax;
  internal->dim_n_vbe_1 = internal->n_group;
  internal->dim_n_vbe_2 = internal->n_vax;
  internal->dim_n_vbe_3 = internal->n_vax;
  internal->dim_n_vod_1 = internal->n_group;
  internal->dim_n_vod_2 = internal->n_vax;
  internal->dim_n_vod_3 = internal->n_vax;
  internal->dim_n_vos_1 = internal->n_group;
  internal->dim_n_vos_2 = internal->n_vax;
  internal->dim_n_vos_3 = internal->n_vax;
  internal->dim_S_1 = internal->n_group;
  internal->dim_S_2 = internal->n_vax;
  internal->dim_S0_1 = internal->n_group;
  internal->dim_S0_2 = internal->n_vax;
  internal->dim_screened_1 = internal->n_group;
  internal->dim_screened_2 = internal->n_vax;
  internal->dim_T_1 = internal->n_group;
  internal->dim_T_2 = internal->n_vax;
  internal->dim_T0_1 = internal->n_group;
  internal->dim_T0_2 = internal->n_vax;
  internal->dim_U_1 = internal->n_group;
  internal->dim_U_2 = internal->n_vax;
  internal->dim_u_d_1 = internal->n_group;
  internal->dim_u_d_2 = internal->n_vax;
  internal->dim_u_d_3 = internal->n_vax;
  internal->dim_u_s_1 = internal->n_group;
  internal->dim_u_s_2 = internal->n_vax;
  internal->dim_u_s_3 = internal->n_vax;
  internal->dim_U0_1 = internal->n_group;
  internal->dim_U0_2 = internal->n_vax;
  internal->dim_vbe_1 = internal->n_group;
  internal->dim_vbe_2 = internal->n_vax;
  internal->dim_vbe_3 = internal->n_vax;
  internal->dim_vea = internal->n_vax;
  internal->dim_ved = internal->n_vax;
  internal->dim_vei = internal->n_vax;
  internal->dim_ves = internal->n_vax;
  internal->dim_vod_1 = internal->n_group;
  internal->dim_vod_2 = internal->n_vax;
  internal->dim_vod_3 = internal->n_vax;
  internal->dim_vos_1 = internal->n_group;
  internal->dim_vos_2 = internal->n_vax;
  internal->dim_vos_3 = internal->n_vax;
  internal->dim_w_1 = internal->n_vax;
  internal->dim_w_2 = internal->n_vax;
  internal->dim_wA_1 = internal->n_group;
  internal->dim_wA_2 = internal->n_vax;
  internal->dim_wA_3 = internal->n_vax;
  internal->dim_wd_1 = internal->n_vax;
  internal->dim_wd_2 = internal->n_vax;
  internal->dim_wdA_1 = internal->n_group;
  internal->dim_wdA_2 = internal->n_vax;
  internal->dim_wdA_3 = internal->n_vax;
  internal->dim_wdI_1 = internal->n_group;
  internal->dim_wdI_2 = internal->n_vax;
  internal->dim_wdI_3 = internal->n_vax;
  internal->dim_wdS_1 = internal->n_group;
  internal->dim_wdS_2 = internal->n_vax;
  internal->dim_wdS_3 = internal->n_vax;
  internal->dim_wdT_1 = internal->n_group;
  internal->dim_wdT_2 = internal->n_vax;
  internal->dim_wdT_3 = internal->n_vax;
  internal->dim_wdU_1 = internal->n_group;
  internal->dim_wdU_2 = internal->n_vax;
  internal->dim_wdU_3 = internal->n_vax;
  internal->dim_wI_1 = internal->n_group;
  internal->dim_wI_2 = internal->n_vax;
  internal->dim_wI_3 = internal->n_vax;
  internal->dim_willing = internal->n_vax;
  internal->dim_wS_1 = internal->n_group;
  internal->dim_wS_2 = internal->n_vax;
  internal->dim_wS_3 = internal->n_vax;
  internal->dim_wT_1 = internal->n_group;
  internal->dim_wT_2 = internal->n_vax;
  internal->dim_wT_3 = internal->n_vax;
  internal->dim_wU_1 = internal->n_group;
  internal->dim_wU_2 = internal->n_vax;
  internal->dim_wU_3 = internal->n_vax;
  interpolate_check_y(internal->dim_vax_t, internal->dim_vax_y, 0, "vax_y", "vax_switch");
  cinterpolate_free(internal->interpolate_vax_switch);
  internal->interpolate_vax_switch = cinterpolate_alloc("constant", internal->dim_vax_t, 1, internal->vax_t, internal->vax_y, true, false);
  internal->dim_A = internal->dim_A_1 * internal->dim_A_2;
  internal->dim_A0 = internal->dim_A0_1 * internal->dim_A0_2;
  internal->dim_beta_t = internal->dim_tt;
  internal->dim_C = internal->dim_C_1 * internal->dim_C_2;
  internal->dim_cum_diag_a = internal->dim_cum_diag_a_1 * internal->dim_cum_diag_a_2;
  internal->dim_cum_diag_s = internal->dim_cum_diag_s_1 * internal->dim_cum_diag_s_2;
  internal->dim_cum_entrants = internal->dim_cum_entrants_1 * internal->dim_cum_entrants_2;
  internal->dim_cum_incid = internal->dim_cum_incid_1 * internal->dim_cum_incid_2;
  internal->dim_cum_offered = internal->dim_cum_offered_1 * internal->dim_cum_offered_2;
  internal->dim_cum_offered_vbe = internal->dim_cum_offered_vbe_1 * internal->dim_cum_offered_vbe_2;
  internal->dim_cum_screened = internal->dim_cum_screened_1 * internal->dim_cum_screened_2;
  internal->dim_cum_treated = internal->dim_cum_treated_1 * internal->dim_cum_treated_2;
  internal->dim_cum_vaccinated = internal->dim_cum_vaccinated_1 * internal->dim_cum_vaccinated_2;
  internal->dim_cum_vaccinated_screen = internal->dim_cum_vaccinated_screen_1 * internal->dim_cum_vaccinated_screen_2;
  internal->dim_cum_vbe = internal->dim_cum_vbe_1 * internal->dim_cum_vbe_2;
  internal->dim_diag_rec = internal->dim_diag_rec_1 * internal->dim_diag_rec_2 * internal->dim_diag_rec_3;
  internal->dim_diag_rec_12 = internal->dim_diag_rec_1 * internal->dim_diag_rec_2;
  internal->dim_entrants = internal->dim_entrants_1 * internal->dim_entrants_2;
  internal->dim_eta_h_t = internal->dim_tt;
  internal->dim_eta_l_t = internal->dim_tt;
  internal->dim_I = internal->dim_I_1 * internal->dim_I_2;
  internal->dim_I0 = internal->dim_I0_1 * internal->dim_I0_2;
  internal->dim_N = internal->dim_N_1 * internal->dim_N_2;
  internal->dim_n_AT = internal->dim_n_AT_1 * internal->dim_n_AT_2;
  internal->dim_n_AU = internal->dim_n_AU_1 * internal->dim_n_AU_2;
  internal->dim_n_diag_rec = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2 * internal->dim_n_diag_rec_3;
  internal->dim_n_diag_rec_12 = internal->dim_n_diag_rec_1 * internal->dim_n_diag_rec_2;
  internal->dim_n_obe = internal->dim_n_obe_1 * internal->dim_n_obe_2 * internal->dim_n_obe_3;
  internal->dim_n_obe_12 = internal->dim_n_obe_1 * internal->dim_n_obe_2;
  internal->dim_n_ood = internal->dim_n_ood_1 * internal->dim_n_ood_2 * internal->dim_n_ood_3;
  internal->dim_n_ood_12 = internal->dim_n_ood_1 * internal->dim_n_ood_2;
  internal->dim_n_oos = internal->dim_n_oos_1 * internal->dim_n_oos_2 * internal->dim_n_oos_3;
  internal->dim_n_oos_12 = internal->dim_n_oos_1 * internal->dim_n_oos_2;
  internal->dim_n_ST = internal->dim_n_ST_1 * internal->dim_n_ST_2;
  internal->dim_n_TU = internal->dim_n_TU_1 * internal->dim_n_TU_2;
  internal->dim_n_UI = internal->dim_n_UI_1 * internal->dim_n_UI_2;
  internal->dim_n_vbe = internal->dim_n_vbe_1 * internal->dim_n_vbe_2 * internal->dim_n_vbe_3;
  internal->dim_n_vbe_12 = internal->dim_n_vbe_1 * internal->dim_n_vbe_2;
  internal->dim_n_vod = internal->dim_n_vod_1 * internal->dim_n_vod_2 * internal->dim_n_vod_3;
  internal->dim_n_vod_12 = internal->dim_n_vod_1 * internal->dim_n_vod_2;
  internal->dim_n_vos = internal->dim_n_vos_1 * internal->dim_n_vos_2 * internal->dim_n_vos_3;
  internal->dim_n_vos_12 = internal->dim_n_vos_1 * internal->dim_n_vos_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_S0 = internal->dim_S0_1 * internal->dim_S0_2;
  internal->dim_screened = internal->dim_screened_1 * internal->dim_screened_2;
  internal->dim_T = internal->dim_T_1 * internal->dim_T_2;
  internal->dim_T0 = internal->dim_T0_1 * internal->dim_T0_2;
  internal->dim_U = internal->dim_U_1 * internal->dim_U_2;
  internal->dim_u_d = internal->dim_u_d_1 * internal->dim_u_d_2 * internal->dim_u_d_3;
  internal->dim_u_d_12 = internal->dim_u_d_1 * internal->dim_u_d_2;
  internal->dim_u_s = internal->dim_u_s_1 * internal->dim_u_s_2 * internal->dim_u_s_3;
  internal->dim_u_s_12 = internal->dim_u_s_1 * internal->dim_u_s_2;
  internal->dim_U0 = internal->dim_U0_1 * internal->dim_U0_2;
  internal->dim_vbe = internal->dim_vbe_1 * internal->dim_vbe_2 * internal->dim_vbe_3;
  internal->dim_vbe_12 = internal->dim_vbe_1 * internal->dim_vbe_2;
  internal->dim_vod = internal->dim_vod_1 * internal->dim_vod_2 * internal->dim_vod_3;
  internal->dim_vod_12 = internal->dim_vod_1 * internal->dim_vod_2;
  internal->dim_vos = internal->dim_vos_1 * internal->dim_vos_2 * internal->dim_vos_3;
  internal->dim_vos_12 = internal->dim_vos_1 * internal->dim_vos_2;
  internal->dim_w = internal->dim_w_1 * internal->dim_w_2;
  internal->dim_wA = internal->dim_wA_1 * internal->dim_wA_2 * internal->dim_wA_3;
  internal->dim_wA_12 = internal->dim_wA_1 * internal->dim_wA_2;
  internal->dim_wd = internal->dim_wd_1 * internal->dim_wd_2;
  internal->dim_wdA = internal->dim_wdA_1 * internal->dim_wdA_2 * internal->dim_wdA_3;
  internal->dim_wdA_12 = internal->dim_wdA_1 * internal->dim_wdA_2;
  internal->dim_wdI = internal->dim_wdI_1 * internal->dim_wdI_2 * internal->dim_wdI_3;
  internal->dim_wdI_12 = internal->dim_wdI_1 * internal->dim_wdI_2;
  internal->dim_wdS = internal->dim_wdS_1 * internal->dim_wdS_2 * internal->dim_wdS_3;
  internal->dim_wdS_12 = internal->dim_wdS_1 * internal->dim_wdS_2;
  internal->dim_wdT = internal->dim_wdT_1 * internal->dim_wdT_2 * internal->dim_wdT_3;
  internal->dim_wdT_12 = internal->dim_wdT_1 * internal->dim_wdT_2;
  internal->dim_wdU = internal->dim_wdU_1 * internal->dim_wdU_2 * internal->dim_wdU_3;
  internal->dim_wdU_12 = internal->dim_wdU_1 * internal->dim_wdU_2;
  internal->dim_wI = internal->dim_wI_1 * internal->dim_wI_2 * internal->dim_wI_3;
  internal->dim_wI_12 = internal->dim_wI_1 * internal->dim_wI_2;
  internal->dim_wS = internal->dim_wS_1 * internal->dim_wS_2 * internal->dim_wS_3;
  internal->dim_wS_12 = internal->dim_wS_1 * internal->dim_wS_2;
  internal->dim_wT = internal->dim_wT_1 * internal->dim_wT_2 * internal->dim_wT_3;
  internal->dim_wT_12 = internal->dim_wT_1 * internal->dim_wT_2;
  internal->dim_wU = internal->dim_wU_1 * internal->dim_wU_2 * internal->dim_wU_3;
  internal->dim_wU_12 = internal->dim_wU_1 * internal->dim_wU_2;
  internal->p = (double*) user_get_array(user, false, internal->p, "p", NA_REAL, NA_REAL, 1, internal->dim_p);
  internal->q = (double*) user_get_array(user, false, internal->q, "q", NA_REAL, NA_REAL, 1, internal->dim_q);
  internal->vea = (double*) user_get_array(user, false, internal->vea, "vea", NA_REAL, NA_REAL, 1, internal->dim_vea);
  internal->ved = (double*) user_get_array(user, false, internal->ved, "ved", NA_REAL, NA_REAL, 1, internal->dim_ved);
  internal->vei = (double*) user_get_array(user, false, internal->vei, "vei", NA_REAL, NA_REAL, 1, internal->dim_vei);
  internal->ves = (double*) user_get_array(user, false, internal->ves, "ves", NA_REAL, NA_REAL, 1, internal->dim_ves);
  internal->willing = (double*) user_get_array(user, false, internal->willing, "willing", NA_REAL, NA_REAL, 1, internal->dim_willing);
  internal->A0 = (double*) user_get_array(user, false, internal->A0, "A0", NA_REAL, NA_REAL, 2, internal->dim_A0_1, internal->dim_A0_2);
  R_Free(internal->C);
  internal->C = (double*) R_Calloc(internal->dim_C, double);
  R_Free(internal->entrants);
  internal->entrants = (double*) R_Calloc(internal->dim_entrants, double);
  R_Free(internal->initial_A);
  internal->initial_A = (double*) R_Calloc(internal->dim_A, double);
  R_Free(internal->initial_cum_diag_a);
  internal->initial_cum_diag_a = (double*) R_Calloc(internal->dim_cum_diag_a, double);
  R_Free(internal->initial_cum_diag_s);
  internal->initial_cum_diag_s = (double*) R_Calloc(internal->dim_cum_diag_s, double);
  R_Free(internal->initial_cum_entrants);
  internal->initial_cum_entrants = (double*) R_Calloc(internal->dim_cum_entrants, double);
  R_Free(internal->initial_cum_incid);
  internal->initial_cum_incid = (double*) R_Calloc(internal->dim_cum_incid, double);
  R_Free(internal->initial_cum_offered);
  internal->initial_cum_offered = (double*) R_Calloc(internal->dim_cum_offered, double);
  R_Free(internal->initial_cum_offered_vbe);
  internal->initial_cum_offered_vbe = (double*) R_Calloc(internal->dim_cum_offered_vbe, double);
  R_Free(internal->initial_cum_screened);
  internal->initial_cum_screened = (double*) R_Calloc(internal->dim_cum_screened, double);
  R_Free(internal->initial_cum_treated);
  internal->initial_cum_treated = (double*) R_Calloc(internal->dim_cum_treated, double);
  R_Free(internal->initial_cum_vaccinated);
  internal->initial_cum_vaccinated = (double*) R_Calloc(internal->dim_cum_vaccinated, double);
  R_Free(internal->initial_cum_vaccinated_screen);
  internal->initial_cum_vaccinated_screen = (double*) R_Calloc(internal->dim_cum_vaccinated_screen, double);
  R_Free(internal->initial_cum_vbe);
  internal->initial_cum_vbe = (double*) R_Calloc(internal->dim_cum_vbe, double);
  R_Free(internal->initial_I);
  internal->initial_I = (double*) R_Calloc(internal->dim_I, double);
  R_Free(internal->initial_S);
  internal->initial_S = (double*) R_Calloc(internal->dim_S, double);
  R_Free(internal->initial_T);
  internal->initial_T = (double*) R_Calloc(internal->dim_T, double);
  R_Free(internal->initial_U);
  internal->initial_U = (double*) R_Calloc(internal->dim_U, double);
  R_Free(internal->N);
  internal->N = (double*) R_Calloc(internal->dim_N, double);
  R_Free(internal->n_AT);
  internal->n_AT = (double*) R_Calloc(internal->dim_n_AT, double);
  R_Free(internal->n_AU);
  internal->n_AU = (double*) R_Calloc(internal->dim_n_AU, double);
  R_Free(internal->n_diag_rec);
  internal->n_diag_rec = (double*) R_Calloc(internal->dim_n_diag_rec, double);
  R_Free(internal->n_obe);
  internal->n_obe = (double*) R_Calloc(internal->dim_n_obe, double);
  R_Free(internal->n_ood);
  internal->n_ood = (double*) R_Calloc(internal->dim_n_ood, double);
  R_Free(internal->n_oos);
  internal->n_oos = (double*) R_Calloc(internal->dim_n_oos, double);
  R_Free(internal->n_ST);
  internal->n_ST = (double*) R_Calloc(internal->dim_n_ST, double);
  R_Free(internal->n_TU);
  internal->n_TU = (double*) R_Calloc(internal->dim_n_TU, double);
  R_Free(internal->n_UI);
  internal->n_UI = (double*) R_Calloc(internal->dim_n_UI, double);
  R_Free(internal->n_vbe);
  internal->n_vbe = (double*) R_Calloc(internal->dim_n_vbe, double);
  R_Free(internal->n_vod);
  internal->n_vod = (double*) R_Calloc(internal->dim_n_vod, double);
  R_Free(internal->n_vos);
  internal->n_vos = (double*) R_Calloc(internal->dim_n_vos, double);
  R_Free(internal->screened);
  internal->screened = (double*) R_Calloc(internal->dim_screened, double);
  R_Free(internal->wA);
  internal->wA = (double*) R_Calloc(internal->dim_wA, double);
  R_Free(internal->wdA);
  internal->wdA = (double*) R_Calloc(internal->dim_wdA, double);
  R_Free(internal->wdI);
  internal->wdI = (double*) R_Calloc(internal->dim_wdI, double);
  R_Free(internal->wdS);
  internal->wdS = (double*) R_Calloc(internal->dim_wdS, double);
  R_Free(internal->wdT);
  internal->wdT = (double*) R_Calloc(internal->dim_wdT, double);
  R_Free(internal->wdU);
  internal->wdU = (double*) R_Calloc(internal->dim_wdU, double);
  R_Free(internal->wI);
  internal->wI = (double*) R_Calloc(internal->dim_wI, double);
  R_Free(internal->wS);
  internal->wS = (double*) R_Calloc(internal->dim_wS, double);
  R_Free(internal->wT);
  internal->wT = (double*) R_Calloc(internal->dim_wT, double);
  R_Free(internal->wU);
  internal->wU = (double*) R_Calloc(internal->dim_wU, double);
  internal->beta_t = (double*) user_get_array(user, false, internal->beta_t, "beta_t", NA_REAL, NA_REAL, 1, internal->dim_beta_t);
  internal->diag_rec = (double*) user_get_array(user, false, internal->diag_rec, "diag_rec", NA_REAL, NA_REAL, 3, internal->dim_diag_rec_1, internal->dim_diag_rec_2, internal->dim_diag_rec_3);
  internal->eta_h_t = (double*) user_get_array(user, false, internal->eta_h_t, "eta_h_t", NA_REAL, NA_REAL, 1, internal->dim_eta_h_t);
  internal->eta_l_t = (double*) user_get_array(user, false, internal->eta_l_t, "eta_l_t", NA_REAL, NA_REAL, 1, internal->dim_eta_l_t);
  internal->I0 = (double*) user_get_array(user, false, internal->I0, "I0", NA_REAL, NA_REAL, 2, internal->dim_I0_1, internal->dim_I0_2);
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      internal->initial_cum_diag_a[i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      internal->initial_cum_diag_s[i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_entrants_2; ++j) {
      internal->initial_cum_entrants[i - 1 + internal->dim_cum_entrants_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      internal->initial_cum_incid[i - 1 + internal->dim_cum_incid_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      internal->initial_cum_offered[i - 1 + internal->dim_cum_offered_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      internal->initial_cum_offered_vbe[i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      internal->initial_cum_screened[i - 1 + internal->dim_cum_screened_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      internal->initial_cum_treated[i - 1 + internal->dim_cum_treated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      internal->initial_cum_vaccinated[i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_screen_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_screen_2; ++j) {
      internal->initial_cum_vaccinated_screen[i - 1 + internal->dim_cum_vaccinated_screen_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      internal->initial_cum_vbe[i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = 0;
    }
  }
  internal->offset_variable_A = internal->dim_I + internal->dim_U;
  internal->offset_variable_cum_diag_a = internal->dim_A + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_diag_s = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_entrants = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_vbe + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_incid = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_offered_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_screened = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_treated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vaccinated_screen = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_cum_vbe = internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U;
  internal->offset_variable_S = internal->dim_A + internal->dim_I + internal->dim_U;
  internal->offset_variable_T = internal->dim_A + internal->dim_I + internal->dim_S + internal->dim_U;
  internal->S0 = (double*) user_get_array(user, false, internal->S0, "S0", NA_REAL, NA_REAL, 2, internal->dim_S0_1, internal->dim_S0_2);
  internal->T0 = (double*) user_get_array(user, false, internal->T0, "T0", NA_REAL, NA_REAL, 2, internal->dim_T0_1, internal->dim_T0_2);
  internal->u_d = (double*) user_get_array(user, false, internal->u_d, "u_d", NA_REAL, NA_REAL, 3, internal->dim_u_d_1, internal->dim_u_d_2, internal->dim_u_d_3);
  internal->u_s = (double*) user_get_array(user, false, internal->u_s, "u_s", NA_REAL, NA_REAL, 3, internal->dim_u_s_1, internal->dim_u_s_2, internal->dim_u_s_3);
  internal->U0 = (double*) user_get_array(user, false, internal->U0, "U0", NA_REAL, NA_REAL, 2, internal->dim_U0_1, internal->dim_U0_2);
  internal->vbe = (double*) user_get_array(user, false, internal->vbe, "vbe", NA_REAL, NA_REAL, 3, internal->dim_vbe_1, internal->dim_vbe_2, internal->dim_vbe_3);
  internal->vod = (double*) user_get_array(user, false, internal->vod, "vod", NA_REAL, NA_REAL, 3, internal->dim_vod_1, internal->dim_vod_2, internal->dim_vod_3);
  internal->vos = (double*) user_get_array(user, false, internal->vos, "vos", NA_REAL, NA_REAL, 3, internal->dim_vos_1, internal->dim_vos_2, internal->dim_vos_3);
  internal->w = (double*) user_get_array(user, false, internal->w, "w", NA_REAL, NA_REAL, 2, internal->dim_w_1, internal->dim_w_2);
  internal->wd = (double*) user_get_array(user, false, internal->wd, "wd", NA_REAL, NA_REAL, 2, internal->dim_wd_1, internal->dim_wd_2);
  for (int i = 1; i <= internal->dim_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_entrants_2; ++j) {
      internal->entrants[i - 1 + internal->dim_entrants_1 * (j - 1)] = internal->enr * internal->q[i - 1] * internal->willing[j - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      internal->initial_A[i - 1 + internal->dim_A_1 * (j - 1)] = internal->A0[internal->dim_A0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      internal->initial_I[i - 1 + internal->dim_I_1 * (j - 1)] = internal->I0[internal->dim_I0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1)] = internal->S0[internal->dim_S0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      internal->initial_T[i - 1 + internal->dim_T_1 * (j - 1)] = internal->T0[internal->dim_T0_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      internal->initial_U[i - 1 + internal->dim_U_1 * (j - 1)] = internal->U0[internal->dim_U0_1 * (j - 1) + i - 1];
    }
  }
  interpolate_check_y(internal->dim_tt, internal->dim_beta_t, 0, "beta_t", "beta");
  cinterpolate_free(internal->interpolate_beta);
  internal->interpolate_beta = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->beta_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_h_t, 0, "eta_h_t", "eta_h");
  cinterpolate_free(internal->interpolate_eta_h);
  internal->interpolate_eta_h = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_h_t, true, false);
  interpolate_check_y(internal->dim_tt, internal->dim_eta_l_t, 0, "eta_l_t", "eta_l");
  cinterpolate_free(internal->interpolate_eta_l);
  internal->interpolate_eta_l = cinterpolate_alloc("linear", internal->dim_tt, 1, internal->tt, internal->eta_l_t, true, false);
  for (int i = 1; i <= internal->dim_n_obe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_obe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_obe_3; ++k) {
        internal->n_obe[i - 1 + internal->dim_n_obe_1 * (j - 1) + internal->dim_n_obe_12 * (k - 1)] = internal->vbe[internal->dim_vbe_12 * (k - 1) + internal->dim_vbe_1 * (j - 1) + i - 1] * internal->entrants[internal->dim_entrants_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vbe_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vbe_3; ++k) {
        internal->n_vbe[i - 1 + internal->dim_n_vbe_1 * (j - 1) + internal->dim_n_vbe_12 * (k - 1)] = internal->n_obe[internal->dim_n_obe_12 * (k - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1] * internal->u_vbe;
      }
    }
  }
  return R_NilValue;
}
SEXP model_withoutPN_set_initial(SEXP internal_p, SEXP t_ptr, SEXP state_ptr, SEXP model_withoutPN_use_dde_ptr) {
  return R_NilValue;
}
SEXP model_withoutPN_metadata(SEXP internal_p) {
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 16));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 16));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, allocVector(INTSXP, 2));
  int * dim_U = INTEGER(VECTOR_ELT(variable_length, 0));
  dim_U[0] = internal->dim_U_1;
  dim_U[1] = internal->dim_U_2;
  SET_VECTOR_ELT(variable_length, 1, allocVector(INTSXP, 2));
  int * dim_I = INTEGER(VECTOR_ELT(variable_length, 1));
  dim_I[0] = internal->dim_I_1;
  dim_I[1] = internal->dim_I_2;
  SET_VECTOR_ELT(variable_length, 2, allocVector(INTSXP, 2));
  int * dim_A = INTEGER(VECTOR_ELT(variable_length, 2));
  dim_A[0] = internal->dim_A_1;
  dim_A[1] = internal->dim_A_2;
  SET_VECTOR_ELT(variable_length, 3, allocVector(INTSXP, 2));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 3));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  SET_VECTOR_ELT(variable_length, 4, allocVector(INTSXP, 2));
  int * dim_T = INTEGER(VECTOR_ELT(variable_length, 4));
  dim_T[0] = internal->dim_T_1;
  dim_T[1] = internal->dim_T_2;
  SET_VECTOR_ELT(variable_length, 5, allocVector(INTSXP, 2));
  int * dim_cum_incid = INTEGER(VECTOR_ELT(variable_length, 5));
  dim_cum_incid[0] = internal->dim_cum_incid_1;
  dim_cum_incid[1] = internal->dim_cum_incid_2;
  SET_VECTOR_ELT(variable_length, 6, allocVector(INTSXP, 2));
  int * dim_cum_diag_a = INTEGER(VECTOR_ELT(variable_length, 6));
  dim_cum_diag_a[0] = internal->dim_cum_diag_a_1;
  dim_cum_diag_a[1] = internal->dim_cum_diag_a_2;
  SET_VECTOR_ELT(variable_length, 7, allocVector(INTSXP, 2));
  int * dim_cum_diag_s = INTEGER(VECTOR_ELT(variable_length, 7));
  dim_cum_diag_s[0] = internal->dim_cum_diag_s_1;
  dim_cum_diag_s[1] = internal->dim_cum_diag_s_2;
  SET_VECTOR_ELT(variable_length, 8, allocVector(INTSXP, 2));
  int * dim_cum_treated = INTEGER(VECTOR_ELT(variable_length, 8));
  dim_cum_treated[0] = internal->dim_cum_treated_1;
  dim_cum_treated[1] = internal->dim_cum_treated_2;
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 2));
  int * dim_cum_screened = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_cum_screened[0] = internal->dim_cum_screened_1;
  dim_cum_screened[1] = internal->dim_cum_screened_2;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 2));
  int * dim_cum_offered = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_cum_offered[0] = internal->dim_cum_offered_1;
  dim_cum_offered[1] = internal->dim_cum_offered_2;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_cum_vaccinated[0] = internal->dim_cum_vaccinated_1;
  dim_cum_vaccinated[1] = internal->dim_cum_vaccinated_2;
  SET_VECTOR_ELT(variable_length, 12, allocVector(INTSXP, 2));
  int * dim_cum_vaccinated_screen = INTEGER(VECTOR_ELT(variable_length, 12));
  dim_cum_vaccinated_screen[0] = internal->dim_cum_vaccinated_screen_1;
  dim_cum_vaccinated_screen[1] = internal->dim_cum_vaccinated_screen_2;
  SET_VECTOR_ELT(variable_length, 13, allocVector(INTSXP, 2));
  int * dim_cum_vbe = INTEGER(VECTOR_ELT(variable_length, 13));
  dim_cum_vbe[0] = internal->dim_cum_vbe_1;
  dim_cum_vbe[1] = internal->dim_cum_vbe_2;
  SET_VECTOR_ELT(variable_length, 14, allocVector(INTSXP, 2));
  int * dim_cum_offered_vbe = INTEGER(VECTOR_ELT(variable_length, 14));
  dim_cum_offered_vbe[0] = internal->dim_cum_offered_vbe_1;
  dim_cum_offered_vbe[1] = internal->dim_cum_offered_vbe_2;
  SET_VECTOR_ELT(variable_length, 15, allocVector(INTSXP, 2));
  int * dim_cum_entrants = INTEGER(VECTOR_ELT(variable_length, 15));
  dim_cum_entrants[0] = internal->dim_cum_entrants_1;
  dim_cum_entrants[1] = internal->dim_cum_entrants_2;
  SET_STRING_ELT(variable_names, 0, mkChar("U"));
  SET_STRING_ELT(variable_names, 1, mkChar("I"));
  SET_STRING_ELT(variable_names, 2, mkChar("A"));
  SET_STRING_ELT(variable_names, 3, mkChar("S"));
  SET_STRING_ELT(variable_names, 4, mkChar("T"));
  SET_STRING_ELT(variable_names, 5, mkChar("cum_incid"));
  SET_STRING_ELT(variable_names, 6, mkChar("cum_diag_a"));
  SET_STRING_ELT(variable_names, 7, mkChar("cum_diag_s"));
  SET_STRING_ELT(variable_names, 8, mkChar("cum_treated"));
  SET_STRING_ELT(variable_names, 9, mkChar("cum_screened"));
  SET_STRING_ELT(variable_names, 10, mkChar("cum_offered"));
  SET_STRING_ELT(variable_names, 11, mkChar("cum_vaccinated"));
  SET_STRING_ELT(variable_names, 12, mkChar("cum_vaccinated_screen"));
  SET_STRING_ELT(variable_names, 13, mkChar("cum_vbe"));
  SET_STRING_ELT(variable_names, 14, mkChar("cum_offered_vbe"));
  SET_STRING_ELT(variable_names, 15, mkChar("cum_entrants"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 6));
  SEXP output_names = PROTECT(allocVector(STRSXP, 6));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, R_NilValue);
  SET_VECTOR_ELT(output_length, 3, ScalarInteger(internal->dim_eta));
  SET_VECTOR_ELT(output_length, 4, ScalarInteger(internal->dim_lambda));
  SET_VECTOR_ELT(output_length, 5, allocVector(INTSXP, 2));
  int * dim_N = INTEGER(VECTOR_ELT(output_length, 5));
  dim_N[0] = internal->dim_N_1;
  dim_N[1] = internal->dim_N_2;
  SET_STRING_ELT(output_names, 0, mkChar("tot_treated"));
  SET_STRING_ELT(output_names, 1, mkChar("tot_attended"));
  SET_STRING_ELT(output_names, 2, mkChar("beta"));
  SET_STRING_ELT(output_names, 3, mkChar("eta"));
  SET_STRING_ELT(output_names, 4, mkChar("lambda"));
  SET_STRING_ELT(output_names, 5, mkChar("N"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(internal->dim_eta + internal->dim_lambda + internal->dim_N + 3));
  SEXP interpolate_t = PROTECT(allocVector(VECSXP, 3));
  SEXP interpolate_t_nms = PROTECT(allocVector(STRSXP, 3));
  setAttrib(interpolate_t, R_NamesSymbol, interpolate_t_nms);
  SET_VECTOR_ELT(interpolate_t, 0, ScalarReal(fmax(internal->tt[0], internal->vax_t[0])));
  SET_VECTOR_ELT(interpolate_t, 1, ScalarReal(internal->tt[internal->dim_tt - 1]));
  SET_STRING_ELT(interpolate_t_nms, 0, mkChar("min"));
  SET_STRING_ELT(interpolate_t_nms, 1, mkChar("max"));
  SET_VECTOR_ELT(ret, 3, interpolate_t);
  UNPROTECT(2);
  UNPROTECT(2);
  return ret;
}
SEXP model_withoutPN_initial_conditions(SEXP internal_p, SEXP t_ptr) {
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 1);
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_A + internal->dim_cum_diag_a + internal->dim_cum_diag_s + internal->dim_cum_entrants + internal->dim_cum_incid + internal->dim_cum_offered + internal->dim_cum_offered_vbe + internal->dim_cum_screened + internal->dim_cum_treated + internal->dim_cum_vaccinated + internal->dim_cum_vaccinated_screen + internal->dim_cum_vbe + internal->dim_I + internal->dim_S + internal->dim_T + internal->dim_U));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_U, internal->dim_U * sizeof(double));
  memcpy(state + internal->dim_U, internal->initial_I, internal->dim_I * sizeof(double));
  memcpy(state + internal->offset_variable_A, internal->initial_A, internal->dim_A * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_T, internal->initial_T, internal->dim_T * sizeof(double));
  memcpy(state + internal->offset_variable_cum_incid, internal->initial_cum_incid, internal->dim_cum_incid * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_a, internal->initial_cum_diag_a, internal->dim_cum_diag_a * sizeof(double));
  memcpy(state + internal->offset_variable_cum_diag_s, internal->initial_cum_diag_s, internal->dim_cum_diag_s * sizeof(double));
  memcpy(state + internal->offset_variable_cum_treated, internal->initial_cum_treated, internal->dim_cum_treated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_screened, internal->initial_cum_screened, internal->dim_cum_screened * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered, internal->initial_cum_offered, internal->dim_cum_offered * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated, internal->initial_cum_vaccinated, internal->dim_cum_vaccinated * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vaccinated_screen, internal->initial_cum_vaccinated_screen, internal->dim_cum_vaccinated_screen * sizeof(double));
  memcpy(state + internal->offset_variable_cum_vbe, internal->initial_cum_vbe, internal->dim_cum_vbe * sizeof(double));
  memcpy(state + internal->offset_variable_cum_offered_vbe, internal->initial_cum_offered_vbe, internal->dim_cum_offered_vbe * sizeof(double));
  memcpy(state + internal->offset_variable_cum_entrants, internal->initial_cum_entrants, internal->dim_cum_entrants * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void model_withoutPN_rhs(model_withoutPN_internal* internal, double t, double * state, double * dstatedt, double * output) {
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double vax_switch = 0.0;
  cinterpolate_eval(t, internal->interpolate_vax_switch, &vax_switch);
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_AU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AU_2; ++j) {
      internal->n_AU[i - 1 + internal->dim_n_AU_1 * (j - 1)] = internal->nu / (double) (1 - internal->ved[j - 1]) * A[internal->dim_A_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_ST_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ST_2; ++j) {
      internal->n_ST[i - 1 + internal->dim_n_ST_1 * (j - 1)] = internal->mu * S[internal->dim_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_n_TU_1; ++i) {
    for (int j = 1; j <= internal->dim_n_TU_2; ++j) {
      internal->n_TU[i - 1 + internal->dim_n_TU_1 * (j - 1)] = internal->rho * T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_wA_1; ++i) {
    for (int j = 1; j <= internal->dim_wA_2; ++j) {
      for (int k = 1; k <= internal->dim_wA_3; ++k) {
        internal->wA[i - 1 + internal->dim_wA_1 * (j - 1) + internal->dim_wA_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdA_1; ++i) {
    for (int j = 1; j <= internal->dim_wdA_2; ++j) {
      for (int k = 1; k <= internal->dim_wdA_3; ++k) {
        internal->wdA[i - 1 + internal->dim_wdA_1 * (j - 1) + internal->dim_wdA_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * A[internal->dim_A_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdI_1; ++i) {
    for (int j = 1; j <= internal->dim_wdI_2; ++j) {
      for (int k = 1; k <= internal->dim_wdI_3; ++k) {
        internal->wdI[i - 1 + internal->dim_wdI_1 * (j - 1) + internal->dim_wdI_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdS_1; ++i) {
    for (int j = 1; j <= internal->dim_wdS_2; ++j) {
      for (int k = 1; k <= internal->dim_wdS_3; ++k) {
        internal->wdS[i - 1 + internal->dim_wdS_1 * (j - 1) + internal->dim_wdS_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdT_1; ++i) {
    for (int j = 1; j <= internal->dim_wdT_2; ++j) {
      for (int k = 1; k <= internal->dim_wdT_3; ++k) {
        internal->wdT[i - 1 + internal->dim_wdT_1 * (j - 1) + internal->dim_wdT_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wdU_1; ++i) {
    for (int j = 1; j <= internal->dim_wdU_2; ++j) {
      for (int k = 1; k <= internal->dim_wdU_3; ++k) {
        internal->wdU[i - 1 + internal->dim_wdU_1 * (j - 1) + internal->dim_wdU_12 * (k - 1)] = internal->wd[internal->dim_wd_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wI_1; ++i) {
    for (int j = 1; j <= internal->dim_wI_2; ++j) {
      for (int k = 1; k <= internal->dim_wI_3; ++k) {
        internal->wI[i - 1 + internal->dim_wI_1 * (j - 1) + internal->dim_wI_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * I[internal->dim_I_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wS_1; ++i) {
    for (int j = 1; j <= internal->dim_wS_2; ++j) {
      for (int k = 1; k <= internal->dim_wS_3; ++k) {
        internal->wS[i - 1 + internal->dim_wS_1 * (j - 1) + internal->dim_wS_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * S[internal->dim_S_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wT_1; ++i) {
    for (int j = 1; j <= internal->dim_wT_2; ++j) {
      for (int k = 1; k <= internal->dim_wT_3; ++k) {
        internal->wT[i - 1 + internal->dim_wT_1 * (j - 1) + internal->dim_wT_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * T[internal->dim_T_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_wU_1; ++i) {
    for (int j = 1; j <= internal->dim_wU_2; ++j) {
      for (int k = 1; k <= internal->dim_wU_3; ++k) {
        internal->wU[i - 1 + internal->dim_wU_1 * (j - 1) + internal->dim_wU_12 * (k - 1)] = internal->w[internal->dim_w_1 * (k - 1) + j - 1] * U[internal->dim_U_1 * (k - 1) + i - 1];
      }
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  for (int i = 1; i <= internal->dim_cum_diag_s_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_s_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_s + i - 1 + internal->dim_cum_diag_s_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_entrants_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_entrants_2; ++j) {
      dstatedt[internal->offset_variable_cum_entrants + i - 1 + internal->dim_cum_entrants_1 * (j - 1)] = internal->entrants[internal->dim_entrants_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_treated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_treated_2; ++j) {
      dstatedt[internal->offset_variable_cum_treated + i - 1 + internal->dim_cum_treated_1 * (j - 1)] = internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      dstatedt[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1)] = (1 - internal->ves[j - 1]) * internal->psi * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] - internal->exr * S[internal->dim_S_1 * (j - 1) + i - 1] + odin_sum3(internal->wS, i - 1, i, j - 1, j, 0, internal->dim_wS_3, internal->dim_wS_1, internal->dim_wS_12) + odin_sum3(internal->wdS, i - 1, i, j - 1, j, 0, internal->dim_wdS_3, internal->dim_wdS_1, internal->dim_wdS_12);
    }
  }
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_n_diag_rec_1; ++i) {
    for (int j = 1; j <= internal->dim_n_diag_rec_2; ++j) {
      for (int k = 1; k <= internal->dim_n_diag_rec_3; ++k) {
        internal->n_diag_rec[i - 1 + internal->dim_n_diag_rec_1 * (j - 1) + internal->dim_n_diag_rec_12 * (k - 1)] = internal->diag_rec[internal->dim_diag_rec_12 * (k - 1) + internal->dim_diag_rec_1 * (j - 1) + i - 1] * internal->n_TU[internal->dim_n_TU_1 * (k - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_ood_1; ++i) {
    for (int j = 1; j <= internal->dim_n_ood_2; ++j) {
      for (int k = 1; k <= internal->dim_n_ood_3; ++k) {
        internal->n_ood[i - 1 + internal->dim_n_ood_1 * (j - 1) + internal->dim_n_ood_12 * (k - 1)] = internal->vod[internal->dim_vod_12 * (k - 1) + internal->dim_vod_1 * (j - 1) + i - 1] * internal->n_TU[internal->dim_n_TU_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  for (int i = 1; i <= internal->dim_cum_offered_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered_vbe + i - 1 + internal->dim_cum_offered_vbe_1 * (j - 1)] = internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1];
    }
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  for (int i = 1; i <= internal->dim_n_vod_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vod_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vod_3; ++k) {
        internal->n_vod[i - 1 + internal->dim_n_vod_1 * (j - 1) + internal->dim_n_vod_12 * (k - 1)] = internal->n_ood[internal->dim_n_ood_12 * (k - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] * internal->u_d[internal->dim_u_d_12 * (k - 1) + internal->dim_u_d_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_vbe_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vbe_2; ++j) {
      dstatedt[internal->offset_variable_cum_vbe + i - 1 + internal->dim_cum_vbe_1 * (j - 1)] = internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_lambda; ++i) {
    internal->lambda[i - 1] = internal->p[i - 1] * beta * (internal->epsilon * internal->prop_C[i - 1] + (1 - internal->epsilon) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
  }
  for (int i = 1; i <= internal->dim_n_AT_1; ++i) {
    for (int j = 1; j <= internal->dim_n_AT_2; ++j) {
      internal->n_AT[i - 1 + internal->dim_n_AT_1 * (j - 1)] = internal->eta[i - 1] * A[internal->dim_A_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_screened_2; ++j) {
      internal->screened[i - 1 + internal->dim_screened_1 * (j - 1)] = internal->eta[i - 1] * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_A_1; ++i) {
    for (int j = 1; j <= internal->dim_A_2; ++j) {
      dstatedt[internal->offset_variable_A + i - 1 + internal->dim_A_1 * (j - 1)] = (1 - (1 - internal->ves[j - 1]) * internal->psi) * internal->sigma * I[internal->dim_I_1 * (j - 1) + i - 1] - internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] - internal->exr * A[internal->dim_A_1 * (j - 1) + i - 1] + odin_sum3(internal->wA, i - 1, i, j - 1, j, 0, internal->dim_wA_3, internal->dim_wA_1, internal->dim_wA_12) + odin_sum3(internal->wdA, i - 1, i, j - 1, j, 0, internal->dim_wdA_3, internal->dim_wdA_1, internal->dim_wdA_12);
    }
  }
  for (int i = 1; i <= internal->dim_cum_diag_a_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_diag_a_2; ++j) {
      dstatedt[internal->offset_variable_cum_diag_a + i - 1 + internal->dim_cum_diag_a_1 * (j - 1)] = internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_screened_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_screened_2; ++j) {
      dstatedt[internal->offset_variable_cum_screened + i - 1 + internal->dim_cum_screened_1 * (j - 1)] = internal->screened[internal->dim_screened_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_T_1; ++i) {
    for (int j = 1; j <= internal->dim_T_2; ++j) {
      dstatedt[internal->offset_variable_T + i - 1 + internal->dim_T_1 * (j - 1)] = internal->n_ST[internal->dim_n_ST_1 * (j - 1) + i - 1] + internal->n_AT[internal->dim_n_AT_1 * (j - 1) + i - 1] - internal->exr * T[internal->dim_T_1 * (j - 1) + i - 1] - internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] + odin_sum3(internal->wT, i - 1, i, j - 1, j, 0, internal->dim_wT_3, internal->dim_wT_1, internal->dim_wT_12) + odin_sum3(internal->wdT, i - 1, i, j - 1, j, 0, internal->dim_wdT_3, internal->dim_wdT_1, internal->dim_wdT_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_oos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_oos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_oos_3; ++k) {
        internal->n_oos[i - 1 + internal->dim_n_oos_1 * (j - 1) + internal->dim_n_oos_12 * (k - 1)] = internal->vos[internal->dim_vos_12 * (k - 1) + internal->dim_vos_1 * (j - 1) + i - 1] * internal->screened[internal->dim_screened_1 * (k - 1) + i - 1] * vax_switch;
      }
    }
  }
  for (int i = 1; i <= internal->dim_n_UI_1; ++i) {
    for (int j = 1; j <= internal->dim_n_UI_2; ++j) {
      internal->n_UI[i - 1 + internal->dim_n_UI_1 * (j - 1)] = internal->lambda[i - 1] * (1 - internal->vea[j - 1]) * U[internal->dim_U_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_incid_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_incid_2; ++j) {
      dstatedt[internal->offset_variable_cum_incid + i - 1 + internal->dim_cum_incid_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_offered_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_offered_2; ++j) {
      dstatedt[internal->offset_variable_cum_offered + i - 1 + internal->dim_cum_offered_1 * (j - 1)] = internal->n_oos[internal->dim_n_oos_12 * (j - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] + internal->n_ood[internal->dim_n_ood_12 * (j - 1) + internal->dim_n_ood_1 * (j - 1) + i - 1] + internal->n_obe[internal->dim_n_obe_12 * (j - 1) + internal->dim_n_obe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_I_1; ++i) {
    for (int j = 1; j <= internal->dim_I_2; ++j) {
      dstatedt[internal->dim_U + i - 1 + internal->dim_I_1 * (j - 1)] = internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - (internal->sigma + internal->exr) * I[internal->dim_I_1 * (j - 1) + i - 1] + odin_sum3(internal->wI, i - 1, i, j - 1, j, 0, internal->dim_wI_3, internal->dim_wI_1, internal->dim_wI_12) + odin_sum3(internal->wdI, i - 1, i, j - 1, j, 0, internal->dim_wdI_3, internal->dim_wdI_1, internal->dim_wdI_12);
    }
  }
  for (int i = 1; i <= internal->dim_n_vos_1; ++i) {
    for (int j = 1; j <= internal->dim_n_vos_2; ++j) {
      for (int k = 1; k <= internal->dim_n_vos_3; ++k) {
        internal->n_vos[i - 1 + internal->dim_n_vos_1 * (j - 1) + internal->dim_n_vos_12 * (k - 1)] = internal->n_oos[internal->dim_n_oos_12 * (k - 1) + internal->dim_n_oos_1 * (j - 1) + i - 1] * internal->u_s[internal->dim_u_s_12 * (k - 1) + internal->dim_u_s_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated + i - 1 + internal->dim_cum_vaccinated_1 * (j - 1)] = internal->n_vos[internal->dim_n_vos_12 * (j - 1) + internal->dim_n_vos_1 * (j - 1) + i - 1] + internal->n_vod[internal->dim_n_vod_12 * (j - 1) + internal->dim_n_vod_1 * (j - 1) + i - 1] + internal->n_vbe[internal->dim_n_vbe_12 * (j - 1) + internal->dim_n_vbe_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_cum_vaccinated_screen_1; ++i) {
    for (int j = 1; j <= internal->dim_cum_vaccinated_screen_2; ++j) {
      dstatedt[internal->offset_variable_cum_vaccinated_screen + i - 1 + internal->dim_cum_vaccinated_screen_1 * (j - 1)] = internal->n_vos[internal->dim_n_vos_12 * (j - 1) + internal->dim_n_vos_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_U_1; ++i) {
    for (int j = 1; j <= internal->dim_U_2; ++j) {
      dstatedt[0 + i - 1 + internal->dim_U_1 * (j - 1)] = internal->entrants[internal->dim_entrants_1 * (j - 1) + i - 1] - internal->n_UI[internal->dim_n_UI_1 * (j - 1) + i - 1] - internal->exr * U[internal->dim_U_1 * (j - 1) + i - 1] + internal->n_AU[internal->dim_n_AU_1 * (j - 1) + i - 1] + internal->n_TU[internal->dim_n_TU_1 * (j - 1) + i - 1] - odin_sum3(internal->n_diag_rec, i - 1, i, j - 1, j, 0, internal->dim_n_diag_rec_3, internal->dim_n_diag_rec_1, internal->dim_n_diag_rec_12) + odin_sum3(internal->wU, i - 1, i, j - 1, j, 0, internal->dim_wU_3, internal->dim_wU_1, internal->dim_wU_12) - odin_sum3(internal->n_vbe, i - 1, i, j - 1, j, 0, internal->dim_n_vbe_3, internal->dim_n_vbe_1, internal->dim_n_vbe_12) - odin_sum3(internal->n_vod, i - 1, i, j - 1, j, 0, internal->dim_n_vod_3, internal->dim_n_vod_1, internal->dim_n_vod_12) - odin_sum3(internal->n_vos, i - 1, i, j - 1, j, 0, internal->dim_n_vos_3, internal->dim_n_vos_1, internal->dim_n_vos_12) + odin_sum3(internal->wdU, i - 1, i, j - 1, j, 0, internal->dim_wdU_3, internal->dim_wdU_1, internal->dim_wdU_12);
    }
  }
  if (output) {
    double * cum_treated = state + internal->offset_variable_cum_treated;
    double * cum_screened = state + internal->offset_variable_cum_screened;
    output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
    output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
    memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
    output[2] = beta;
    memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
    memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
  }
}
void model_withoutPN_rhs_dde(size_t neq, double t, double * state, double * dstatedt, void * internal) {
  model_withoutPN_rhs((model_withoutPN_internal*)internal, t, state, dstatedt, NULL);
}
void model_withoutPN_rhs_desolve(int * neq, double * t, double * state, double * dstatedt, double * output, int * np) {
  model_withoutPN_rhs(model_withoutPN_internal_ds, *t, state, dstatedt, output);
}
void model_withoutPN_output_dde(size_t n_eq, double t, double * state, size_t n_output, double * output, void * internal_p) {
  model_withoutPN_internal *internal = (model_withoutPN_internal*) internal_p;
  double * U = state + 0;
  double * I = state + internal->dim_U;
  double * A = state + internal->offset_variable_A;
  double * S = state + internal->offset_variable_S;
  double * T = state + internal->offset_variable_T;
  double * cum_treated = state + internal->offset_variable_cum_treated;
  double * cum_screened = state + internal->offset_variable_cum_screened;
  output[1] = odin_sum1(cum_treated, 0, internal->dim_cum_treated) + odin_sum1(cum_screened, 0, internal->dim_cum_screened);
  output[0] = odin_sum1(cum_treated, 0, internal->dim_cum_treated);
  for (int i = 1; i <= internal->dim_C_1; ++i) {
    for (int j = 1; j <= internal->dim_C_2; ++j) {
      internal->C[i - 1 + internal->dim_C_1 * (j - 1)] = (1 - internal->vei[j - 1]) * (I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_N_1; ++i) {
    for (int j = 1; j <= internal->dim_N_2; ++j) {
      internal->N[i - 1 + internal->dim_N_1 * (j - 1)] = U[internal->dim_U_1 * (j - 1) + i - 1] + I[internal->dim_I_1 * (j - 1) + i - 1] + A[internal->dim_A_1 * (j - 1) + i - 1] + S[internal->dim_S_1 * (j - 1) + i - 1] + T[internal->dim_T_1 * (j - 1) + i - 1];
    }
  }
  double beta = 0.0;
  cinterpolate_eval(t, internal->interpolate_beta, &beta);
  double eta_h = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_h, &eta_h);
  double eta_l = 0.0;
  cinterpolate_eval(t, internal->interpolate_eta_l, &eta_l);
  for (int i = 1; i <= internal->dim_Np; ++i) {
    internal->Np[i - 1] = odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1) * internal->p[i - 1];
  }
  memcpy(output + internal->offset_output_N, internal->N, internal->dim_N * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_C; ++i) {
    internal->prop_C[i - 1] = odin_sum2(internal->C, i - 1, i, 0, internal->dim_C_2, internal->dim_C_1) / (double) odin_sum2(internal->N, i - 1, i, 0, internal->dim_N_2, internal->dim_N_1);
  }
  {
     int i = 1;
     internal->eta[i - 1] = eta_l;
  }
  {
     int i = 2;
     internal->eta[i - 1] = eta_h;
  }
  for (int i = 1; i <= internal->dim_foi_LH; ++i) {
    internal->foi_LH[i - 1] = internal->prop_C[i - 1] * internal->Np[i - 1] / (double) odin_sum1(internal->Np, 0, internal->dim_Np);
  }
  output[2] = beta;
  for (int i = 1; i <= internal->dim_lambda; ++i) {
    internal->lambda[i - 1] = internal->p[i - 1] * beta * (internal->epsilon * internal->prop_C[i - 1] + (1 - internal->epsilon) * odin_sum1(internal->foi_LH, 0, internal->dim_foi_LH));
  }
  memcpy(output + 3, internal->eta, internal->dim_eta * sizeof(double));
  memcpy(output + internal->offset_output_lambda, internal->lambda, internal->dim_lambda * sizeof(double));
}
SEXP model_withoutPN_rhs_r(SEXP internal_p, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  model_withoutPN_internal *internal = model_withoutPN_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, internal->dim_eta + internal->dim_lambda + internal->dim_N + 3));
  setAttrib(dstatedt, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  model_withoutPN_rhs(internal, scalar_real(t, "t"), REAL(state), REAL(dstatedt), output);
  UNPROTECT(1);
  return dstatedt;
}
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max) {
  double ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected a scalar numeric for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_double(&ret, 1, min, max, name);
  return ret;
}
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max) {
  int ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      double tmp = REAL(el)[0];
      if (fabs(tmp - round(tmp)) > 2e-8) {
        Rf_error("Expected '%s' to be integer-like", name);
      }
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_int(&ret, 1, min, max, name);
  return ret;
}
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values(SEXP value, double min, double max,
                           const char *name) {
  size_t len = (size_t)length(value);
  if (TYPEOF(value) == INTSXP) {
    user_check_values_int(INTEGER(value), len, min, max, name);
  } else {
    user_check_values_double(REAL(value), len, min, max, name);
  }
}
SEXP user_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if (strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
void odin_set_dim(SEXP target, int rank, ...) {
  SEXP r_dim = PROTECT(allocVector(INTSXP, rank));
  int *dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t)rank; ++i) {
    dim[i] = va_arg(ap, int);
  }
  va_end(ap);

  setAttrib(target, R_DimSymbol, r_dim);
  UNPROTECT(1);
}
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  dest_dim[0] = LENGTH(el);
  if (rank > 1) {
    SEXP r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
    int *dim = INTEGER(r_dim);

    for (size_t i = 0; i < (size_t) rank; ++i) {
      dest_dim[i + 1] = dim[i];
    }

    UNPROTECT(1);
  }

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  int len = LENGTH(el);
  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  SEXP r_dim;
  int *dim;

  size_t len = LENGTH(el);
  if (rank == 1) {
    r_dim = PROTECT(ScalarInteger(len));
  } else {
    r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
  }
  dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t) rank; ++i) {
    int dim_expected = va_arg(ap, int);
    if (dim[i] != dim_expected) {
      va_end(ap); // avoid a leak
      if (rank == 1) {
        Rf_error("Expected length %d value for '%s'", dim_expected, name);
      } else {
        Rf_error("Incorrect size of dimension %d of '%s' (expected %d)",
                 (int)i + 1, name, dim_expected);
      }
    }
  }
  va_end(ap);
  UNPROTECT(1);

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  void *dest = NULL;
  if (is_integer) {
    dest = R_Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = R_Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  R_Free(previous);

  UNPROTECT(1);

  return dest;
}
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max) {
  size_t len = (size_t) length(el);
  if (is_integer) {
    if (TYPEOF(el) == INTSXP) {
      user_check_values_int(INTEGER(el), len, min, max, name);
    } else if (TYPEOF(el) == REALSXP) {
      el = PROTECT(coerceVector(el, INTSXP));
      user_check_values_int(INTEGER(el), len, min, max, name);
      UNPROTECT(1);
    } else {
      Rf_error("Expected a integer value for '%s'", name);
    }
  } else {
    if (TYPEOF(el) == INTSXP) {
      el = PROTECT(coerceVector(el, REALSXP));
      user_check_values_double(REAL(el), len, min, max, name);
      UNPROTECT(1);
    } else if (TYPEOF(el) == REALSXP) {
      user_check_values_double(REAL(el), len, min, max, name);
    } else {
      Rf_error("Expected a numeric value for '%s'", name);
    }
  }
  return el;
}
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required) {
  SEXP el = user_list_element(user, name);
  if (el == R_NilValue) {
    if (required) {
      Rf_error("Expected a value for '%s'", name);
    }
  } else {
    if (rank == 1) {
      if (isArray(el)) {
        Rf_error("Expected a numeric vector for '%s'", name);
      }
    } else {
      SEXP r_dim = getAttrib(el, R_DimSymbol);
      if (r_dim == R_NilValue || LENGTH(r_dim) != rank) {
        if (rank == 2) {
          Rf_error("Expected a numeric matrix for '%s'", name);
        } else {
          Rf_error("Expected a numeric array of rank %d for '%s'", rank, name);
        }
      }
    }
  }
  return el;
}
void interpolate_check_y(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target) {
  if (nx != ny) {
    if (i == 0) {
      // vector case
      Rf_error("Expected %s to have length %d (for '%s')",
               name_arg, (int)nx, name_target);
    } else {
      // array case
      Rf_error("Expected dimension %d of %s to have size %d (for '%s')",
               (int)i, name_arg, (int)nx, name_target);
    }
  }
}
double odin_sum1(double *x, size_t from, size_t to) {
  double tot = 0.0;
  for (size_t i = from; i < to; ++i) {
    tot += x[i];
  }
  return tot;
}
int odin_isum1(int *x, size_t from, size_t to) {
  int tot = 0.0;
  for (size_t i = from; i < to; ++i) {
    tot += x[i];
  }
  return tot;
}
double scalar_real(SEXP x, const char * name) {
  if (Rf_length(x) != 1) {
    Rf_error("Expected a scalar for '%s'", name);
  }
  double ret = 0.0;
  if (TYPEOF(x) == INTSXP) {
    ret = INTEGER(x)[0];
  } else if (TYPEOF(x) == REALSXP) {
    ret = REAL(x)[0];
  } else {
    Rf_error("Expected a numeric value for '%s'", name);
  }
  return ret;
}
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1) {
  double tot = 0.0;
  for (int j = from_j; j < to_j; ++j) {
    int jj = j * dim_x_1;
    for (int i = from_i; i < to_i; ++i) {
      tot += x[i + jj];
    }
  }
  return tot;
}
double odin_sum3(double* x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12) {
  double tot = 0.0;
  for (int k = from_k; k < to_k; ++k) {
    int kk = k * dim_x_12;
    for (int j = from_j; j < to_j; ++j) {
      int jj = j * dim_x_1 + kk;
      for (int i = from_i; i < to_i; ++i) {
        tot += x[i + jj];
      }
    }
  }
  return tot;
}
int scalar_int(SEXP x, const char * name) {
  if (Rf_length(x) != 1) {
    Rf_error("Expected a scalar for '%s'", name);
  }
  int ret = 0;
  if (TYPEOF(x) == INTSXP) {
    ret = INTEGER(x)[0];
  } else if (TYPEOF(x) == REALSXP) {
    double rx = REAL(x)[0];
    ret = rx;
    if (fabs(rx - ret) > sqrt(DBL_EPSILON)) {
      Rf_error("Expected a integer-like for '%s'", name);
    }
  } else {
    Rf_error("Expected an integer value for '%s'", name);
  }
  return ret;
}
// This construction is to help odin
#ifndef CINTERPOLTE_CINTERPOLATE_H_
#endif


void * cinterpolate_alloc(const char *type, size_t n, size_t ny,
                          double *x, double *y, bool fail_on_extrapolate,
                          bool auto_clean) {
  typedef void* interpolate_alloc_t(const char *, size_t, size_t,
                                    double*, double*, bool, bool);
  static interpolate_alloc_t *fun;
  if (fun == NULL) {
    fun = (interpolate_alloc_t*)
      R_GetCCallable("cinterpolate", "interpolate_alloc");
  }
  return fun(type, n, ny, x, y, fail_on_extrapolate, auto_clean);
}


int cinterpolate_eval(double x, void *obj, double *y) {
  typedef int interpolate_eval_t(double, void*, double*);
  static interpolate_eval_t *fun;
  if (fun == NULL) {
    fun = (interpolate_eval_t*)
      R_GetCCallable("cinterpolate", "interpolate_eval");
  }
  return fun(x, obj, y);
}


void cinterpolate_free(void *obj) {
  typedef int interpolate_free_t(void*);
  static interpolate_free_t *fun;
  if (fun == NULL) {
    fun = (interpolate_free_t*)
      R_GetCCallable("cinterpolate", "interpolate_free");
  }
  fun(obj);
}
